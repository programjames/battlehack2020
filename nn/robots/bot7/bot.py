import random
import math

<<<<<<< HEAD
WEIGHT_LIST = [0.5583073972882081, 4.910853827808176, -2.3132105685369804, -3.5516630647935186, -2.3228365884973408, -5.2901939771384585, 2.875889626558077, 1.828122796889048, 0.8071414863953568, -1.1074922921040915, 2.6021769786886204, -0.012873638374740069, -0.9072291740350445, -0.7628093884982222, 0.2343509710514888, 4.933488762288085, 4.67552890963617, -2.9815135330326776, 2.837427040170225, 1.8292332629944448, -0.3786871098808169, 4.347391105008132, 4.934313748020551, 5.414942103987058, -2.117763894792781, 1.6155788969562743, -2.1876600310103327, -4.362187949213581, -4.903758731407583, 1.3797469264981952, 1.365110410177634, -1.1240146406853022, -3.3973429462507516, 5.262384657015978, 0.998612724543345, -2.49973977260756, 4.1542904832405485, -3.28292368107673, -3.7495080265138876, -1.031544401213621, 3.8290095976903937, -1.8609654541146838, 0.440667106968172, 0.16015448745456415, -3.2608076016880383, 5.732226496264392, -7.88165795710169, -1.0426808463973245, -4.613704294409778, 0.8854016844553736, -3.8433971018681583, 0.6736369011150029, -3.573584321545719, 1.8914257403822647, -2.250073874960347, -1.5872401029183207, -0.4186448168056102, -1.9767395589169772, 4.891222099795148, 9.881232572941988, -2.192808428387192, -4.490345889605424, -4.315631079662966, -3.519176124849659, 0.7259474089863731, 0.20059753199064823, 5.362114078531401, -2.2001083452686427, 1.2350241746007682, -0.6910187968831857, 0.4472728314155918, -10.343282242486723, 0.4929630802337365, -3.6872805637685095, 0.040842195850499946, -0.9621482985856794, 3.3927730423504148, -9.797884441102596, -0.06834941953980339, -0.5659249018956678, -2.414415141374191, -1.1042225791678055, -3.2484136206818177, -1.218035470176366, 1.0169040494130257, 4.8092412438447845, -1.8322619118384234, 3.9961679896659934, 1.3669864604089739, -0.689382401126483, 1.0021425359226475, 3.7835976825865556, -1.2432361854340146, -1.059903114052836, -1.5750504451240568, 0.5386415197393268, -1.7536617169489903, -1.137947326973777, -0.6311720926000375, -3.6917984816960385, 4.125222803314726, -4.82651292026042, -2.324860245872692, -3.606942439677967, 4.936602297340807, 0.7452634826338846, 2.7024002603278356, 2.6829296086680574, 4.9593843901566075, 1.8886609100265104, 4.3841654325785475, 0.6063335557235063, -0.534011763474906, -4.317825526920971, 4.4593724059433555, -1.712775089676997, 2.5579897752526133, -2.77446983647398, 4.559023793343597, 0.572672973581691, 0.6301312953821528, -0.16316508776818317, 3.600548465145998, 2.62155173004603, 7.014111512537258, 2.443319311144317, -5.357253247191256, -5.637941382037641, 2.552523700873767, 0.05783260593070681, 3.625551549987325, 3.8472194135826303, 6.502255302981245, -5.744537890380891, -5.195493194413775, -5.158343658572032, 5.24211311985329, 3.5091940618987616, 3.5696451525547213, 4.549540033444705, 2.0771315067519525, 3.486052169584284, -5.2298246064907135, -1.0500309873681675, -3.6884693750494533, 2.5167790435921114, -3.947616609802479, 2.480235752771197, 0.46926146590226275, -2.479044155720154, -0.42751343966887106, -5.120102820848891, -2.4247800469134586, -0.0009662664537268967, -4.153295388733893, -8.677952406339946, -0.21847653730707192, -1.8129837010058663, 5.463334715777505, 3.8053240703846063, -0.9490589599217559, 3.842172211659371, -4.558740191661475, 4.487287019898508, -1.1278780243550244, 0.3702858474384799, 2.1063705101214207, -1.6889115914604031, 3.369793179950978, -2.599576821915315, -3.4496668982327106, -2.4236561146805475, 2.0627107351328138, -3.2829716915129916, 1.8332338804984676, 0.19653058887000485, 7.299023032153542, 0.14118605362661113, -1.237992948464141, -5.380671917378163, -3.2204808873461794, -1.8769657371725235, 2.1511579637956126, 3.657265765789094, 5.120441569292469, 1.129050013935391, -2.63626608845894, -6.1138125362622, -2.5092246931846423, -2.134669835981734, 0.0851019438602798, -4.285100598360645, 4.584793651843095, 3.252005941987917, 1.9136360892704665, -0.42826263966056244, 0.7535605742045355, -0.5225641283706491, 1.6958822732375909, 1.7719498010550834, 0.13347315277044217, 0.7024407781406391, 3.0382490933481914, 2.4227048712674204, 2.2454170521136327, -1.3498363666997917, 1.0294677170764066, 10.581898547189445, 0.5770063752376903, -1.1270878046321922, 0.6094187425070181, 0.7531135624719298, -2.940456984225968, 1.3019716883241852, -0.6556927480428798, -1.7597260727724735, -1.610823069734865, 0.3329767819611535, 1.3028717086947479, -0.751437530070515, -3.923158526925558, 4.081820584314579, -1.5765889526566865, -0.9493842024416905, 4.253935828249019, -3.524128008080936, -5.027527452159446, -3.3225708905960794, 0.15546920192209615, 1.7422233800966647, -5.341371408960935, -1.7060168750588633, -4.6887755971236205, -1.6449312888092928, 5.2736487339979545, 2.401915969853316, 4.275611225711893, -1.1716939452983137, -3.6239986583324892, -5.936566687900037, -2.566970097139547, -2.5931844755540197, -3.5899627293016017, 4.866062270508456, -2.599158844611573, 1.2080457650303513, 2.591892797349628, 0.22228619257803073, -0.08162501842479487, 7.125005733277015, -1.5426320933554512, -2.110655347474266, -2.2991656642136364, -4.26705335484964, -4.850555438693711, 1.0180414396957504, -0.41937097887966523, -0.34863261464015544, -5.808992716653762, -2.5085595970106485, -2.7275556958832325, -4.578991785898988, -1.8284128059682265, -5.899383872639215, -3.062779109764863, 2.6875204180835617, -2.3668674621921513, 0.5936579193789455, -3.7627649976721083, -0.5538483984255554, -1.6570194570405612, 0.1701998320534068, -2.8948806688701434, -5.6157295619303085, 1.518227020193914, 2.0304692957377584, 0.20536834147759955, 0.9959497511037295, -0.7820541024956185, 0.3642222714384581, 3.9456551883389155, -1.0282814791467916, -3.900310188705953, 3.752706226553766, 6.154490058804988, -0.0819210439199736, -3.3820936312450716, -1.8243949430438666, 2.6403845405966484, 1.7014189133563034, -2.971170017449767, -2.6959877571279476, 2.5478867106870466, -3.575713376765495, -2.260862070481217, 2.355578750088426, 8.828668701988791, 5.94629913427798, 1.801268247822295, 2.052514691292972, 4.558694621051297, -1.8773056007289866, -5.8487194510099405, -1.7754826516269147, -2.3715919139806503, -6.869179333398728, -2.88494863439671, 2.2976746317356205, 5.064309717298326, -1.4294644832819028, 0.6773654406338566, -3.9194469681330926, -3.5945459894731644, 3.264747880793414, 1.840968671447456, -1.7774325819380987, -5.644297548379909, -2.406112884513353, 1.285976080220529, -5.594994906905565, -5.315914076358415, 1.277888898152716, -6.804596740527504, 6.40628199369458, 3.4338446107214797, 4.598179880827326, 2.001711296763124, 0.2747040306493285, -1.2727324529242467, -5.563261064752902, 3.962074571365626, -0.33776518525961274, -7.424980002470512, -0.09817403480129108, -5.032685774392447, -0.5064102675298086, -1.674621585093349, -3.450434481096427, 6.513823736392438, -6.780753813296153, -3.2410537942760667, 2.667158171517327, 1.4760676269963575, 4.1849978421079, -5.692924293568444, -4.628892981149244, 1.7087915372947202, 4.802870702189755, -4.852851852545735, 4.646059394168841, 3.257851752092803, -4.027941249935577, -3.4026580154798904, 2.3167867477184685, 2.330607829565217, -3.391077867915388, 0.03666759734955334, -0.015005116861001618, 2.8142171546824284, 3.242197142672809, -2.247676637453375, -2.8252836556186542, 4.919246766069969, 6.0529225969764395, 5.286152300912529, 0.11302653323494406, -5.838895511102084, 4.26174117630015, 2.6034940750125624, 0.8499137329463891, -3.224821221039385, -4.712852106078844, -3.664705047214766, -0.8892526664959126, 0.3389903745496239, 2.0752276247378996, 3.9162913026094808, 0.6761504857376185, -5.655875007039887, -5.259726095869737, 0.4248555842934892, 3.4241640558247406, -0.874477293174249, 3.170313388051157, 0.1241786433616792, -2.873440170615646, -7.232436069340529, -7.882428473065614, -4.597715211566432, 2.4639561442887286, 5.607047746460787, -1.702373005201346, 4.709109639416073, 0.5102065496325419, 1.4410067291202366, -1.2987965754632136, 0.34321263517920314, 1.1776265168152629, 2.2645243280874676, -1.5014756987217341, 4.289910114622745, 5.550926187121201, 2.7146757048787378, -3.4477753457902534, -1.7092267438318902, 4.535829882389723, 0.7044700004584638, -2.1477010443891498, 3.8671013008729984, -5.548622288777046, -0.3030933072065553, 0.7842279015390011, 0.9055720993346753, -3.275761379651734, 0.9646115226172904, -5.687496355857248, 4.127054167007059, -1.5812851274872857, -0.7153817136622944, -0.9929199960941228, -7.39994604812143, -1.8386211539404895, 0.7525087991751558, 5.21955404912653, -4.347909591418289, -1.1453947048386954, 4.082856988235975, -2.7421233807570973, 0.9129993625968854, -1.9392606114814634, 4.3963392798112855, 2.7893801072362163, 2.995084682477939, -5.913322611271519, 4.936281061117776, 6.18265946495045, -0.7382254597472752, 0.8084010184604182, 1.5850735182617117, -4.760158469303419, -1.6139859802539958, 0.6555841013182906, 2.015413365197482, -1.8252855450218348, -0.37986747384451086, -4.322985056693514, 0.716292204563908, 7.98871256916668, 1.799093964116274, 2.927936145460872, 2.4163820682503565, 4.524528258551813, 4.942207920833512, -4.366350587062778, 4.688850016467339, -1.4848495190907841e-05, 3.625200033122528, 2.557472574607128, -0.37464298906009846, 2.5145375218936037, -0.41725194083662615, -5.91784978133535, 7.6948666554499585, 3.687306679412912, -2.043282566942603, 2.065013254466188, 1.4955529154289853, 3.19538864481617, 1.376504695747422, 3.049064901705646, 5.177877780228245, 1.6586564499254728, -2.318458167834841, -0.11044732014817435, 2.4989019824611383, 1.3444728397416805, 1.5779282398224224, 6.847062648699196, -4.278917602809875, -2.4552829116373958, -1.1964065980471317, -5.08116507162311, 0.5670210677931548, -4.3473875207281445, 2.693024624900287, 0.4049710555634346, -4.412051163902423, -0.8184079240307989, 0.4750894875456611, 6.266660397062908, -3.281007200341673, -2.8777181052548806, -0.6978792703761398, -0.23979352047774355, -4.8631649094478755, 1.3668689665045233, 2.611915740326162, 1.8322112225945042, -0.3713008112948606, 2.7292072635454754, -0.2874906137726284, 0.10993994683045268, 1.5462194359979242, -4.741319148902004, -1.6565777186108268, 3.6075377082733215, 2.870220917195467, 0.4918561307195666, 4.257737200295992, -3.0538864846225158, 1.8237413504335835, 1.0497374314767587, -3.772774441390682, -1.787413012358697, -4.907643784029153, -0.9728394867828047, -3.9881539031198883, -1.0020586658736996, -5.975946971177359, 0.2963344006900635, -0.04320193829957836, 7.012814586966158, -1.1868895340540409, 1.1066983383043132, -4.021531301851865, 6.955644460158192, -4.0775401145193575, -4.131933601789714, 2.042372578667955, 5.102998498650795, -5.503088732531785, -6.404329427822669, 0.9126453828633706, 4.223268522468699, -0.9043381830704129, 8.075479250137203, 2.52699444728438, -2.3021452475809796, -3.3312611540780024, -1.9950176978969705, 1.4649008651257063, 1.0626365946224277, 1.44068906120677, 9.02060189921715, 3.80199948521448, 0.5713253489271417, -1.2706007052828348, 1.8033820539113217, 1.50526954387122, -0.5488473448675714, -0.2868492966225807, 5.977514924300281, -0.12216968764409396, -2.788983348754902, 5.403434015103002, -7.76174167701299, 5.249862033735235, -3.8844848639063954, 3.400236631441557, -1.0136086068330474, 7.811348201486034, 1.8968482039101473, -2.254924602544814, -2.1855787947989436, 0.028413486648329798, -0.11869403200988723, -2.4603590601825593, -4.4176065675282095, 2.210748076848279, 3.9636348800504413, 6.041596253109151, 4.874002665870178, 2.2491372344887415, -2.153689320214481, 0.03379112956553228, 1.8472658272161537, 3.7094261475750034, 8.939011833883974, 0.3934697168919706, 0.22389185316007812, 9.609888267710517, -0.6165830744195919, 0.5345155858167662, -3.1869016613534202, -2.551631554380849, 5.776728014004558, -2.3520789026399767, -5.44656891685665, -0.241169036253412, -7.360449410733652, 2.424736057811469, 3.0801063130187676, 6.109503226826479, 4.950624909850398, -0.9547446166063575, 3.8063658717306645, 2.9198316802281927, 4.112524850747529, 6.783933207054031, 1.3839454125168011, 2.299873197713341, -4.249263577115264, 2.0185691890801065, -7.7203808240022775, 2.162286206776781, 1.2644707155881068, 1.2156883729091956, -5.139165871279633, -4.544075600012813, 2.3619784283336456, 3.0306799509246454, 4.266782605398721, -9.140167667070827, -2.422152319638959, 7.443336413855479, -1.3613593684514145, 1.447151590586882, 5.825203808189959, -3.4661561713172446, 3.1632536018573285, -2.0117961037537877, -9.99045529625422, -1.0494402051104006, 1.4738333398886037, 2.9053484155763716, -0.9070874017447184, -0.7015788218845739, -0.8070698553382313, 2.2743220545683265, 2.4863411833141873, 3.226896930711022, 0.28548004274817795, -1.415041078820525, -4.29265106792768, -3.2302628610290722, -3.4216399739548793, -0.7097483049382559, 0.863905619161241, 4.2220765060157195, 1.9564153202863195, 3.1834971121887126, 3.1091908216597424, -1.4384694475526982, 0.16359152490498247, 0.9665465507509371, -3.0834468575281306, -1.6450179917012668, 3.4745125542389728, -4.021947357766256, 3.3628538624374054, 0.5660286147904444, -3.686046386679099, 3.4497765429888667, 5.921494852578903, -0.44694120274435306, 3.224122742374067, 0.38035579719680307, 1.8557562449587388, -0.9180191596024067, -0.2030811469662437, -5.263072679992095, -3.353646004925484, -3.715202479267226, 2.3440344749310915, -3.898003900692837, -1.5405329319758438, -1.1374484696205518, -2.060426636399016, -4.908355682578603, -3.8650923507053996, 1.9827443337626796, 5.683163963331869, -0.20692700611787995, -1.8244597115912748, -1.354986036274948, -4.28345284502337, 2.339699683640977, -1.55368108546088, 6.686957299515437, -2.675170615813398, -4.743037776076225, 7.888064064355467, -2.0471610411832413, -3.2783746720417635, -5.156742036101212, 2.99761986528531, 1.5222527604805114, -3.55850825397864, -1.3619904638560931, -1.595471123095242, -4.804369899765803, 3.3273365977727085, -1.3039799355263402, 4.3824898818035365, 4.629142247311719, 4.289470095153235, -4.912988918136593, 3.6475215145738735, 0.24063938818818648, -3.398085988490158, -0.3589001799323148, -4.739504348755621, -3.537377846483689, -2.0716233432919595, 2.52421664612759, -3.410598265409973, -4.68093881898663, 1.4353059145514628, -2.7546299652764588, 2.009925485291233, 0.4759496805678698, 1.6715781205279046, 3.9643501525276443, 2.9372250650626137, 2.796288250130695, -5.8630266891228295, 6.987267396309302, -1.36193539715549, -3.4702294498175927, -2.8437730245483337, 0.14883737142881823, 1.4938448657624714, 3.0295249871513716, -3.591632991865488, -1.0532271631949108, -2.7636756855876525, 0.5864275678825768, 2.1854720172014255, 6.127845461378253, -2.7569463605801694, 0.09093770084536817, 1.4766840468391784, -1.2543212308344562, 0.7330137320715231, -5.733737392882387, -0.8385864147033715, -2.3795255628358345, 2.354630138053484, 3.770939884152903, 6.925638144230892, -0.8689553965997839, -2.2318828857600423, -7.9858933913782915, -4.331447276424426, 2.990490838477216, 4.219062381966758, -4.422298245692699, -1.7765223324777357, 0.9735927391520648, 7.599078357511103, 3.7533373037310405, 4.880687733577307]
BIASES_LIST = [-1.385298241914249, 3.707791346969914, -3.6133544680836964, 4.798218478953641, 6.329678703720794, 2.768763467020726, 1.1067873953190437, -0.08016598640150141, -1.103350902620616, 2.6558899142056096, 2.1238474326250714, -1.369412545589492, -0.0015752197971323515, -2.61755162647115, -5.503205920000561, 5.26614529829878, 4.821022831592622, 1.480629288453383, -6.566677959970062, 0.020749944298834387, -5.076936595868094, -2.804459743580854, -4.066886620398347, -6.093305179946785, 3.9260214342354556, 2.650521369339082, -4.02896838205512, 2.9177319058342053, -1.0783752617281737, 2.30703700308551, -0.34093339408628287, -2.290600614032918, 7.118851022326269, 1.8513929878858495, -1.686038447236385, 0.44264886697088085]
SHAPE = [27, 16, 16, 4]
=======
WEIGHT_LIST = [-8.368204921853895, -2.581849668824226, 7.518189424458642, -0.5195639786641054, 3.947301362781586, 2.1980574031783395, 0.4082143878869989, -7.037786509019808, -9.603883340215985, -1.682427645500144, -0.034087814286043405, -1.714912012333794, 0.13195397466413045, 1.9855028018763172, 0.8945810613636116, 3.931477224827453, 5.3230975057519165, -5.155636964175501, -1.123980646245488, -0.23919863842919403, 4.362360365110706, -1.4494802097597725, -3.5389438843472396, 5.2250639747874335, 2.007111893747967, 4.684196527156096, 0.5483159304598924, 1.4273856536043101, 1.0644087872914814, 4.1531849494279305, 4.395466063787225, 5.6180409744810795, 1.0250288411543758, 5.538805742215161, -2.015788858098428, -7.041953620478309, -4.311114852868005, -4.765013128778096, -3.7514665402937766, -1.5221766721196042, 1.957108312869782, 4.928286591996328, 4.029873730231435, -2.30403502160951, -0.9236060901633536, 8.896385055781245, -0.20102483775728763, 1.2079256871325696, 2.8583653473644883, -0.30959313697190555, -0.8280323589932048, -6.094192171899383, 0.9773431989482544, -4.614003928609486, 0.396707377243883, -5.851346002684128, 7.874138926431759, 0.6865275074486548, 4.065786082418967, -0.7120219078344134, 4.9852486773848055, 2.411423234658505, -5.1231276198028874, -2.9293638432226383, 0.9413589557394981, 3.3579621149942267, -1.4256752321147284, -2.082016403850766, -1.6650253210518902, 5.909815978631961, -3.5456917975752615, -2.3168238752440553, -2.638862037202239, 4.707591411026777, -1.638006559320075, -2.2575365781009276, -1.3038180555161836, 0.028273617784732308, -5.19427713965294, 6.172778720334331, -3.1878758758156005, 5.142161974875028, 5.985784961103506, 4.026842849837164, -7.374842873232529, -2.03171806263526, -5.800364506551028, -1.6977051686570654, -0.924547414456093, 7.837974872793617, 7.222552856807125, 3.5405135044644784, 0.9126464632268989, -2.277406323579402, 2.885086300622976, -1.853291894077075, 2.5084802190497184, 1.1305289632661344, 6.060666809818207, 2.4480458543891275, -1.3573133288696209, -6.359964782296767, 6.10464684482292, 4.845796026466337, 4.736834426051064, 1.8669775172908483, 2.5931068209111876, 5.254455539450325, -4.864831831302461, 3.816720930975858, -6.7285596337310345, -3.0189217593867967, 3.361820295805776, -2.6775595257889346, 5.610469409317263, -2.385407083509494, -9.595495436262631, -1.5592624880213855, -4.668479530629701, -2.4918548128612183, 3.420013283910932, 0.2801738013049621, 7.637664874667426, 0.3245224102400122, 2.598014969225905, -0.23804639654759926, -3.004164523085492, -2.768631220586951, 1.0309829341027539, 1.5985210278396222, -4.677187274283503, -9.701208167825369, 1.950502357802831, 6.1252921508726, -4.472636087595981, -1.8219614076367487, 3.767751024383013, -1.2905988899495653, -3.7716142210187877, -0.42153308541644285, 1.8732550662527823, -2.9749637143229783, -6.821026363551821, 6.932849042240535, 7.3086089662956075, -1.1653887563147673, -2.046531390855674, 8.007909580850482, -2.260764753619053, 2.324394905085346, 1.569548540074038, -3.910686909229913, -6.931254691430722, 1.2544494650978002, 1.2692415123020229, 0.6118865883821258, -3.9424970493663007, -7.370747572598203, -5.926194284217371, -1.3742387835425047, -4.945727264143327, -3.984588186117009, -3.5517261445290798, -6.173271761794283, -5.037050017265977, 6.978528188170923, 2.3434333021129317, -0.4864361743895389, 0.3222844521860793, 0.8874887985162951, 2.978499456585587, 0.054993759673791276, 2.166820124057741, -3.00912507346588, -3.561847137168468, 2.058341139416793, 1.0387174526069964, -6.816348078596972, -4.546314590606027, 2.391760624410867, -8.182005494032385, 9.128846032726115, 3.3517334913835914, -5.142449498113348, -3.930841368245975, -0.483753861955802, 5.276000778068459, -5.389014869259618, -5.410165322129355, 6.815283944650914, -4.851998772304535, -5.463163437275204, 4.822630540093991, 2.6618771506462564, -5.449060777350249, -5.4004479228277456, 7.0186686794169, 4.203971502932128, -0.14615300269303122, 6.870171193982094, -5.641089323944304, -4.296617200806621, 6.502276732965255, 0.7346163736336502, -0.8910009909234924, 2.7131848748136793, 3.453213667345237, -0.7448300770618677, -7.426415056235767, 7.35925220867446, -7.317054719307525, -1.837376731653303, 1.7785538668116687, 7.018992406376799, 6.166431310312712, 5.9185487290310945, -0.3333270926077249, -1.780600960291113, -2.601557684374129, 0.812775304655666, -2.1459207080715625, -2.4068722204593915, 0.30206288988483004, -2.0537894502138494, -4.337272396809869, 6.226112908303691, -1.3147589087617986, -1.7214834203775926, -4.032813163566348, 2.7139054409044636, 2.7140699387987595, 0.37572670057939556, 5.851003290083555, 3.3000089192777797, 4.198859801007727, 0.7089994462918257, 5.07884617598148, -5.799767523839539, -3.0775363828760702, -4.859408195497978, -6.05290039927629, 6.659930041624702, -7.19671237971431, 1.49655836317405, 0.3003458223657211, -3.2375593256732196, -0.18561857391345685, 4.22502618306305, -4.456497771385272, -7.078785857414094, 1.9621066533496525, 1.9503009346577027, -4.623305303092816, 6.47181678823196, -1.3992191126615183, 2.1015102274783666, -0.6608474871903419, -4.375034415135343, 6.496935257669858, -4.113053569720548, 5.574321613409701, -4.013086512662267, 3.3031689513897224, -1.3885836501453441, -5.37068508549701, 4.573623089234857, -2.9317829137058533, 0.36857093898244947, -8.344049457378741, 6.686762734257208, 3.3813006693669694, -9.470039782726907, 1.8411098197218312, -6.678447914080258, -0.45826386474257863, 0.474907155338068, 5.561837884280856, -4.6650431780466155, -0.7932343186620294, 2.810508386510602, -1.391445473640036, 4.090881706086519, -5.5348795291406825, 2.6727638695179143, 2.819964802234984, 1.353496249652285, 2.307487173065925, -5.792194978196555, 10.420556941641323, 9.121282662751346, 0.39507108563285837, -3.782281735979771, 6.124878957401337, -0.9957300985399247, -1.080551937603857, -5.944368782264873, -1.2648560466313066, 0.18129844525344319, 4.9626957064031565, 2.6811895311958143, -1.5852926837032713, 0.09041816549644999, 4.784641858986374, -0.07244569152715927, -1.6813196476215437, -7.152667583705807, 2.463863235708705, -4.387708491082515, 1.5829826844734973, 3.9058913495114855, -2.114029893592417, -2.4728961603937716, -7.672308830921324, -3.736763831498648, 7.822216435919343, 5.485368675631991, -3.232784905180683, 4.62695054240711, 1.2722924059613183, 3.3171854854341727, -3.0765890972788497, 2.8737731665144706, -3.55592002876699, 5.865975167923867, 1.342668036933674, -0.12286896298038841, 0.8175598888368465, 3.2772398139220997, -8.038107801574315, -0.5557205928146349, -3.9296598797635025, -6.5906752810573686, -0.6433702954135297, -3.650078060196142, 2.4662658235135257, 5.456038070088538, -1.8307619792931338, -6.81809481914823, 5.347262888469131, 3.5674787973173574, -2.513170364547414, -5.6367216830240325, -4.501093641996609, -3.9008662813920285, -1.5442072765767498, 6.845313672678157, -3.5332881007761943, -7.538836826919453, 2.143404057879328, 8.593213416666066, 9.178769938383288, -9.015142651741469, -6.797892466911685, 2.711605437408205, 8.366316231377276, -2.4591384092345967, 2.4436615854442487, 7.333712610041551, 6.428319912394799, -1.8182352186319637, 7.669370625958608, -4.493818500578125, -1.4388313226076335, 1.5617034299545622, -0.7312188529746643, 2.8673722841136056, -5.282352539822553, -5.759309380109796, -2.097718338017439, 2.1958021733107476, 7.880439662690125, 4.196490098108199, 0.26606783536431683, 4.123657291222484, 0.02449824529660599, -2.343439470803468, -4.768921218727148, -1.1611862772756285, -1.8908042826507818, 5.557032411409631, 1.9111836517522116, 2.640608521250511, 4.326949624444215, 3.6329026334730563, -3.168486326234887, 1.855214560068676, 6.0775652834684175, 3.4228086044390547, 0.6658418810174493, 2.179937086191885, 0.3490230570080401, -3.492889768644082, -1.34357317704517, -3.468450760224307, 1.4445870395557305, 1.4303591604238213, 0.1635216425519051, 1.4542125830236956, 3.2479916092150005, -2.630742615658002, -5.982313280492429, 3.376562759918919, -5.578057160212616, 6.097037215624853, 0.2771735613494855, 1.4552233617000379, -3.5267945965726852, 0.3123629988155368, 2.506573758345916, 2.5145031573697856, 3.2685811758392744, 3.024086915672929, 3.454293441781189, 0.30315627907824, -2.392475218009651, -2.592541123039021, -2.791163195918404, 0.050740437378067715, 1.256042351267353, -0.9734749333368464, 0.9399767892457838, 3.1122721257035746, 3.4762844741279832, 1.7851007578892202, 1.134776477218273, -4.6842637005171355, 8.979066248856384, -3.64540403099205, 5.038171580382009, 4.013172601176289, -0.42165712877302847, 4.801799093184773, 0.42600916572282804, 3.34478161522828, 0.560489551709292, 3.2914806321860213, -1.4349540554361053, -1.4953619530118742, -6.162357853206873, -8.003234896212245, 0.9559086495850211, -3.6602805105658893, 1.2690882445761273, 1.3860873990791873, 0.721227494559451, 6.771877823253159, 7.492861745597321, 2.9975299783012312, -5.613086927289023, 1.282727384646961, 5.14555715455505, -3.2615584516898517, 3.0792702323654155, 2.1253371891871367, 5.853111822132574, -0.2885934645066497, -4.031123959267283, 6.380808885416056, 0.7186743013350321, 3.917529816456408, -2.609107507416511, -3.6962128757892616, 0.8718797807518801, 0.7674393303686922, 3.1243511889330633, -4.148855896440173, 5.4203526791028, 5.667664420233963, -3.5533105277527053, -7.931235949681228, 5.314256830457078, -1.6102357937413445, 7.188204754346713, 0.09882268482051854, 1.3566623645197904, -9.319156127233205, -4.4411877976826695, -1.1321846627456558, -1.5422993795892947, -0.9018736109817638, -7.0718535986457285, -1.008250816828452, 7.865195960075606, 7.914845574858485, 0.6553005175899782, -1.1420269282809168, -1.6816304945621594, 5.684031214054471, -4.209791675866831, -2.204769056070496, 4.276648614876354, 1.1110260606463471, -3.544853163552066, 5.181289545899549, 1.7054852572171484, -1.0880004375805987, -1.2324479107671777, 2.120198328836585, 2.745556740871978, 3.5901420680882095, -3.244463538939054, -0.6683792804188085, -2.3020076590423026, 7.6131766060290955, 3.3800168680879312, -3.516975872790203, 5.013974922129798, -1.5120178201399017, -0.1405845654934219, -1.6157856294768014, 2.431102722722386, 0.1296448554745004, 3.179528762880866, -7.229181397011192, -1.3850089137373716, 0.30915437105643656, -3.7121645908112417, -1.6427791135983258, 0.8096928135654993, 2.324411442728015, 4.1134362659209005, 6.09668560541513, 2.3940169820043296, -5.078458969989921, -2.4812288328856797, -7.852161503317127, -0.3218005007356827, -4.3848684147465535, -1.2515619514089558, -2.902295021898491, 3.6141975476814476, -3.3392090314236142, -6.802395996412391, -2.8322447038529472, -4.187062428955136, 0.09434099281084501, 1.9325919463142696, -2.1806283062762524, 2.7392264585179817, 1.171034452365722, 6.826475869747147, -0.9545382699954617, 4.479182941573657, -3.5795631908971988, -0.15088465243392563, 1.1626167734093054, -7.699396835049741, -8.42010161690415, -8.5461317125507, 6.196410167256708, 4.243671495484288, 1.740257822361117, -0.3638207665379933, 1.4474005822624445, -0.35512399120318666, 0.5655564499955834, -2.449595044625635, 3.6010451490541153, 3.311861493511055, 2.821606325458881, -5.242490243938472, 0.06800888138095423, -6.604302627456568, -0.40824462118591587, -0.38263670588872767, -3.2454756015283728, -7.777417406228718, -0.8130559211380346, -3.331609666751721, 2.4035285180097445, -5.132156687458964, -0.8257028588625532, 0.911518585987662, 1.3281058169562692, -6.864236546994126, 3.307390372625371, 4.212550435647023, 6.361774259397821, -5.67793467957787, 2.091790208648127, -1.9844649087836737, -5.349796906651182, 1.0887793949774616, 3.381451680864487, -2.053135233265897, -0.6296495661388684, 3.7434267116519573, -0.47458555758463383, -1.0757314724214027, 3.95565553561824, -4.620192724905957, 1.3856374393347142, -1.0750704454753155, 1.0553444229938072, -5.129421522778015, -2.4348054797068137, 1.9748661933839222, -0.8130961598395321, 1.431823310536801, 9.200857811740866, -3.8564663951952833, -10.491088990598874, 0.1306125768347658, -1.162882377116487, -0.9040711056506998, 5.495744545381481, -4.2962736272318045, -2.8818647897371688, -1.7603942079233692, 1.5181289770383177, -3.959538577763984, -3.013371846533193]
BIASES_LIST = [3.8764542695169912, 2.2460681297590033, 7.346201643645057, 2.352934211257066, 1.6751002301685363, -4.06388989395809, -6.4427400172802525, 2.263493885131953, 5.016905915233925, -1.3812728139037587, 6.126023476206138, -6.630224811481874, -1.3752504901116749, -2.40917162057626, -0.8490877616280801, -1.0963340811394282, -3.2419313465861053, -1.473086578046764, -0.14027999045685222, -3.569527363086802, 6.440065338431802, 3.3888509025668783, -3.6140202688282406, 0.4882824612469345, 4.874256827836627, -7.885923299080234, -1.1613869093809945, -6.0060102200136924]
SHAPE = [27, 16, 10, 2]
>>>>>>> 7d31a6a87a720dfe4ed79aa94e6595884cb1bc5d

IN_TRAINING = True

## NEURAL NET FUNCTIONS ##
if IN_TRAINING:
    import numpy as np
    def sigmoid_list(x):
        return 1/(1+np.exp(-x))
    def dot(x, y):
        return np.dot(x,y)
    def vector_sum(x, y):
        return x+y
    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = dot(weight, v)
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v
else:
    def sigmoid(x):
        return 1/(1+math.exp(-x))
    def sigmoid_list(x):
        return [1/(1+math.exp(-v)) for v in x]

    def dot(x, y):
        return sum(a*b for a,b in zip(x,y))

    def vector_sum(x, y):
        return [a+b for a,b in zip(x,y)]

    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = [dot(v, w) for w in weight]
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v

def list_to_weights(lis, shape=[27, 16, 10, 2]):
    weights = []
    index = 0
    for i in range(len(shape) - 1):
        row = []
        dx = shape[i]
        for j in range(shape[i+1]):
            row.append(lis[index:index + dx])
            index += dx
        weights.append(row)
    return weights

def list_to_biases(lis, shape=[27, 16, 10, 2]):
    biases = []
    index = 0
    for i in shape[1:]:
        biases.append(lis[index: index + i])
        index += i
    return biases

weights = list_to_weights(WEIGHT_LIST, SHAPE)
biases = list_to_biases(BIASES_LIST, SHAPE)
if IN_TRAINING:
    weights = np.array(weights)
    biases = np.array(biases)

nn = NeuralNet(weights, biases)

def check_space_wrapper(r, c, board_size, team=Team.WHITE, opp_team=Team.BLACK):
    # check space, except doesn't hit you with game errors
    if r < 0 or c < 0 or c >= board_size or r >= board_size:
        return 0
    try:
        team_there = check_space(r, c)
        if team_there is team:
            return 1
        elif team_there is opp_team:
            return -1
        return 0
    except:
        return 0

def flatten(board):
    lis = []
    for row in board:
        lis += row
    return lis

def copy(board):
    return [row.copy() for row in board]

def pawn_turn():
    board_size = get_board_size()
    team = get_team()
    opp_team = Team.WHITE if team == Team.BLACK else team.BLACK
    row, col = get_location()
    
    if team == Team.WHITE and row == board_size - 1:
        return
    if team == Team.BLACK and row == 0:
        return
    
    board = [[check_space_wrapper(row+y, col+x, board_size, team, opp_team) for x in range(-2, 3)] for y in range(-2, 3)]

    if team == Team.WHITE:
        forward = 1
    else:
        forward = -1
        board = board[::-1]

    inputs = flatten(board) + [row/board_size, col/board_size]
    results = nn.compute(inputs)
    best_move = 0
    val = 0
    for i, v in enumerate(results):
        if v >= val:
            val = v
            best_move = i

    if best_move == 1:
        if board[3][2] == 0:
            move_forward()
        return
    if board[3][1] == -1:
        capture(row + forward, col - 1)
        return
    if board[3][3] == -1:
        capture(row + forward, col + 1)
        return
    return

def overlord_turn():
    board_size = get_board_size()
    team = get_team()
    board = get_board()
    board = [[0 if not x else 1 if x == team else -1 for x in row] for row in board]
    cols = [0 for i in range(board_size)]
    for row in board:
        for i,x in enumerate(row):
            cols[i] = cols[i] + x
            if i > 0:
                cols[i-1] = cols[i-1] + x/2
            if i < board_size - 1:
                cols[i+1] = cols[i+1] + x/2
    m = 10000
    index = [0]
    spawn_row = 0 if team == Team.WHITE else board_size - 1
    found = False
    for i in range(board_size):
        if not check_space(spawn_row, i):
            if cols[i] < m:
                found = True
                m = cols[i]
                index = [i]
            elif cols[i] == m:
                index.append(i)
    if found:
        spawn(spawn_row, random.choice(index))

def turn():
    """
    MUST be defined for robot to run
    This function will be called at the beginning of every turn and should contain the bulk of your robot commands
    """
    
    robottype = get_type()
    if robottype == RobotType.PAWN:
        pawn_turn()
    else:
        overlord_turn()
    bytecode = get_bytecode()

