import random
import math

<<<<<<< HEAD
WEIGHT_LIST = [6.884514875045717, 0.5348627332913853, -9.532214398363655, 4.12427526121448, 3.973595447105412, 8.684604456901532, 5.349018592170378, 3.7808505416428453, -2.424096233229842, 1.2028275998468807, 6.260368868962395, 2.618425265427799, -2.42499139427154, -7.610398813284656, 3.3705074703317983, 6.1022989426252465, 3.2304639238496833, 7.076830104376441, 9.376346432815595, -6.294447399333761, -0.2631387648605745, -7.937953339810746, 9.318450824602827, -8.297660572714378, 3.426730215935427, 0.9627365707846423, 3.9325358255033223, -6.623525507917972, 6.28817120118962, -6.622564516150755, -1.713341364209855, 6.144770439894838, -0.7132648963752359, -4.620922004971526, 7.811635170725516, 9.29886648077639, -1.4707927579977635, 6.473189457359357, -3.2558425063400236, -2.9743858203670275, -2.553561561745812, -2.6956219610929466, 8.308291640026795, -9.240624479082694, -6.982293302584641, 4.740941365010816, -2.174850735223499, 1.527382676658732, -5.089738795618635, -3.0459526869449594, -2.432649412353598, -6.215650005431678, -4.730184789490339, 0.1929846515960243, 5.10827346005523, 7.309985919349927, -3.192190742030208, -5.855899836322953, -0.8347539005993276, -4.831657997730902, -9.637233426041469, -7.852988060723067, -5.412784181846348, -6.5419052645622315, 5.708090346547738, -2.516929107792363, -5.809254835759812, -0.5361919067298864, 3.518515908850972, 8.229383637290166, -1.908998058162421, -2.8986350057191164, -7.00971658660297, 7.646469037640216, 4.943401612805097, 3.8603178488714, -6.220383638069049, -8.830548582166553, -6.331698184280317, -2.3000977132079647, 8.151661306680428, -3.1961078917984143, 6.367927557037248, -3.3914736488960084, 2.4814301106984473, -0.7705687843174918, -2.7555117157149356, -5.022011043264262, -4.883548541070919, -6.305021832711864, -8.696457046345799, 2.9156392177538173, 4.054214147929544, 4.243223375397589, -7.262256809202661, -0.5111283772353747, -4.949272709320203, -7.176626006579601, 9.469644479275907, 8.991723932440912, -5.376027214050987, 1.4942333731133033, 1.095926130717137, -8.23041767410926, 4.903222416945622, 1.269468719327417, 3.625803682843925, 1.6825883434593614, -2.047465853786661, -6.429554109151083, 7.179999748780965, -6.139358836142406, 1.4130771775493685, 4.795677749395519, -9.565423931996, 3.949732774729446, -1.1830461057333288, 4.48713726395648, 1.3368696360466608, 3.056852012845223, 5.622015464718249, 6.689579923333973, -6.997236523318864, 5.441647107712397, 0.5552267798704253, -0.9177486973046296, -9.353465302522324, 8.333983064108324, -0.23602809709192485, -7.146712648132683, 5.392264382048943, 3.2684967243631107, -7.921732054115118, -0.49062456982591485, -6.892515084648078, -3.736678262633455, -6.7530418580840195, 9.857530397581854, -8.118334964138255, 6.346612708899677, 3.1976702810258377, -0.3974743211613898, -2.2452242398897333, 7.297471828595384, 7.444120097311021, -1.4272511388900604, 2.743070642704204, -8.719950914830017, -5.218565126267418, -5.172677453413861, 7.010364892964667, -4.2539118596829155, -0.25010371828464883, 5.431011347751991, 3.9266664876291557, -9.452199857764775, -5.086255490296421, 8.898769580922458, -0.4536977986690971, -5.214793606960293, -4.912785709059824, -3.7453729274315695, -4.646073713892327, -1.6840825623851465, -0.09407817537029217, 0.6176878326233961, 7.83896246975457, -9.770185465561536, 3.027105659206775, -0.4822355390206283, -9.944115640212726, 4.8535471468298645, -5.66604239671782, 2.014037509656127, -3.5247443552594877, -5.27354027661282, -9.28363288667372, -3.7985275623724473, 0.9008120665122892, -7.138113178641925, 0.061116696695957984, 9.224136425495068, 8.948249826637252, 0.6260701006372287, 0.43519995558560964, -9.724970242472237, 8.032637542444576, -4.349751709612164, 1.379619831768224, -3.917424160299367, 5.547177587800341, 0.18592369807121045, -7.55495114151625, -9.759974462626248, -2.3734865491984536, -2.8383889167519065, -3.533035917069971, 1.2134008770330524, 7.2851060248321104, 3.5177285809373977, -2.571865681403769, -0.2739230569723876, 5.066404364022109, -4.20190547834264, 1.681691450147774, 7.072741827238048, -6.199782200316653, -1.1756457200553534, -3.3295954115225124, 0.06987314537049727, -2.0583214931501637, -4.560918388750683, -2.6320717672115324, 1.455691566244413, 0.452769999020294, 7.549581581407022, -7.230851791915165, -7.3760803139121345, -5.2710866157220355, 0.4063325608016761, 7.502264571801387, -0.13964508517449836, -9.124756977619711, -8.050838076931024, -2.4086048917265472, -3.37436547106935, 9.493259800105154, 1.892220127367386, -4.501859970637003, 4.071774638490616, -1.8008569617049552, 5.475604072828954, -6.102195865361693, -5.479290824275614, 2.411273681850375, -1.7640154637489296, -6.454024293334797, -2.6000238118190637, 7.0227276741731295, -7.214322595995961, -8.161371199662614, 1.3829568042385727, 0.37747935149726786, -6.748254495375445, -9.802722796885133, -5.872224901308812, 3.8714351989906977, -4.32652094965055, -0.9247891595938853, 7.3222349172156775, -8.023681651482788, 6.834763520297859, -6.391559489253346, 9.24013104954491, 0.4668691924038004, 8.1664041981529, -1.0076133934229965, -1.049197775752928, 1.474130572166196, -1.2370346282330615, -9.400228641962654, 6.074139486719833, -5.927667260431835, -0.4644729642644059, -6.23489694259561, -0.03822437750197949, 8.128773436822371, 9.291681420136364, 4.135212286014427, 5.4524809259466895, -8.214535239544789, -3.8026668801100456, -3.2585092437793506, -8.469274454339036, 9.316781168988292, 0.4032808049446057, 1.7334476474032439, -4.4034617831129435, -5.0452907299324306, 8.50985199946081, 0.1080462233212458, 5.82907420678602, -1.7506050404890168, -6.185383822973685, -4.2816028371354875, -4.331278342031015, -6.583307353538279, 9.81777657005459, -0.09350353231790187, 5.453232818834596, 4.972986019203329, -8.53770404806535, -3.1048755652013504, 3.652964225494614, 4.362629930860253, -0.6594332133905318, 8.745048240277814, 3.13529396715178, 7.232864152194459, -9.418642372824184, 6.356716705348354, 8.412915669244775, -9.954931953519575, -8.718451542182546, -0.4330005820158789, 3.3514890977657767, 4.872803579061271, 0.17309290453961879, 4.216580689125266, 4.343978861147104, 0.6284890853148575, -5.337359830266141, -1.2160175113480776, 7.235777217456501, 6.479016415243738, -9.831875369751565, -3.139601235178173, -9.398945420927644, -3.445444064443728, 3.9451506789304513, 3.0105402437640176, 7.089227786556535, 3.4808160944797883, -9.390578296110998, 9.272042970135999, 8.157110722975126, -0.20063517395070996, 9.589986549644696, -1.6222258172449777, 7.387871720514564, -6.378035757424154, -5.150594458417088, 2.9791747156245236, 1.9662064064578004, 5.5687613435716905, 6.0721323091727974, -5.282399963733198, 8.345936460917674, -7.838007531129676, 8.760667773992509, 4.532375243013947, 5.577302805252032, 4.14867881408342, 8.205598793459025, -3.1534419091746058, 9.421674145142216, 1.5738020646030666, 1.3358401414553143, -5.181033719670687, 8.99337528255009, 0.1555479834091127, 8.667478029651736, 7.175154556125911, 7.647263568065583, 8.088046867454633, -5.148153337755012, 7.380759812315208, -1.2497128034086202, -8.377071484075849, 4.301453068399091, -7.147190778643497, 9.04117482075377, 1.5024614389954607, -3.9014978840458214, 2.844891791006191, -1.5963371457669844, 4.4766635784727615, -0.15002760471275067, 8.148328751728535, -2.519945175052345, -6.834428826117427, -4.306852232817995, 6.501089133377828, 3.071184660483169, -8.651040076609686, 8.72085454288337, -6.130441404631695, 0.6089698199059974, 7.1875337138075, 2.375446169530184, 1.8371128994397257, -4.11058337111319, -4.034661862318432, 8.456178356593526, 6.041517569273772, 2.9886340989177445, 2.1397082741330884, -5.810082405427415, -0.9870225202139302, -4.690021440447967, 9.62402833497185, 0.0050808685780179275, -5.084947673369773, -1.6968302309127168, -5.101486090861664, -3.3411441350143463, 4.210607861149763, -3.6300186706225412, -5.02076603377287, -9.724989380137748, 7.970672698441518, -6.235598816707193, 6.226725456410897, 6.881294154073473, 0.08223806542826573, -8.534726760756692, 1.409243499653483, -3.506764249108998, -1.527065791140295, 3.080595182430903, 1.0702188800398247, -2.9888908562611753, -9.55184918790193, -1.1978632131851459, 0.30936363165900715, 9.08280190553555, 9.969129271030411, 2.027133617571387, -4.885558174700815, -2.534506880434293, -9.835423688293279, -5.176826709092852, -8.829480353326495, -0.8174458017085797, -0.4693253647771467, -4.006388257978051, 8.660941720908234, -6.84089306465882, -5.077032654151592, -9.57308923704873, 4.658902656920061, 7.231681804397962, -9.657101881784984, -1.7650480353407403, -2.6885448556691465, 9.442716841587632, 9.231868782931322, -1.9764077974418903, 3.936806342842827, -9.641875045228927, -2.877452019845375, 8.31990642894672, 7.1954087290741775, -3.8241966436338686, -2.0841129262174025, -3.6736405957469405, 6.561995243011431, 6.977473809303685, -9.488629774010125, 2.0382240812343166, -2.23722702587642, 5.7850078971234105, 6.404430381239532, 1.9782631492976694, 5.568898144570998, 6.626347633915351, -8.114682976761028, -3.706084412210986, 1.155590583834421, -7.89894934523903, 8.330907441422045, 3.4259027422356603, -6.896564467051558, -4.974592094987582, 9.345143799591508, -4.179194195883227, 8.625025990535047, -8.641131111225013, -7.4030795943389744, -0.006466425308705226, -9.458344930766682, -7.707204598094002, 4.113697072523095, -0.24594110080736087, 3.558016401120083, 4.375639638258914, 1.8571853898737896, 5.311734405627391, -5.892907916851195, 7.049002101829981, 9.165649747721769, 9.817648411850222, 2.5669165612246747, 3.7287508723737552, 3.0624961178296832, 2.1899776887788303, 8.584205579057816, 0.9106362895139934, -2.2388626614483575, -9.571121029445122, 8.73547171029529, -7.480970045778337, 7.336309495404802, 8.236276915916292, -5.899210915859294, 2.21188415939994, -5.7585784711710435, -2.305343655468688, 6.991519757088557, 3.365890200750762, 2.25473467117207, 9.785996046236598, 3.6115737622545794, 9.066673895515613, 6.8526664534098, 6.876699908060658, 7.4364495951330944, 4.505748508808612, -5.05099034789708, -2.190654251534257, -4.911182385546631, -9.231443742572127, -7.786378074464673, -1.026445048313736, 7.0581493835822755, 8.84165626343243, -5.136564628396593, -9.248023023490797, 4.673231329053245, 7.4109122345879435, -7.36730770548273, -7.18466613902865, 4.450993418730318, -6.894603304686012, 1.3487726308398287, -8.646308094654724, -3.7265110253523765, -7.270750100729262, -3.5445937863419825, 9.962795295081627, 5.530371133312421, -0.02989991405697978, 5.769783270030118, -7.836101519485556, -4.17670005235866, -8.086891966321136, 7.292745621991244, -6.4118753455736766, -8.069250434708362, 4.732333648918585, -6.723951881334173, -9.140344439432681, -5.88231019068396, -1.6139502911986412, -8.772700289109416, 1.6617505745847225, 8.522395438372744, 3.8631245978176754, 6.040490294319628, -8.847435813002209, -9.6922661907385, 3.5203502551948027, 3.054197549350583, 9.316791620426702, -5.288870578453356, 0.7253492112274422, 9.22559556825885, 3.6544947731487714, -0.3552288903615626, 9.330045159729604, 1.6787568420032084, -1.7889059646677712, 8.953898403029193, 8.040846720239298, 9.665623094300628, 0.24007878798940574, 8.7159367797619, -7.200191519645669, -1.8448530527385252, 2.936881846103688, -5.632935643352468, 7.484232231962764, 5.569459595654788, -7.340417815455494, -2.8904045790826993, -0.4963729599254485, -3.018409284363573, 1.382185562403306, -1.9121274117790712, -8.077507386738692, 4.723284559632962, -9.939202514436765, -3.4628320742343233, 8.09853531717405, -8.94278673651261, 4.831509375721463, 6.545388094252893, 4.279814101541849, -1.8695884937644518, -1.3827474093847272, -0.18257232728954875, 2.523664933422701, 8.862660465147552, 0.6033721867290858, 1.6525281941565773, -8.380964744807898, -0.6777431926954591, 3.6709909932794567, -8.713872450545537, 1.1836852461819358, 0.8369190319051434, 3.231282634924849, 5.187833988328979, -5.794548538255588, 7.943585244460763, 8.76253770533156, -7.0138072277452945, 3.1526211593013223, 6.047955365043787, 6.276325846364571, 7.393361604678951, -6.708500813303758, -2.1792323587995144, 4.703573905887508, -3.1691476172304256, -6.425768468016127, -8.290048465040648, -8.08618343021786, -6.809506216179284, 0.7831768159893286, 5.916026672894915, 8.039149783276777, 2.326369345491777, -2.7758235234303053, 1.54569309260917, 3.7488294395105832, -1.1557317373611653, 9.425414668009502, -0.5342615116758154, 8.779320493870852, -0.7049678698301314, 7.083825610663631, 6.505546248837465, 3.2277653355337037, -6.149649125725389, 0.5651201527386611, 0.2736306275515723, 1.8779687137017618, 5.441943032006549, 9.240757840109929, 3.491786912671678, -5.631622931914013, 0.29047003571076324, 5.037585463492778, 3.7266415070308376, -3.9303179037066194, 8.61597801113281, 0.7689999631575439, -1.4553149947318662, -0.044776572165552864, -6.581756338309761, -2.7572397245258573, 1.4601706888531236, -9.620385682252275, -7.693627828686045, 6.318665319789602, 0.19159404704912575, -4.389956114699913, -2.1616775596408155, -1.915543494914127, 0.5436426413748929, 3.4337695007435425, 4.430350193501125, 5.579427605084202, -9.855571170093345, -2.473162179647666, 3.7326642351267463, 6.977621453173697, -7.246167925762402, 3.014289540982025, 9.022096291298052, -2.549399033268891, -7.505908014077374, 4.489566664763645, 7.739075987106652, 2.0581229273572443, -5.691383351490775, 1.5899955417042513, 8.272274826937668, 8.27574348923265, 8.343606795032407, 6.851058999093574, -0.37805463236720627, 7.375035883620868, 0.8176628034351978, 9.478810620529497, 8.521501846225682, -6.404082369751649, -7.440728898297206, -8.463576744222799, 5.217256476586009, 5.247540630594809, 3.3190638914760466, 3.5890347617475378, -4.153512340317338, -3.387248051310796, 2.6591080302292944, 6.231902060313349, 5.97974207475993, 4.215422344101507, -6.6925512323492615, 6.781906598334263, -4.403099503005508, -5.6936444540064945, 5.544446699560012, 4.690840644497548, 2.04949033859787, -3.9940714696885893, -2.222645214862098, -8.72463948207584, -7.192293471617138, 2.0349398371127094, -6.436985067401171, -0.6676310394832932, 1.9114908494805043, -0.05148588392611941, 7.304610622250593, -9.532753749731317, 0.8871185635491123, 8.526030951948883, -4.7651014221488435, 6.1476933770718425, 7.000174426899687, 7.2407148095189555, 1.5109977038688776, -1.0306863033235167, -0.16048473017796283, -6.4317774452227106, 6.5002940495749115, 9.43447255189842, 0.8976245071074036, 1.9501474130603196, 1.3583186461732328, -7.739974998834562, 0.09147745180261424, 2.4479106574570473, -3.860740131853535, -6.290567803090045, -0.026813166876380023, 5.771862626228826, 5.992711104522483, 8.857894874621469, 2.5463834530727336, -5.948843658384167, -3.1042298416617005, 8.60646896158783, -8.671058533206535, -2.7979999692362885, -0.5065347140309644, 8.736697800476144, -9.241956047167623, -2.1795100417453845]
BIASES_LIST = [2.9592165604983087, -7.381695580351089, 3.7309402357777994, 3.4744991291807654, -6.534806329607809, -8.623210932349947, 6.575868845624736, -2.9468610672649724, 4.883141185908995, 8.674798245297247, -4.046261215922547, -1.156344802094054, 4.30032059232483, 4.642478292044327, 4.511641221866922, 8.128782054010419, 4.872000922835815, 3.1801596795583364, -1.4008430567744075, -7.809174426817085, 5.86219316548809, -3.080548564445669, 7.6812930449906744, 8.073560312170155, -6.00862578032565, -1.4650384362769557, 6.570938713368928, -1.3579397090957475, -7.9459640629468105, 5.374251678618547, -5.459995929143289, 8.006219895649963, -6.716037705313789, 8.169143462044467, -1.5873825922049143, 0.5699976945421188]
SHAPE = [27, 16, 16, 4]
=======
WEIGHT_LIST = [-8.233523491855433, 8.63004662510761, 3.8116956690695325, 7.149759437659554, 3.095918937410369, 1.042730396955978, 8.499583061790972, 3.6477426453680586, -5.3007758324904035, -1.368659930379966, -3.3619472879173085, 6.868595055356984, 8.778823919033407, 4.8158937517372085, -4.099590854890199, 6.904389837542723, 5.149646700229928, 2.2419663772408978, -4.104293438202376, 2.603161663813358, -9.499651928747264, -2.3209095939706774, 3.3153271377262747, -3.693635513932179, -9.439271638158077, 5.085497390731851, 6.3724138634089975, 2.2633447918718126, 6.548472808981295, -0.9935435795424397, 4.476965075705815, 3.518572087218949, -6.900606888235899, -1.3951020540908026, 1.8628350619537315, -8.688152506007299, -5.075459068683362, -4.079524211674834, 9.69552420502923, -5.580475425059426, -3.401019495364168, 2.7216338377587324, 4.308129458659355, 8.725607940445354, 5.949161854424974, -4.1840313676472585, -4.331322863331534, -7.3754123707219055, -7.4357355304473955, 2.995562463028447, -7.876796547515044, 8.43726025524472, 8.16520592710782, 7.713639546429775, 0.05344083501361396, -3.4836680952758066, -1.5330699154892162, -0.9682599740787783, 4.349074386755836, 0.036771013373730455, -2.0194310837484704, -0.3253518998616389, 7.734472497998727, -5.487360668565788, -0.7622770832671684, 7.788488950498554, 6.043197255287225, -1.022106241431871, 4.303225693073028, -2.2303098418552185, 3.049518962015714, -6.03949757694725, 5.009772371057785, -9.322531452198145, 0.7238873149771479, -2.4172116596957167, 1.8291505889684245, -5.0362255999798045, -3.260206800385566, -1.409724829674861, -7.312480734189892, -3.1390294255626205, 2.347370866164402, 3.9737148956160873, -9.515989280700058, -5.58357774708238, -5.767824323800621, -7.947583574403197, 0.09804203169368542, 0.24213531359337992, -3.935090170426829, 4.9879508945117195, 5.722744329225449, 6.309707655880146, -0.004504578057888509, 2.137248067684469, -6.02256996230169, -4.53155162483265, 7.0047978538948, 2.84281894092935, 2.3821237090769145, -1.175933281071444, -8.725565008242306, 2.200535157553835, -9.701435846505618, -9.783468577555457, 6.21706303507327, 9.709174890818673, 6.470579710400337, -3.75950077156374, -4.418510175740662, -3.8721257783333645, 8.127108650060862, -6.785792381337961, -4.699963764480297, 6.905598057205864, -2.018715509666851, -6.707660370696356, -7.721603417955527, -4.737761975843588, 2.352920531325033, -6.772815740863932, 3.7918943582176308, -1.1404116463266156, -9.263323365072566, 4.765187951336433, -3.424178302293721, -6.840372092345954, -2.8895543386847056, -0.11167907239306452, 7.505868545031586, 3.2974198186071177, -2.7281858140339548, 4.920914720647664, 7.001842349165642, 2.47547901581971, -5.582718181677642, 2.6827817020670217, -8.450325249922916, -0.4359191567634131, 3.2697923152595614, 1.4809961153862616, -1.6554469299629542, 8.939972693110285, -0.22379846604362186, -8.028932240531239, 2.3314228729296183, 5.164479961751097, -6.2598281804868705, -4.011007621263543, -7.583357777541757, -1.5936332791041536, 9.046554097338976, 4.810174450785375, 7.224432892137983, -3.0238654817958626, -3.107866510867554, -4.129814528538551, -5.063009841904962, -4.335668040602878, 3.3544824109120235, 2.887230698034095, 1.8001210014407558, 9.687450112893796, 9.635897498927172, 2.23940976029456, 2.8418895231686196, 1.8842624816866582, -4.563768119192013, -6.448615211888534, 9.890088726061514, -8.690905372480401, -8.844518138345766, -3.485007014575956, -9.626727678226409, 3.513108551986882, 9.956321040419219, 9.237813374055591, 1.3382688304704633, -1.409584394799257, 0.11198468882434476, -1.5301534460189998, 2.847218805946687, -2.723907888155188, -7.4571399924665265, -8.54206520588949, 2.9471740408208333, 1.388270559677597, -5.4970835799981055, -2.828201055326285, -9.661119644966343, -8.132474525338395, 0.9724731553653143, 7.503477620125686, -1.7834619257243727, -2.936746088078179, -9.221144503032106, 5.398533141014534, -3.5694399862684385, -6.841319684622357, 4.557247689887443, -4.564354774969583, -6.04889445699315, -6.445460521023478, -3.860651150324985, 2.038239640973412, 8.825987312128984, -0.4066003074853146, -6.753227383598867, 5.053165814490637, 2.7272898048415435, 2.481985532540577, 9.794413706109545, -9.94087109457464, -1.5594439193391256, -4.740254538120208, 1.2673092232193603, -5.331240406480573, 7.535486900617652, -8.664967017272854, -0.2459267368909117, -1.465779073199105, 5.112846481919327, -8.911912999314646, 1.23122329353005, 4.01477524666114, -8.658729232674895, 2.6503277667215404, -9.553426222489092, -6.148647448787692, 0.44405499287178785, 9.84836151365257, 0.4524833220540696, -9.47586639910216, 9.496940392957281, 1.341784374484714, -6.106282960468244, 5.2715934595281055, 7.973647624647501, -6.238031491563203, 9.045028021337643, -0.9515616379759511, 9.449131410753754, -1.3409956219787844, -3.4362877059925223, 7.000102416563841, 6.176828178511865, -1.6435772709016625, -0.36475961533400714, -5.761754865175983, -8.968367755327634, -6.208601160741772, -2.318166002804123, 0.9224149418655401, -6.4191111818246105, 1.515268563566126, 3.2617473018058245, -8.243869913964883, -0.7393146440189486, -8.865762606805113, 3.3479490977551567, 5.32643260857432, 1.7788569703396249, -9.897968311978595, 7.9158510270926605, -6.13762935267566, 1.861700624179342, -2.6671746992141703, 6.625623228933524, 8.616576396410792, 5.66170792709379, 6.568918310771345, 8.806422030436451, -3.4052118747164357, -4.188039717543708, -9.229981152096034, -8.415082189362854, -6.4313377601206545, 4.50085833403236, 4.743140488581732, 2.584802505344605, 0.09659687148019636, -6.227436499698378, -5.815698146287973, 5.999950325806596, -5.024796773975937, -8.094935402688597, -9.023981751693347, 9.593044001662147, -8.95464156114129, -3.3869429267084383, -1.7691214887218614, 2.3857215349355076, 0.0033578885402576475, 5.075584220341206, -8.145008023998228, 3.4666653677114994, 7.2690283782852525, -2.8301552680429882, 1.545050621229958, 8.353302678797142, -2.9125826010201505, -4.301670497502547, -5.442810793127222, 0.685550399796405, -2.5279960474621337, -2.163934885945582, 4.325906810202785, 9.970184585838403, -2.9426114886542027, 9.057480473869784, -8.586975865856703, -1.383967111333373, -8.169689818950932, 5.825663687439098, -5.994748919869279, -2.403603121711466, -9.468806240770945, -8.631253780841037, 9.612659408791725, 2.649738752899321, -5.506483623754351, 4.347364070071539, 5.225838801050651, 7.022956552066319, -8.730653621860263, -5.112807249088984, -7.803184250508577, 3.8217426395019576, -4.233014152454051, 6.970577272428823, 3.4739139596130073, 4.884135159259994, 4.109869612351556, -3.9412243353263072, 7.089230831241814, 7.577700340896957, -3.767981391692996, 9.89995965554288, 5.535571669403277, 2.432603968274732, -8.24942288604798, -0.08894256626794039, 0.17652623110043208, -3.6915748264310206, 9.039280927157321, -7.125301364305234, 2.0286154526059192, 5.346333472981941, -0.8329009513277654, -1.0549153415479502, 9.318207543115829, -0.48536440221461064, 3.7683082219004547, 7.309535813107281, 0.0295312215387451, -0.5860004400070746, -3.3119209958546802, -6.339469252872316, -2.8192994611175255, 6.112984161007745, 7.5067199047446955, -8.302798816404266, -3.838324679777683, 8.70387932013514, 0.22026646537793937, 5.530698256864834, 8.442505221487778, 8.34730486048689, 0.5903002274720848, -2.138612280713832, -2.4069093998186997, -2.535087574833357, -3.510074296898493, -4.751806108229111, -9.919717889385531, 0.8063108043139131, 8.035605095015907, 8.03789217392691, 6.1173666993589535, 0.2792789004638081, 8.627062443489809, 8.735492086750021, 1.01303334322429, 7.773234688671803, -8.82798555671324, -7.290124069974702, -6.873747801030565, -3.606172576522228, 2.570589365588031, -5.211127399136901, 6.217756927647727, -6.794555607974342, 9.806509997044628, -1.0852186561709125, -9.205089166021022, 1.7366479957182346, -6.31739233501984, 5.622336430156649, 1.803660514636988, -6.23278673491293, 8.426576550016307, -5.824700853534946, 5.05119479723621, -5.963476098381715, -8.39566013439531, 7.874133414516468, 8.130409171988514, 9.15591246243471, -1.1816312199084038, -9.413885618135717, -7.459497555834522, 7.81092785324693, -9.577352698706115, 5.686591923667967, 5.357443403406492, 6.29697565587378, 2.74063861925001, 1.1770872972794937, -8.54990122791807, 4.217211020438313, 0.8794736400023311, 7.260395749564449, 8.3896594181371, 4.420235422228554, -5.3359220695564735, 0.09314872644595518, 8.518389443966939, 9.469874991251615, -6.591851278251097, 0.4796092416577107, 1.882601006846878, 3.5582913969584915, 6.3851762440838264, 2.666208078254373, -1.0787175316633313, -2.155128414468706, 9.530512541877634, 5.580001765169369, 8.28594829133489, -4.1096329976633506, -5.6140187169958855, -8.108485770155337, 6.950227439105966, -5.296648482445385, 6.938269328175121, 8.268010327332426, 1.5070339311298735, -5.778561706391527, 7.467085187995433, 4.627157025604012, 9.844474461947303, -7.116840196641043, 0.8232995097491962, -2.2519893109260742, 0.22371174369119018, -6.6995837583265905, -5.9675467804837545, 9.745164639046259, 1.302867119957419, 9.787777954160383, 6.864081429964688, 9.761481242399807, 1.6327444779285205, -6.069372549760786, -5.976549706092289, 6.226814817041003, 4.377710046358143, 7.251165967658185, -5.830236537819651, 3.915223789613121, 0.373767029419545, 8.401423279141262, 1.4751557850536834, -2.628496768011395, 0.9149030827168065, 0.20496320856300976, 4.614559768953967, 4.395818662870958, -2.2729791194534226, -2.509484122285972, -7.3818046665418535, -8.884562077370497, 7.356038780095545, 9.695046595229812, 7.720664231525355, -0.7355528647376453, 7.72580115334954, -7.4977604169594825, 7.205597962654785, -8.1935322748819, -5.141361860695335, -9.331670122569207, -9.161487707850561, 5.64645330492449, 7.074035318491816, -7.221389496517379, 5.681278273012973, -7.759517605087969, -1.2568079638323653, 5.343839166677784, 8.514121670853708, -0.3903089487591096, -2.115938434031561, 4.7140472813534995, 9.260461180283851, 3.3404811615913843, -5.572065966565509, 5.726721708273967, 4.327736886599499, 0.27861846178289795, -1.6362906870315612, -4.200860285879971, 2.241286248924329, -7.39971357970253, 9.462776127659538, 4.600760207384152, 8.179150657564335, -8.101532829011823, -7.567451492322359, -1.7276280596625497, -5.155698980129904, -0.5115146628878158, 5.559076863042643, -9.754465447230272, 2.8775816453091814, -9.187747640099328, 0.43114892741273536, -5.715087649169739, -7.5150764001410275, -8.417532214895866, -9.659669028118952, -9.33090969574965, 2.5747677514431757, -8.253238072167521, 7.653002175858397, 2.4867145685957244, -2.8422913075994156, -5.410329813318797, 2.260452229932861, -7.897904365634214, 4.108418552002464, -3.893788401640119, 8.276308192190388, 4.94054521415717, 2.7999597333800956, 6.643695009184643, -2.736031699148027, 3.4568780765476674, -3.498842587256288, 4.531847657848365, 0.6337578425094073, 9.533392560191462, -9.120598777609878, 2.6555096451811018, 7.741840133381412, 4.854549261044674, 9.05286177601511, 9.233577427107583, -2.746062260895439, 6.158839772523962, 6.364715766928594, -0.9350093030514373, 4.918115110663329, -6.607070647536048, 4.890831849853587, 5.250998749758931, -2.3434552363208505, -4.2141636286657285, 5.164460504546117, 9.838313704689789, 2.7992602004158265, -9.871137678301718, -0.7183121750742298, 8.040883306659662, -3.9625536416747753, -7.47193171825611, -3.1111404617056504, -8.108806251771517, 9.333980308039685, 5.971740479382996, 3.7014379256916143, 7.481263460964563, 3.267602232331022, -7.0668440566489865, -4.60174030913535, 4.313965354955771, 8.285360199211947, 4.5350992645927946, -7.45599460371116, 2.879238903075219, 2.578134332093862, -7.151209405208374, 9.61353820228313, 6.5235549887788835, -3.3985938837061376, -1.741836232205662, -4.229565731752347, -5.1270157420485525, -1.1669823809970516, 4.493243585468784, 7.553485246250826, -3.7458541287136438, -7.88607949940536, 7.70539364695729, -8.101274472440211, -7.9884229393296895, 3.873105696365492, 9.88216452643627, -0.9352710095657528, 1.8571628822928332, -8.028166275979933]
BIASES_LIST = [-6.198065879768169, 8.346002473142626, 6.0045716571613, 0.9865512080283025, 6.485773397013681, -8.209951997652333, -2.9188583371071157, -6.3649758443377795, -5.552458418536473, 5.820002124046006, -5.516724334485774, 2.353650321649269, -6.1483489923170715, -0.6986508765759876, 9.078597189341028, 0.9362456553416934, 9.96835592048894, -1.7604700540733589, 3.8664019018948625, 0.1231652010163149, 4.100312991272618, -5.907755723987, -4.016381387017649, 6.828797565702402, 1.6281374979037473, -4.082390968924708, 1.8915013767113251, 9.740918198562916]
SHAPE = [27, 16, 10, 2]
>>>>>>> 7d31a6a87a720dfe4ed79aa94e6595884cb1bc5d

IN_TRAINING = True

## NEURAL NET FUNCTIONS ##
if IN_TRAINING:
    import numpy as np
    def sigmoid_list(x):
        return 1/(1+np.exp(-x))
    def dot(x, y):
        return np.dot(x,y)
    def vector_sum(x, y):
        return x+y
    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = dot(weight, v)
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v
else:
    def sigmoid(x):
        return 1/(1+math.exp(-x))
    def sigmoid_list(x):
        return [1/(1+math.exp(-v)) for v in x]

    def dot(x, y):
        return sum(a*b for a,b in zip(x,y))

    def vector_sum(x, y):
        return [a+b for a,b in zip(x,y)]

    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = [dot(v, w) for w in weight]
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v

def list_to_weights(lis, shape=[27, 16, 10, 2]):
    weights = []
    index = 0
    for i in range(len(shape) - 1):
        row = []
        dx = shape[i]
        for j in range(shape[i+1]):
            row.append(lis[index:index + dx])
            index += dx
        weights.append(row)
    return weights

def list_to_biases(lis, shape=[27, 16, 10, 2]):
    biases = []
    index = 0
    for i in shape[1:]:
        biases.append(lis[index: index + i])
        index += i
    return biases

weights = list_to_weights(WEIGHT_LIST, SHAPE)
biases = list_to_biases(BIASES_LIST, SHAPE)
if IN_TRAINING:
    weights = np.array(weights)
    biases = np.array(biases)

nn = NeuralNet(weights, biases)

def check_space_wrapper(r, c, board_size, team=Team.WHITE, opp_team=Team.BLACK):
    # check space, except doesn't hit you with game errors
    if r < 0 or c < 0 or c >= board_size or r >= board_size:
        return 0
    try:
        team_there = check_space(r, c)
        if team_there is team:
            return 1
        elif team_there is opp_team:
            return -1
        return 0
    except:
        return 0

def flatten(board):
    lis = []
    for row in board:
        lis += row
    return lis

def copy(board):
    return [row.copy() for row in board]

def pawn_turn():
    board_size = get_board_size()
    team = get_team()
    opp_team = Team.WHITE if team == Team.BLACK else team.BLACK
    row, col = get_location()
    
    if team == Team.WHITE and row == board_size - 1:
        return
    if team == Team.BLACK and row == 0:
        return
    
    board = [[check_space_wrapper(row+y, col+x, board_size, team, opp_team) for x in range(-2, 3)] for y in range(-2, 3)]

    if team == Team.WHITE:
        forward = 1
    else:
        forward = -1
        board = board[::-1]

    inputs = flatten(board) + [row/board_size, col/board_size]
    results = nn.compute(inputs)
    best_move = 0
    val = 0
    for i, v in enumerate(results):
        if v >= val:
            val = v
            best_move = i

    if best_move == 1:
        if board[3][2] == 0:
            move_forward()
        return
    if board[3][1] == -1:
        capture(row + forward, col - 1)
        return
    if board[3][3] == -1:
        capture(row + forward, col + 1)
        return
    return

def overlord_turn():
    board_size = get_board_size()
    team = get_team()
    board = get_board()
    board = [[0 if not x else 1 if x == team else -1 for x in row] for row in board]
    cols = [0 for i in range(board_size)]
    for row in board:
        for i,x in enumerate(row):
            cols[i] = cols[i] + x
            if i > 0:
                cols[i-1] = cols[i-1] + x/2
            if i < board_size - 1:
                cols[i+1] = cols[i+1] + x/2
    m = 10000
    index = [0]
    spawn_row = 0 if team == Team.WHITE else board_size - 1
    found = False
    for i in range(board_size):
        if not check_space(spawn_row, i):
            if cols[i] < m:
                found = True
                m = cols[i]
                index = [i]
            elif cols[i] == m:
                index.append(i)
    if found:
        spawn(spawn_row, random.choice(index))

def turn():
    """
    MUST be defined for robot to run
    This function will be called at the beginning of every turn and should contain the bulk of your robot commands
    """
    
    robottype = get_type()
    if robottype == RobotType.PAWN:
        pawn_turn()
    else:
        overlord_turn()
    bytecode = get_bytecode()

