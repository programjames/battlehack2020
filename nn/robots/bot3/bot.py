import random
import math

<<<<<<< HEAD
WEIGHT_LIST = [0.5618565963708777, 4.905625092708299, -2.314245823697726, -3.5508586549664813, -2.320371472814589, -5.295634081938653, 2.8743645050272613, 1.8306707630521808, 0.8043404271321849, -1.108680201601007, 2.605032546627927, -0.011357505744623474, -0.9019279991950591, -0.7617097992852256, 0.23423866934081752, 4.932076243274806, 4.6782793688580036, -2.976189642684079, 2.8399073598294264, 1.825768264724811, -0.37873938466628054, 4.349938344778892, 4.9348222393727985, 5.417545176233303, -2.120356776714092, 1.6126249452396035, -2.187496700462448, -4.36001714181481, -4.9018513479834604, 1.3841922934775495, 1.3625825852893163, -1.1167151341840462, -3.393499053148605, 5.256858500060781, 0.9929936417212345, -2.4994096654808327, 4.151244954929962, -3.2889104284166844, -3.7477539899876744, -1.0299831591780226, 3.8322087412495764, -1.8627592166827727, 0.43718144697263933, 0.15976456125206703, -3.262343005846681, 5.732880402749321, -7.88402093881475, -1.0406472119854833, -4.617008814684798, 0.88373038667918, -3.837568426607523, 0.676314236699314, -3.5768957799966135, 1.8938199115330183, -2.252191787325719, -1.5903160649824948, -0.4156957588631598, -1.9802996767810266, 4.889896995505684, 9.880514827846586, -2.1973497857173334, -4.4928444444332225, -4.313917478826944, -3.5267670425761484, 0.7277534616646042, 0.19981364896734402, 5.3607121042080665, -2.1974444686946013, 1.2326386350223775, -0.6862477458401499, 0.4478746138885405, -10.346002317767109, 0.48891143920842745, -3.6921347284881234, 0.04256367061236939, -0.9654923378155068, 3.3946702359546483, -9.80211328970727, -0.07589442583532267, -0.5713944906312559, -2.415150808315645, -1.109088767347686, -3.2509950473605156, -1.2243252694655407, 1.0164884744811042, 4.804418998452669, -1.8347500732384379, 3.9935775871477786, 1.364059194020843, -0.6912383676529354, 0.9995953650033337, 3.7780703420791872, -1.2431228457701315, -1.0573469794760777, -1.5795867790872749, 0.5389677929336065, -1.7508148805922994, -1.1348805561464834, -0.6297407663121366, -3.6885679681424937, 4.118743101592848, -4.827840210175099, -2.329322778037447, -3.6086892359286558, 4.937612012317983, 0.7476257895840216, 2.6966811494244958, 2.6870988329791072, 4.962546327172462, 1.880673415444017, 4.384785159204991, 0.6073378247173871, -0.5347525944983628, -4.317064690308235, 4.45936652407444, -1.7115103249560402, 2.561918860042681, -2.7691833938549073, 4.562243285622876, 0.5741225230246025, 0.6282355935775633, -0.16057280856661435, 3.6010535131476082, 2.619931635386528, 7.01172096732028, 2.439500238785878, -5.358912978336445, -5.6326204658063785, 2.553798708416762, 0.06007233544633582, 3.627622846589634, 3.845045337788453, 6.500053531305895, -5.745659702153352, -5.192703147638113, -5.16392592063145, 5.243566692045138, 3.505497078543135, 3.569678952960095, 4.550255180243987, 2.0735604863696575, 3.4821077486030623, -5.225934173806827, -1.0527045924577356, -3.685275870926407, 2.519320511883823, -3.9498110191794695, 2.4798144860377898, 0.46763239174595195, -2.4761281144485343, -0.4263095632919832, -5.1188034351426115, -2.4196586960404827, -0.0018565434121128148, -4.157521602933548, -8.68105769093138, -0.22065484321837642, -1.8168587289470057, 5.465795836557808, 3.804312984463166, -0.9472566242795251, 3.838591155929811, -4.563439357652305, 4.4802138344303435, -1.125373492113129, 0.3674479285975168, 2.103117445222153, -1.6883825015200449, 3.3684714374554474, -2.605247110010212, -3.4518288145065816, -2.42449900370254, 2.064426564454701, -3.279298005583391, 1.8343729449829347, 0.1959483880744147, 7.299778126381313, 0.14181455728456677, -1.2355870088116379, -5.378386185473801, -3.2197414097106325, -1.876807060419107, 2.1504350019844085, 3.655661894962043, 5.112560081213503, 1.130956072218354, -2.635380831602714, -6.110332026023907, -2.5148141595962508, -2.1320449287360077, 0.09041224257796522, -4.279582113228497, 4.583394061650476, 3.2549843934112523, 1.912674727079508, -0.4339200043490629, 0.7543319377392732, -0.5203460193019126, 1.6988495927359797, 1.767062528866699, 0.127763721728475, 0.7061710403476688, 3.033575598086441, 2.4170317470012215, 2.250911032822818, -1.3488165473258982, 1.0351965352604842, 10.578716363033354, 0.5779480996379939, -1.1299735536687712, 0.6043274354016329, 0.7556588946335935, -2.9414751618814057, 1.3061190943244894, -0.6492168175117213, -1.7584714978036542, -1.606105187000718, 0.3332540656897555, 1.3038789602914158, -0.7459432078134105, -3.926991124849844, 4.08127394756346, -1.573829533736983, -0.9519284730884243, 4.252478103319427, -3.528835927156254, -5.02205435075174, -3.323667428071671, 0.15553600460391356, 1.7335758429028023, -5.336975920127041, -1.7021409823041915, -4.6902476739171375, -1.6439401460744922, 5.271802980842708, 2.4025204364774106, 4.278329049703308, -1.1723210673140974, -3.628249078327328, -5.931684684489142, -2.5724076382127237, -2.5882510781536734, -3.5937273165743377, 4.865206037728937, -2.602704274444568, 1.207409686904169, 2.5960184616742152, 0.21955066841376353, -0.08458109083056027, 7.126657242821501, -1.5423657859036495, -2.1134067260020566, -2.2932182819979143, -4.266419786669187, -4.854804113888582, 1.0192466915218679, -0.42047987893133193, -0.354896472512838, -5.810181698005316, -2.5133718947202035, -2.7296202383363704, -4.5774700531304795, -1.8306895044885976, -5.903382692036998, -3.060610375425752, 2.690788639416939, -2.3699722406786052, 0.5895961311026565, -3.768452561904186, -0.5514938844994236, -1.6615069494266193, 0.1713210087643251, -2.894694361000734, -5.6164031370420995, 1.5190308667302288, 2.0342934075956727, 0.2030897788930639, 0.9928783016251879, -0.7803291932565041, 0.3657068592985372, 3.946000619465112, -1.0283040178829133, -3.894658333914627, 3.7543248176835733, 6.1592124741247325, -0.07994094664817063, -3.3830962294189835, -1.8266617324299668, 2.6409209939827205, 1.6988264640889466, -2.9762463568446575, -2.689822231824839, 2.5466084550668966, -3.5755807742467485, -2.2599754369460587, 2.3602563195133457, 8.826998850834372, 5.952010910719249, 1.803010459843256, 2.048076777358192, 4.563167728269968, -1.8821621673752569, -5.844341209358097, -1.772971624808033, -2.3737004768896153, -6.867908001994619, -2.882077308436605, 2.298737925233294, 5.067302774488827, -1.4234191550506097, 0.6757389313603703, -3.9187570783056387, -3.59594223456334, 3.263232028940241, 1.8453098557004413, -1.7788077685766188, -5.645665358105015, -2.403146692084197, 1.2884103461597542, -5.589726903353751, -5.316404378960915, 1.2790684280782594, -6.803238746531628, 6.406222215596043, 3.4309436219044747, 4.600410889406352, 2.0022669949533305, 0.27856635868371116, -1.2693184485299456, -5.562264882705847, 3.9666962782647195, -0.3353175631755504, -7.429490661828519, -0.10234094124727347, -5.025546699010694, -0.5107360947963988, -1.6765822173617424, -3.454723225745977, 6.512161535694069, -6.785966797653686, -3.23994925424658, 2.664376589902836, 1.47729300114329, 4.1906253079761955, -5.688428662764196, -4.6314629976604005, 1.7043679086754542, 4.800066467306117, -4.851260791678992, 4.648051600706833, 3.2561805311512133, -4.026958826260581, -3.3983873928772117, 2.3156136807056398, 2.33513916279411, -3.3868228637489497, 0.03427858028927009, -0.012497861209104164, 2.812707727006783, 3.239529627170553, -2.2438854056384963, -2.8256802613636336, 4.918861883579123, 6.0532846360501935, 5.280049486583284, 0.11547383394005296, -5.839826091305446, 4.259927945449364, 2.608164557405839, 0.8538714285811622, -3.2240634912408237, -4.7081564291358715, -3.672393250552054, -0.8881439289952171, 0.3428993339814753, 2.0754959331110814, 3.9186854242685873, 0.6754325799198682, -5.6523119196209555, -5.258739286241338, 0.42150715474641515, 3.423645288592028, -0.8688770044074859, 3.166499190443774, 0.12624171601561293, -2.8701868101278, -7.231562921161691, -7.878610041219628, -4.595291477173117, 2.4618357775648665, 5.607281842180512, -1.705902527057682, 4.707278561903783, 0.5115786700619869, 1.4451920665603413, -1.301636460833344, 0.33769136276326367, 1.1800648138144207, 2.2632375925399693, -1.497353599190304, 4.288778953927431, 5.55133170850503, 2.7106894902633445, -3.4505729003887837, -1.7103949865336598, 4.539166710982546, 0.701280866371227, -2.149205524179548, 3.8719074514291116, -5.55258039272836, -0.30425058101075303, 0.7837263813031426, 0.9051373757192283, -3.270129097990168, 0.9616873143736177, -5.68808781676749, 4.128219888891332, -1.5782231774471798, -0.7129185466654997, -0.9949767608597458, -7.397873983129289, -1.8356541502061607, 0.7543109301946288, 5.22089402722829, -4.348141916170176, -1.148465245486997, 4.088435360299109, -2.741210524750201, 0.9184852558035269, -1.9451044929089978, 4.395252496553517, 2.784006545408903, 2.994576266601822, -5.905461576793554, 4.937156168970508, 6.186588163096299, -0.7384885983637732, 0.80722093784208, 1.586224885651165, -4.762114853332966, -1.6141587748977524, 0.6575124689044134, 2.0143417296850896, -1.8269192149124216, -0.37792617898247766, -4.322520135631503, 0.7139109479308532, 7.986873027295227, 1.7996126292106684, 2.9277307015568894, 2.4104528453524923, 4.519525831851151, 4.939690676345079, -4.363167718206185, 4.690608750162465, -0.0006521520405903744, 3.6285426232865143, 2.5567154854100016, -0.3759544966414223, 2.5176121717251365, -0.4216777833177502, -5.915261411680897, 7.696520362363961, 3.686168805881268, -2.04037041141589, 2.0692554893987083, 1.4926675597185293, 3.1934158478612806, 1.3733397991985703, 3.0518330059140624, 5.181842017557958, 1.6534933053539556, -2.3194642819946143, -0.10988004001032192, 2.4996475042829687, 1.3440148204124245, 1.5800355626068199, 6.8520834362821255, -4.278166314843071, -2.4590531781024776, -1.1927514339179452, -5.079682414251549, 0.565134832762023, -4.3413764320720185, 2.694951494670548, 0.3988305993198827, -4.409929154952834, -0.8151658790214247, 0.4786049493666017, 6.265097154006476, -3.2840682173031848, -2.8792317776419343, -0.6953500957389407, -0.2377880068244667, -4.866040144767806, 1.3652876118087631, 2.6111080447281214, 1.8371136195636755, -0.36734401238019093, 2.7328079163032104, -0.28761492617904216, 0.10877547392781108, 1.5415547468380564, -4.740153782347517, -1.6596981957346317, 3.6026995942324263, 2.871798625310525, 0.49212935928901347, 4.260736082264149, -3.0572202178363383, 1.8248894633911192, 1.0528242721327525, -3.77322393795196, -1.7913549642771098, -4.914032576405188, -0.9747023756131589, -3.988711762723299, -1.005157237842597, -5.974937546908968, 0.30084438481309056, -0.04470108656935265, 7.013665526885749, -1.1824792482373458, 1.1088424889918762, -4.017886355261067, 6.9591850890114175, -4.077629256214979, -4.132820688010012, 2.0450408866518974, 5.107116774831168, -5.509594960788081, -6.40737181328366, 0.9143433849777934, 4.221265629331807, -0.9003600070204008, 8.078607931557407, 2.5216601617257695, -2.305361299460268, -3.3314112299772645, -1.9885717979908049, 1.460582702248951, 1.064564530936798, 1.4363493557584062, 9.021097125883083, 3.803075367674862, 0.5697976974354113, -1.2663127150553253, 1.8071811230254011, 1.503544791066538, -0.5487488130365116, -0.2875821609757031, 5.973021665010023, -0.127545234420235, -2.7926673032460436, 5.4081711630322555, -7.765148060708134, 5.249595770480076, -3.8846008602700843, 3.3995140634229557, -1.0104490809207567, 7.80802781103694, 1.8928729846502217, -2.2578290973793793, -2.18494860013302, 0.030720629346294093, -0.11585262995406115, -2.4582547071281495, -4.412059821227564, 2.215703160061507, 3.9593791307799733, 6.049633233223609, 4.873292959519715, 2.248739464016701, -2.148928663410995, 0.03131825308850409, 1.8505134624655943, 3.709191187879342, 8.940294323220707, 0.3995370738648285, 0.22489074472872667, 9.602814312661105, -0.6140658503198274, 0.5382986913623194, -3.1848724310389867, -2.554950735267348, 5.775561136256363, -2.349487802381763, -5.44880715002223, -0.23963196103774934, -7.359917338544795, 2.423572079943266, 3.0775038217161512, 6.1089546121589064, 4.95132613444714, -0.948992713892402, 3.8094729600242703, 2.9161654188235953, 4.110408110063488, 6.784821715042766, 1.3860793053296225, 2.3062009747827816, -4.2513693028489845, 2.0141295467864824, -7.717642888093503, 2.160684792993993, 1.2659072000603242, 1.219706470299527, -5.1403414856878, -4.537546005841554, 2.3639234921452967, 3.032786075910906, 4.271533425428687, -9.13856844684015, -2.4232776947453796, 7.445927898626422, -1.361226605966999, 1.445776462519582, 5.82888541074035, -3.470446230750697, 3.1646047599020974, -2.009412200062472, -9.9825090115741, -1.0519955772436733, 1.4772963176943712, 2.899987782348047, -0.9073460563890271, -0.7013397206590986, -0.8083158446801118, 2.2753144770052454, 2.485885533035514, 3.22587205942315, 0.2824827071314919, -1.418309939987551, -4.2888676460816795, -3.2281362135832925, -3.420628432374426, -0.7117436113736524, 0.8605222804449683, 4.221915901708669, 1.9557163961259518, 3.178129725454979, 3.1088284311340297, -1.4400936734765684, 0.16156773927901122, 0.961938689056602, -3.0885693147880198, -1.6493202492368506, 3.478658284495479, -4.023323772423476, 3.364548015385935, 0.5646295294791251, -3.6882980800309944, 3.4447857070436703, 5.925623583769665, -0.44555589714013627, 3.2252271638867507, 0.37633933974423356, 1.8540629573973593, -0.9164853586052624, -0.19921231945594156, -5.263377484765392, -3.352942463793205, -3.7132492786656255, 2.3391722607666923, -3.900828985696662, -1.542650368243974, -1.1352648768995022, -2.0569872814668235, -4.90358045971702, -3.8662343713226717, 1.984290751314484, 5.681499895566153, -0.20017795560635132, -1.8282528069315018, -1.3546804611115744, -4.2847973696358626, 2.3433483504379002, -1.5560950737362491, 6.685369911680624, -2.6782697507978077, -4.749510526673632, 7.885114893341416, -2.045094758821495, -3.278723410920777, -5.1636425777373836, 2.9957877724100004, 1.5184806205453376, -3.5563995444413594, -1.3642690839704912, -1.5936507482950344, -4.810831333987223, 3.331812378622292, -1.3057514422548142, 4.37870866603965, 4.630688502279324, 4.293127492922587, -4.91126538357873, 3.6478437266216215, 0.24105168684369963, -3.4014822191989196, -0.3638299335659373, -4.738839097283102, -3.5438332273186317, -2.070634530003928, 2.5225618685299556, -3.4067142903741097, -4.6763042760418845, 1.428209079203586, -2.7544487206121744, 2.0170763130424474, 0.4704063176513965, 1.6722286457394009, 3.9669212496138577, 2.9365378717903763, 2.7916895489328586, -5.864213230505254, 6.990168757952745, -1.3607436983255798, -3.4664468882096253, -2.849419253128166, 0.15004421322213485, 1.4940822756366463, 3.0333281990063634, -3.5970955865735665, -1.0496684471597977, -2.7607434357156, 0.5844794383200429, 2.185167753887867, 6.126675347358308, -2.75929077879658, 0.09488472671318327, 1.4752836438816859, -1.2531085102911999, 0.7316725920678414, -5.736983425906255, -0.8365156299359686, -2.38492664948185, 2.349966695458157, 3.7733065490048965, 6.921841132649809, -0.8742790231826832, -2.2362675880346563, -7.983384408915503, -4.329315873927331, 2.9912750577439002, 4.21805802862017, -4.4206114227319215, -1.774661138567352, 0.9759962680054539, 7.592213581141731, 3.753418814510554, 4.875531753964047]
BIASES_LIST = [-1.3831479281445742, 3.7109789502459782, -3.61504432000563, 4.793175795284738, 6.332298226571589, 2.768379452017689, 1.1028700323481118, -0.08029393241029581, -1.104497480208347, 2.654500605446971, 2.1258472443157164, -1.3676294184348092, -0.0003697128130588532, -2.617932547738751, -5.505154747405521, 5.2652094905040006, 4.821147340837239, 1.478102886288984, -6.566780298001569, 0.022974244250089586, -5.074141763804479, -2.798975509842937, -4.064119009728334, -6.099034786154179, 3.9261725308593225, 2.647440598381591, -4.024365019539371, 2.9204981675698387, -1.0810051853950897, 2.3042550552864696, -0.335909220298389, -2.299289872117044, 7.1166353899879375, 1.8536136938650063, -1.6842340047470972, 0.4488740071752906]
SHAPE = [27, 16, 16, 4]
=======
WEIGHT_LIST = [-8.120819428895238, -2.3407165110248287, 7.285822928351511, -0.6403302651741789, 4.236050065226378, 2.088655528163567, 0.1670382808460677, -6.825623184327344, -9.381551155933014, -1.3240271461469177, 0.06735288520422655, -1.9680662850909658, -0.23910054539348893, 2.0015259437970427, 1.157930295049642, 4.04682636117269, 5.028350254825988, -4.637383694819397, -0.791798352193995, -0.5007103941401303, 4.041869176625189, -1.0784913101114135, -3.594690351440082, 5.6757306105816445, 1.4356696966951732, 4.75629558521034, 0.8434721520068362, 1.637622694397726, 0.9120489656057356, 4.503046996845544, 4.186797902505405, 5.543253726315064, 0.8449364299796345, 5.765308266486987, -2.4795196960806614, -7.653128373357623, -4.0875952870425545, -4.683977022952952, -3.9000958416494496, -1.4462973344943273, 1.7020217263556698, 4.261684019691559, 4.211434586566624, -1.9896317502018162, -1.086117443637451, 8.91970551933586, -0.07598899563561379, 1.1738924291886732, 3.0725691006480327, -0.00537241993367088, -1.268474284483157, -6.260003139880948, 1.019386659028429, -4.904132410789519, 0.6730208905780504, -5.59923993094132, 7.974204781142943, 0.7809228526493757, 4.196413089370661, -0.7890633005918293, 4.632949828129839, 1.91825799290153, -4.9105119573957525, -3.3994572425892904, 1.189542189801974, 3.490665459727391, -0.9805050087973831, -2.0198285572235464, -1.1478775312270433, 5.73517749158482, -2.8486875102045333, -2.531922661357385, -2.6062050543829556, 4.833481652507558, -1.6425558313101722, -2.538660543643382, -1.1053965115720334, -0.48622304450885184, -5.511895772537889, 6.034899846342059, -3.0211415566149715, 4.936696567183083, 6.124358314141945, 3.8987718638762026, -7.359289777918189, -2.07708667819499, -5.341717709424246, -1.505110188089022, -0.5376015311158995, 8.231069337672128, 7.680456349153624, 3.7726915926307054, 0.9566846050697466, -2.3124843505079475, 2.7911494991909693, -2.148698041778845, 2.32372111792553, 1.5226923757572295, 6.206993428148722, 2.351280367393935, -1.9134659389775535, -6.744840444400433, 6.311243979796708, 4.960967414831172, 4.751295194537449, 2.2280255123313, 2.6119057612962933, 5.312058608881353, -5.5973236110464315, 4.14623555833781, -7.051125057917196, -2.840533412700868, 3.0426622071846667, -2.6341554623000953, 5.4880242073343855, -2.0907618041135376, -10.502957344005189, -1.886694414118769, -4.668487290770247, -2.5575864968808624, 3.250786087267799, 0.7653171814053714, 7.478149953166346, 0.7521332295511254, 2.0570851409911444, -0.2848704463621187, -2.5087107094009324, -2.8854245337541964, 0.7600668226930178, 1.7748781849445625, -5.114842529597849, -9.417246987721038, 1.9597110301678318, 6.588889384996408, -4.897951406860477, -1.9609520384630033, 3.577380828283721, -1.599935761548149, -3.783197840758951, -0.12780568667404824, 2.35731774740171, -2.8634922264537797, -6.998345307712845, 7.5470541984720025, 7.446271543021201, -1.5053280871647603, -2.913281887989888, 7.814624303364905, -2.5640207192802853, 2.2554093464456324, 1.8948622284012013, -4.013076738103033, -7.236132666532866, 1.0606129121379186, 1.4045907849180113, 0.5592435564481795, -3.8825549650569524, -7.276199413551143, -5.645262864025259, -1.5708196349264387, -4.8966744379706855, -4.245782301188929, -3.0360533289622236, -6.4536423102364004, -5.092933297594192, 7.156797780471357, 2.6191955198462242, -0.5465126359076138, -0.022632109215882323, 0.9380074647684276, 3.4527715262121506, -0.05610623490418698, 2.074261390903824, -3.2116064046090265, -4.155296969653798, 1.7725648076282274, 1.0320698664399166, -6.738884773682743, -4.950837947759541, 1.3785720345820631, -8.104880069868694, 9.008828912098524, 3.765957961009833, -5.713631568675488, -4.098002992967488, -0.6979511994673979, 5.801333613273634, -5.551140577150078, -4.997047419461298, 6.876224673556541, -5.375542821039179, -4.504502445683938, 4.813432675397099, 2.0412193112538657, -5.869990531395629, -5.610359386670553, 6.864561746894958, 4.1571400511287635, -0.4484780736574948, 7.148465704694052, -5.687206074268216, -4.615895730893411, 6.408672585405931, 0.86732371703404, -0.3443661636609563, 2.299739828075315, 2.919026226132225, -0.7443308109782178, -7.224397325719416, 7.383563092857216, -7.355365277754791, -1.8811966467829782, 1.505111219383671, 7.21158406822246, 6.4153332013389885, 5.641091170891342, -0.3850153090180938, -1.5606039205431197, -2.8166720871993824, 0.6549815728220276, -2.321559380252975, -2.1304868358859794, 0.32022283150963704, -2.0540389727997432, -4.904136968963819, 6.493439849217987, -1.122020293623202, -1.4087509577090174, -3.9802391004715827, 2.7197002081051145, 1.8817574877935117, 0.7600584753976267, 6.108621352922265, 3.6779590661131882, 3.890303285929794, 0.4984277681059004, 5.373071633419405, -5.965356050207827, -3.0890939232361507, -5.6930189199565655, -6.554287187972511, 7.409488951030967, -6.842510281851068, 1.3186209102143622, -0.19134090448403127, -3.000945532232793, -0.0554034603925313, 4.252976820686825, -4.672509955511857, -7.389565644062591, 2.183566069985625, 1.7266208680009643, -5.362234029001299, 6.466832867088905, -1.6841047274753538, 1.9007841051061973, -0.8832732745787641, -4.236197813719339, 6.222408734123651, -3.5672317577801866, 5.843535017291407, -4.179949252795529, 3.058037316859954, -1.4941521611302142, -5.362498449184203, 4.3012651661415, -2.5467159475069767, 0.4971966092516813, -8.181735612038683, 6.981371110457162, 3.0315949784635303, -9.730800014065425, 1.8592389375108884, -6.667523547745141, -0.6808456506787923, 0.38798402110991426, 5.459489321889247, -4.1276206399711795, -1.252839953650866, 3.379266751759248, -1.0399515139578137, 3.83127060767728, -5.677864577729031, 2.9830275297474937, 3.3293001201909083, 1.8447971045203362, 2.552790884646811, -6.626017106979022, 10.044217136200647, 8.996161207705242, 0.7331201956420111, -3.8205389317273877, 6.2321126679252865, -0.9381974435162519, -0.8164948406482189, -5.990664582738157, -1.4308394753875597, 0.4459737156738435, 4.853561319174966, 2.30011137253343, -1.4270532807106477, -0.11781339335664034, 5.170149855395042, 0.18672162443181112, -1.7330680515655936, -7.227013251071885, 2.1083773776553767, -4.257240553903839, 0.9540694021252465, 3.815344328226061, -2.430477241686754, -2.042905138751223, -7.6128291596514375, -2.8937171329369438, 7.8113342822593275, 5.468516208343916, -3.2481128166569233, 4.450904585131747, 0.8877775093207019, 3.431300383998334, -2.975697407040733, 2.5885354552402156, -3.427463763418949, 5.839892423536864, 1.3193661657366713, -0.06825411115158975, 0.4212067046197807, 3.1945893018169365, -7.222202919891146, -0.4495305554244432, -3.572595344033792, -6.859644906661255, -0.46470229444298805, -3.6477971292291302, 2.885862651977526, 5.335175578509357, -1.69112159898056, -6.479871431625878, 5.421390371040205, 3.1204455877000603, -2.431222718767557, -5.7247500933482325, -4.372314589884723, -3.594487917408255, -1.6779563041166505, 7.27605416489029, -3.899528596898216, -7.571938530825212, 1.8434423305099972, 8.545527913817285, 8.594257198306263, -9.235684481167947, -6.895744839403576, 2.7584142362199597, 8.176815263784258, -2.6229733364318846, 2.4936997347636622, 7.700589406863409, 6.286080917486441, -1.503148428126801, 7.189276713650102, -4.042946292692951, -1.4379578033642284, 1.2806618607018365, -0.5942051847311622, 2.454308297615979, -5.625040883486088, -5.4072148387072065, -1.9453219703223663, 2.286958822168386, 7.393277148199936, 4.216253754552758, 0.5362499945598829, 3.74434126411765, -0.044679501011645695, -2.268175446875622, -5.050225250325727, -0.7483304955181422, -1.4763327204649037, 5.390863957888528, 1.5834871365057959, 3.208173393838204, 4.221900886854436, 3.5374311749129776, -3.1348201532689552, 2.1496632340770017, 6.648122108742405, 3.231312338427325, 0.5724957430771027, 2.2332672974176524, 0.3872318053515169, -3.589615563183497, -1.347784592594279, -3.6419130647892257, 1.0966752807551565, 1.6994891082890131, -0.23692506365528457, 1.7233655290435839, 2.738757930183528, -2.8418813251011734, -6.329242167487691, 3.3371270546689935, -5.891525599905102, 6.009353950217823, -0.298204475848179, 1.7691510602093201, -2.9552068099858992, 0.5167369619485036, 1.9246712822155034, 2.870775598387543, 2.740456097378244, 2.9212753025772944, 3.3648157221398023, 0.03903102144632414, -2.194627106582005, -2.3434078526457167, -2.651460621887458, -0.07150534439940043, 1.150214805400659, -1.1609896013892231, 0.805053998353739, 3.3604287733760256, 3.958214998369373, 2.1161837731321387, 1.2768216789236897, -4.175811409234104, 9.07797897360961, -3.5823607275636467, 5.023027061731696, 3.845888948644501, -0.5830603975558155, 4.755154638428196, 0.3280884965383679, 3.18462543060191, 1.0622108258687684, 3.295016600398381, -1.6855974107564016, -1.696676504468393, -6.159660481824883, -7.896804026966844, 1.394201369230658, -3.316474455734729, 1.2532625797515577, 1.4739016937351939, 0.7339160809513037, 6.753956839287395, 7.635032360103194, 2.889683271915449, -5.465350254015913, 1.22050923285335, 4.967778537561362, -4.047555765311693, 3.021141521984647, 2.6250568962700496, 5.413725767081152, -0.7620568006585045, -4.272087154437818, 6.283671388410393, 0.11692043794163137, 3.7981670997782038, -2.9488195622903346, -3.454071634633743, 0.3514801067476724, 0.8153840572308579, 3.112819687106406, -4.0525543987775485, 5.115623602011477, 5.263671475526596, -3.650022432024527, -7.474898801242463, 5.270350744015971, -1.7606787763516585, 6.982958865399116, 0.18510197018171692, 1.7857564897789486, -9.556715080385448, -4.230538628386968, -0.5919662567655462, -1.5782600388769241, -0.9929510599376004, -7.111928745752883, -0.9186050107444457, 7.925456529570306, 7.883105122981755, 0.8207409636463361, -1.4083868461129732, -1.9708046571298794, 5.717830609114647, -4.3953443548874525, -2.040823300686963, 4.809588478070754, 0.39672389043988354, -3.4497536760258565, 4.7948096846713995, 1.2203088320610043, -0.986765271902649, -1.0381883746564597, 2.0024840649545026, 3.107575398390516, 3.810808987148942, -3.0359213756569905, -0.5741334358250889, -2.922384126116688, 7.205258287908822, 3.0598978633727842, -2.3777489373693843, 5.383887936583249, -1.455032235524706, 0.18997220276429005, -1.7811334535901546, 2.019965568697214, 0.28581167622051895, 3.484851195070371, -6.820978602227322, -1.9301310201966442, -0.03062384585399036, -3.359985730274566, -2.184015820033465, 0.5370250309405473, 2.1819250189033688, 3.8661385789548888, 6.160466482453852, 2.4084831002991276, -4.836562210391644, -3.228868915121341, -7.63430226325874, -0.2247988424840049, -4.057676573720032, -1.499959081967312, -2.6897604484470787, 4.296790734364112, -4.010161356205185, -6.339640494992274, -3.1607676606885113, -4.145969908844138, -0.1197862422388481, 2.0308043494719907, -1.6554315348165818, 2.2971719724200454, 0.7108713416812651, 6.623157872345707, -0.878977379615111, 4.3338028882265585, -4.050983723653264, -0.20846359533768227, 1.6152876826827007, -7.928918482817185, -8.471065999829104, -8.449893112195408, 5.9366958602718904, 4.215572837122692, 2.1417937475411635, -0.3716187677507605, 0.8880452221132054, 0.029279815941239795, 1.0860488869572655, -2.7289274477843466, 3.910614614117672, 4.297087064791329, 3.1248742898788264, -5.106688651269259, 0.2095693743530549, -6.957641735845694, -0.7192516404364735, -0.8812056408859175, -2.8092500091182147, -8.560950705389862, -1.2372358951412745, -2.906758053601531, 1.9947222334149304, -5.179115344541902, -0.7923048030947748, 0.431110131704755, 1.2665814349606703, -7.572746365468124, 3.492645918524721, 3.557166049930255, 6.213648186807698, -6.157725662940764, 2.738721732331519, -2.395710564767427, -5.019666184750058, 1.0917494595981339, 3.795151008573984, -2.0199288127820862, 0.2797914813472495, 3.8504005794142158, -0.4136849328040653, -1.502356945012945, 3.6114721271800203, -4.807879055714934, 1.4131375295978026, -0.6996009274567988, 1.0607406520441174, -5.276695986795486, -2.677865543081183, 2.355473560716558, -0.5396850515896092, 1.2117742741400208, 9.042844056803213, -3.2468421708327737, -9.75945600868376, 0.6421363041166614, -1.5285428959404153, -1.2817039922444535, 5.5820930658575465, -4.584175300872752, -2.975503285480766, -1.4207417047819888, 2.0020237644784973, -3.9264193018764852, -3.1703773536506974]
BIASES_LIST = [3.7037668496545417, 1.9591505517315837, 7.143256746334267, 1.7583653370317331, 0.9453662012934672, -3.821044027894735, -6.561597345303915, 2.5890692001637303, 5.4706128725423, -1.3597331342994023, 5.912087937577182, -6.8416986610396675, -1.8183046427289122, -2.8613972553502114, -0.8785018992709115, -1.147483481417164, -3.308877345933932, -1.2843179042109312, 0.39488236029301516, -3.901864510438646, 5.7227775615017, 3.1957975475846463, -3.4761558040647755, 0.2916648371454118, 5.387620064378849, -7.75831759028013, -1.566051729524668, -5.868358987682625]
SHAPE = [27, 16, 10, 2]
>>>>>>> 7d31a6a87a720dfe4ed79aa94e6595884cb1bc5d

IN_TRAINING = True

## NEURAL NET FUNCTIONS ##
if IN_TRAINING:
    import numpy as np
    def sigmoid_list(x):
        return 1/(1+np.exp(-x))
    def dot(x, y):
        return np.dot(x,y)
    def vector_sum(x, y):
        return x+y
    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = dot(weight, v)
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v
else:
    def sigmoid(x):
        return 1/(1+math.exp(-x))
    def sigmoid_list(x):
        return [1/(1+math.exp(-v)) for v in x]

    def dot(x, y):
        return sum(a*b for a,b in zip(x,y))

    def vector_sum(x, y):
        return [a+b for a,b in zip(x,y)]

    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = [dot(v, w) for w in weight]
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v

def list_to_weights(lis, shape=[27, 16, 10, 2]):
    weights = []
    index = 0
    for i in range(len(shape) - 1):
        row = []
        dx = shape[i]
        for j in range(shape[i+1]):
            row.append(lis[index:index + dx])
            index += dx
        weights.append(row)
    return weights

def list_to_biases(lis, shape=[27, 16, 10, 2]):
    biases = []
    index = 0
    for i in shape[1:]:
        biases.append(lis[index: index + i])
        index += i
    return biases

weights = list_to_weights(WEIGHT_LIST, SHAPE)
biases = list_to_biases(BIASES_LIST, SHAPE)
if IN_TRAINING:
    weights = np.array(weights)
    biases = np.array(biases)

nn = NeuralNet(weights, biases)

def check_space_wrapper(r, c, board_size, team=Team.WHITE, opp_team=Team.BLACK):
    # check space, except doesn't hit you with game errors
    if r < 0 or c < 0 or c >= board_size or r >= board_size:
        return 0
    try:
        team_there = check_space(r, c)
        if team_there is team:
            return 1
        elif team_there is opp_team:
            return -1
        return 0
    except:
        return 0

def flatten(board):
    lis = []
    for row in board:
        lis += row
    return lis

def copy(board):
    return [row.copy() for row in board]

def pawn_turn():
    board_size = get_board_size()
    team = get_team()
    opp_team = Team.WHITE if team == Team.BLACK else team.BLACK
    row, col = get_location()
    
    if team == Team.WHITE and row == board_size - 1:
        return
    if team == Team.BLACK and row == 0:
        return
    
    board = [[check_space_wrapper(row+y, col+x, board_size, team, opp_team) for x in range(-2, 3)] for y in range(-2, 3)]

    if team == Team.WHITE:
        forward = 1
    else:
        forward = -1
        board = board[::-1]

    inputs = flatten(board) + [row/board_size, col/board_size]
    results = nn.compute(inputs)
    best_move = 0
    val = 0
    for i, v in enumerate(results):
        if v >= val:
            val = v
            best_move = i

    if best_move == 1:
        if board[3][2] == 0:
            move_forward()
        return
    if board[3][1] == -1:
        capture(row + forward, col - 1)
        return
    if board[3][3] == -1:
        capture(row + forward, col + 1)
        return
    return

def overlord_turn():
    board_size = get_board_size()
    team = get_team()
    board = get_board()
    board = [[0 if not x else 1 if x == team else -1 for x in row] for row in board]
    cols = [0 for i in range(board_size)]
    for row in board:
        for i,x in enumerate(row):
            cols[i] = cols[i] + x
            if i > 0:
                cols[i-1] = cols[i-1] + x/2
            if i < board_size - 1:
                cols[i+1] = cols[i+1] + x/2
    m = 10000
    index = [0]
    spawn_row = 0 if team == Team.WHITE else board_size - 1
    found = False
    for i in range(board_size):
        if not check_space(spawn_row, i):
            if cols[i] < m:
                found = True
                m = cols[i]
                index = [i]
            elif cols[i] == m:
                index.append(i)
    if found:
        spawn(spawn_row, random.choice(index))

def turn():
    """
    MUST be defined for robot to run
    This function will be called at the beginning of every turn and should contain the bulk of your robot commands
    """
    
    robottype = get_type()
    if robottype == RobotType.PAWN:
        pawn_turn()
    else:
        overlord_turn()
    bytecode = get_bytecode()

