import random
import math

<<<<<<< HEAD
WEIGHT_LIST = [0.5585131834090087, 4.908332673486685, -2.3170387698158232, -3.5504261779476805, -2.321789438357972, -5.296617167030068, 2.869785128121382, 1.830042126930077, 0.8076837621300617, -1.107334903821395, 2.6042207881101405, -0.013393587662079431, -0.9038942136496331, -0.7627901680856991, 0.2331953889436711, 4.931923544472909, 4.677493370701185, -2.9812882614394156, 2.837167097999272, 1.8240601776399534, -0.38275852571054525, 4.356166511295591, 4.932294496275423, 5.414585976608053, -2.116784299314041, 1.6123178990267997, -2.186678214676776, -4.354586921735908, -4.90654399092838, 1.3824781873721215, 1.3653890491530771, -1.1193333587369316, -3.397870168800372, 5.260894071264799, 0.9968196104182706, -2.5019231034201925, 4.1518049755714035, -3.283805570160704, -3.7536411144550534, -1.028376427199605, 3.8327460777062416, -1.8642400934789445, 0.43526792239484297, 0.16126012754842609, -3.2602035692221865, 5.729582217244062, -7.881672264303882, -1.0428207091157897, -4.622467938749945, 0.8812421384570531, -3.8447898438181927, 0.6742971278642947, -3.577128516717578, 1.8901195509672821, -2.2541030488293514, -1.5920814385812576, -0.41117890746697955, -1.9823660868182813, 4.890057848341181, 9.883269603258883, -2.197112351776083, -4.491315561597175, -4.318408541703593, -3.521830114096463, 0.7274521639699438, 0.2048017365378922, 5.362323593660784, -2.1966690896353946, 1.2333770170347653, -0.6869169030569112, 0.4482908828293257, -10.348836620473945, 0.48466924819233026, -3.693691885094491, 0.040219725002741374, -0.9687804973515923, 3.3913023955930597, -9.80073524651454, -0.0695623658513778, -0.5718277944497054, -2.4142979688162067, -1.1108905181682867, -3.2552301181346666, -1.2214444549585064, 1.0182980056578304, 4.806579082742492, -1.8356633548440824, 3.995167130811985, 1.364231437099813, -0.6918259325591369, 0.9957039477481968, 3.783522401154224, -1.2426622305733108, -1.065258188422501, -1.5819035185228458, 0.5392905512436459, -1.7464296606914853, -1.1366318497529022, -0.6258009889116726, -3.6916521041384183, 4.1145138896780304, -4.821788643904825, -2.3263848090870507, -3.612141629548623, 4.934070154339415, 0.741864719527709, 2.6998000445997246, 2.6875232771467212, 4.96288151376973, 1.8784400457033408, 4.386637024710865, 0.607146949815652, -0.5292504554922712, -4.315419828569875, 4.4617726656942835, -1.7076406029870241, 2.560927301435876, -2.7675984317399354, 4.558731593882063, 0.5723338877308769, 0.6266385885834541, -0.160242683506628, 3.5981015793948163, 2.6171331971612446, 7.012832981674095, 2.4388631923549284, -5.358428215769699, -5.62830418626569, 2.551232493389732, 0.06531630428315079, 3.6270981631899426, 3.8478847740319444, 6.506297061767741, -5.742616416517214, -5.191223563053269, -5.161518765223008, 5.246951272415167, 3.508537136970272, 3.572830346217949, 4.547942984028459, 2.0757908319065703, 3.4812198128816303, -5.2312705600329945, -1.0536415778843884, -3.6810408423155474, 2.520517306284483, -3.950222802193306, 2.480613037367232, 0.4681351910668201, -2.4773720775500605, -0.42657970547553037, -5.121672320350941, -2.4166855152646813, -0.0037479779367113456, -4.159195054742178, -8.683402465785825, -0.22054750536196652, -1.8165790360533862, 5.4639634589775055, 3.8042484363149534, -0.9445665991669403, 3.8400112058874813, -4.561671686452859, 4.482236559102479, -1.1238708450939128, 0.36577216823800296, 2.1060062324861772, -1.6868499414486162, 3.3680805598998096, -2.6071663868164547, -3.4535228634066883, -2.4258641170414883, 2.0625196654895115, -3.2817263457171735, 1.8361248652373883, 0.1965703859223239, 7.302769555871163, 0.13621356192974615, -1.2330645549747383, -5.376648001855906, -3.224323551611072, -1.8793735898451045, 2.146501738777141, 3.649619096281092, 5.114903080303832, 1.1321571133288288, -2.629516485107542, -6.110612031815416, -2.5148971295553157, -2.1304979941000886, 0.08627087650934959, -4.280665640968681, 4.5773984570909825, 3.253719558937158, 1.9146960825743977, -0.4319879075219919, 0.757130705942048, -0.5217700091026932, 1.7004155562619097, 1.7621379562178634, 0.12672229309152927, 0.7080882462521686, 3.030976641044043, 2.417568512045252, 2.250260795835977, -1.3515704477471475, 1.0372273355911195, 10.582192147267929, 0.5749789946217082, -1.1259113868972792, 0.6082874099654653, 0.7528101355745218, -2.9447576298746925, 1.3071399645517476, -0.6523643875582522, -1.761412299224248, -1.6066912460799443, 0.33871472376054507, 1.304081443197667, -0.7470055269267568, -3.9243210068178924, 4.079125347483081, -1.5764632835016754, -0.9533134243038831, 4.252180464160068, -3.5313724109169953, -5.02570311232515, -3.3236633232729242, 0.15811507873443165, 1.740158933256697, -5.333814015291914, -1.703146941125537, -4.688290091099083, -1.6484454176187195, 5.274993513009762, 2.4062498387107403, 4.275674306965168, -1.1728183312217129, -3.628346430248628, -5.934405027427307, -2.567903641405479, -2.5852254923744327, -3.5939449834303843, 4.862748387050838, -2.5978847394382125, 1.2076193907489121, 2.5970025468139672, 0.2198012935816947, -0.07711763254532743, 7.129704981808133, -1.5366663497743958, -2.117086394365138, -2.2953244981696934, -4.268093703013155, -4.855519638858733, 1.0200632751536005, -0.4191536581263627, -0.35514103361119653, -5.807969025722624, -2.5159892959801393, -2.7230492810243354, -4.576984953832753, -1.8338152307757172, -5.90300841301943, -3.067648364105739, 2.6914574760136776, -2.373333677075742, 0.5902667041961202, -3.7664441178909462, -0.5509407685121523, -1.6637550575433049, 0.16753538997088666, -2.890947595762674, -5.6184338287956725, 1.5237141664875633, 2.0323858550107907, 0.19986186707148623, 0.9936792881457929, -0.7745322012349686, 0.36090236544329446, 3.948313993986065, -1.0295246635195632, -3.897618639258778, 3.7558136807450504, 6.161622605959352, -0.08111312986095745, -3.38606910728456, -1.829506121894924, 2.638755807406602, 1.7024465809267901, -2.97825768158779, -2.689421226218022, 2.5440117071376878, -3.57417714318383, -2.259856576494188, 2.363309288683553, 8.832766263763745, 5.947569003634409, 1.7996349339123625, 2.0503391349679743, 4.5619052944401215, -1.882098535072885, -5.842541360404251, -1.7729675397592193, -2.3760958831124945, -6.867039372037792, -2.881317217782732, 2.2935312794693212, 5.064822457679987, -1.4258680393527348, 0.6709031803278922, -3.921054555033472, -3.5952154107986996, 3.263259314774467, 1.84203264969369, -1.7792744378047258, -5.646098805909814, -2.400880532227443, 1.2873675582690933, -5.5910020419575055, -5.312745238233124, 1.279610960252468, -6.805792555579908, 6.404021449606591, 3.4298193493974245, 4.5973624294715165, 1.9958250760191274, 0.2815000511317252, -1.2669714962009533, -5.564180026180714, 3.963370141923516, -0.33513289167917326, -7.424833659925673, -0.10293972457108473, -5.026756699743028, -0.512874546785477, -1.6752186950866965, -3.4580875564864675, 6.515104982336182, -6.785440927323548, -3.2361186124393835, 2.6647500145070406, 1.47659021759343, 4.186730900949763, -5.691760072537879, -4.633279290745479, 1.70933929168503, 4.804996150853655, -4.853981951331618, 4.650355232368051, 3.2555367257898635, -4.02567076696981, -3.404318422981401, 2.3127903213331775, 2.334084184603034, -3.3851063348415624, 0.03150013785481452, -0.010136030135942036, 2.8159125760253976, 3.2438197464466567, -2.246390891338577, -2.8250669787690987, 4.920353212193865, 6.053290962436028, 5.28075905930559, 0.11746302047082906, -5.845772999089703, 4.262779479113521, 2.6066658099690896, 0.8498766263012777, -3.2234536493385613, -4.706675189728772, -3.669106297607816, -0.8914601664202224, 0.3448857781690411, 2.0707863147559484, 3.9203622162402327, 0.6846229321019043, -5.649637125603935, -5.259549997196551, 0.4256458401818337, 3.424908886695515, -0.8725400716980555, 3.1711758946519026, 0.12622707061684219, -2.8743386422525585, -7.232523017680567, -7.8845388244340375, -4.598841352812256, 2.4598564756207506, 5.609797509305816, -1.701124199534398, 4.707082962491973, 0.5142125955994632, 1.4446571198791982, -1.2956908761641013, 0.3424717437712321, 1.1823475807125046, 2.266583548546415, -1.4990278983762864, 4.288010325193677, 5.551736057444446, 2.715413265632956, -3.452548977749605, -1.7140175747430797, 4.538646250490633, 0.7053250822127514, -2.1489753369924225, 3.8702276109544225, -5.553224185472315, -0.3041866749778875, 0.7843680917473981, 0.9057174142202312, -3.2711978435569073, 0.9670935934463643, -5.686107932144532, 4.126503597105139, -1.5834119352481384, -0.7144674895280745, -0.9945709188522867, -7.398618163693426, -1.8412307762924887, 0.755800202153075, 5.221743137633701, -4.345083142423862, -1.1536788015127284, 4.084737519222549, -2.7387477605902353, 0.9159201436100474, -1.9419644813068748, 4.391056417784568, 2.787888232273269, 2.995015976362441, -5.903706174432984, 4.938707619849985, 6.184273307935036, -0.7302941321766216, 0.8051695474822508, 1.5815477860061824, -4.762330139804953, -1.6124794195670489, 0.6569159337130206, 2.012768801392016, -1.8269552200425185, -0.3720453566160935, -4.325352537917275, 0.713961620856337, 7.984737903548086, 1.8043149576820656, 2.930810504053683, 2.414150078309117, 4.519985500437154, 4.94053068800351, -4.360826970869625, 4.692694924835033, 0.0023945896162128697, 3.632544488502103, 2.550782850537521, -0.3799721532225476, 2.5170140927873526, -0.41868316304379255, -5.911015964428186, 7.699501087279146, 3.684460965899384, -2.0454395855851213, 2.0727685009654917, 1.497885532549397, 3.191812862072248, 1.371309063768948, 3.0521714445408903, 5.187167609569416, 1.6576638500664338, -2.315886197731163, -0.10645561349151433, 2.495580649241821, 1.3427135744431533, 1.5820287605127679, 6.851263760308742, -4.281869498250159, -2.459160753619295, -1.1957262559928254, -5.076251011167579, 0.5679914290965886, -4.3454270902064325, 2.6928797616929065, 0.3968420915577036, -4.412090215546959, -0.8149499498038578, 0.4760505708595249, 6.261171257628995, -3.2817003683099606, -2.8829337920097036, -0.6972068351904788, -0.24141299652827164, -4.862574030226118, 1.3637737059951593, 2.6069116176185907, 1.8338681795479224, -0.366903444495111, 2.7293476813635706, -0.2858046684215017, 0.10799384843000104, 1.5416909411188344, -4.740038886784151, -1.6576658059080807, 3.605099206449705, 2.8667059999167757, 0.49346047521398245, 4.253506715377052, -3.0578114106935588, 1.8248568505899294, 1.051691094241069, -3.7745547616815642, -1.7930985854587667, -4.908235461457777, -0.9699990994897203, -3.9873259324806756, -1.0041768773684738, -5.973088171090601, 0.297650495914131, -0.0388431288485024, 7.010007437745079, -1.1826291467970682, 1.1094896299046253, -4.018153027030549, 6.960794827290424, -4.0777639792729214, -4.132274066618672, 2.0460027214506638, 5.101242425529599, -5.504872545759371, -6.408196950847881, 0.9161280689620814, 4.218292925841086, -0.9032834338584322, 8.07846414540433, 2.5234194141719755, -2.304925423295923, -3.336537159171568, -1.9914503956551133, 1.4643983367878939, 1.0679890828294543, 1.4335721590967438, 9.019680646356763, 3.802487702100461, 0.5636248979385158, -1.2661442148902058, 1.8088403697357245, 1.5034300496565023, -0.5521776166562944, -0.2857044024775181, 5.973246323647044, -0.12327405524121103, -2.79095035542804, 5.407383840837508, -7.761670609230425, 5.251996470567522, -3.887558897733178, 3.4032250936222717, -1.011307290786251, 7.8068100657907085, 1.891147295833247, -2.261405167175292, -2.1787256892671985, 0.03178035922207646, -0.12282356160083524, -2.4643107246122518, -4.410464883605691, 2.2092615886317066, 3.9634675864898643, 6.046984107779995, 4.874165872908204, 2.248376365376456, -2.1525669658143896, 0.02869999357629018, 1.8473296512318942, 3.712097937864191, 8.936087501069014, 0.39617809596431713, 0.22639405208271587, 9.604742070667868, -0.6148568657402006, 0.5360368391138374, -3.1860752722188193, -2.551160103713397, 5.772493086186153, -2.3508101699050292, -5.450299600307424, -0.23835484272939692, -7.360985526856732, 2.4239573345534056, 3.080062590381163, 6.107056675210474, 4.953710095055704, -0.9546879016855943, 3.8062696997778747, 2.916511450593879, 4.110536847713658, 6.782408101926133, 1.3860862884657588, 2.3078948829857935, -4.249334478097754, 2.014861698555585, -7.715878875682729, 2.1650160316057847, 1.2597273144348933, 1.2181609291906164, -5.141744465313916, -4.541355440889932, 2.3626116296037982, 3.0289067662221676, 4.272217501766973, -9.137823576959237, -2.421484040306864, 7.442782175715708, -1.3577587374085405, 1.4428535345226778, 5.827740745857211, -3.4698802527133377, 3.1622051311041397, -2.007722575355332, -9.98389245081445, -1.0512530180876316, 1.472315923718955, 2.902847536922982, -0.9090775066344079, -0.7024274269792968, -0.8136959377960227, 2.273863744881337, 2.488881329509782, 3.2251502828437175, 0.28234237421410013, -1.4164782246556322, -4.287077367063332, -3.224376002865262, -3.4191480152561606, -0.7150667602030595, 0.8628811927284661, 4.222115455306735, 1.9544556218976354, 3.181927224108158, 3.1120705653683793, -1.4447477271373914, 0.15472299645077386, 0.9601637925037301, -3.08243837687094, -1.6411827380559594, 3.479460202657722, -4.022765204103554, 3.360980754771084, 0.567739469615615, -3.686466319441895, 3.4467645259703237, 5.9222891623805625, -0.44406158000649465, 3.228963465123275, 0.37727062443259146, 1.8538547010542348, -0.9189975488607434, -0.19890638041487196, -5.263817487375234, -3.3550058399091762, -3.7085489594419707, 2.3394845333872807, -3.901466995921028, -1.5426474745281324, -1.1387088625547106, -2.05651665370137, -4.905947605751762, -3.861637288451371, 1.9828377198752036, 5.6776815002651615, -0.19892559968965653, -1.8238895776540682, -1.3575977958313932, -4.280336697281362, 2.3487643514330196, -1.552566667728003, 6.689607194472, -2.6806797664392943, -4.747039288232821, 7.886166351077466, -2.044533961127968, -3.2802496904501326, -5.166950128181244, 3.0002076900604226, 1.5198936725840144, -3.5530608027547537, -1.3618324668154558, -1.5910080150902512, -4.8106552297976215, 3.329426409874214, -1.3053906198044447, 4.380083263244943, 4.631670608200863, 4.29523231871858, -4.907105820158862, 3.6478520895836293, 0.23738822649656746, -3.404256608728675, -0.36054545330372656, -4.741235952295191, -3.545880499090946, -2.0717904235706768, 2.5240948880481198, -3.4101586381705524, -4.682596271677131, 1.431671249967436, -2.7548642682386464, 2.0182926188473242, 0.4707146250825016, 1.6721343020637196, 3.965715260973578, 2.937904259438812, 2.785523011835812, -5.862538821196403, 6.98529290883121, -1.3650991444921519, -3.4689084091102447, -2.846787584737346, 0.1503767875491119, 1.4922697064921506, 3.033578842672423, -3.5970547963213435, -1.0521353445510446, -2.7632958995677233, 0.5859488817267009, 2.185746647790158, 6.124196865840438, -2.756810958258004, 0.08756378052763125, 1.4737375434750237, -1.2516512162532663, 0.7366067001703003, -5.735654606473735, -0.8343521567030224, -2.384424834551774, 2.3508523066053986, 3.7749903661850697, 6.925469031711141, -0.8746456390377093, -2.23608058208509, -7.983763071633964, -4.328223074236865, 2.989043615316799, 4.218149514106159, -4.417104352281865, -1.7780978778466519, 0.9727375711783277, 7.594508861797065, 3.756323752838562, 4.875699483710277]
BIASES_LIST = [-1.3857412076541578, 3.7107764657499085, -3.612054717727392, 4.795018012415598, 6.337155539050993, 2.7705562751926625, 1.1010706251181765, -0.07733546792409707, -1.1039381510840085, 2.6504134562888413, 2.1241531572659627, -1.3649182676601885, 0.0035299166752827404, -2.6209547665343957, -5.507340589358269, 5.264073479855851, 4.819471297508022, 1.480977840489082, -6.5625029758426345, 0.02159281918428179, -5.071055512468609, -2.7973526908475037, -4.065020458981936, -6.098499791971304, 3.932080321168866, 2.646100301566115, -4.026886047909289, 2.9136969860818245, -1.0808440327424897, 2.305279726305245, -0.3406993102400239, -2.2962461392055595, 7.119895170151163, 1.8503464719466043, -1.683663464383163, 0.44912111812731]
SHAPE = [27, 16, 16, 4]
=======
WEIGHT_LIST = [-8.24836126189985, -2.6831311694476128, 7.310630119602165, -0.7876648664652224, 3.971018191393219, 2.2217775357971394, 0.006044662981316534, -7.116275957035886, -9.143734416172377, -1.4283619042731068, 0.07341399218649175, -1.7727077838293055, -0.06942090049812158, 2.2066493838531938, 0.7749021884955332, 4.1780981412799045, 5.412296329105239, -5.031192366225381, -1.2893128369613667, -0.1759385776092594, 3.9470616934986595, -1.2302992096458683, -3.433515087464511, 5.440483366660787, 1.8348977937303177, 4.552950806355881, 0.5917328279444551, 1.4798802668445596, 1.249736896767534, 4.229270959724105, 4.303328266392524, 5.346065764704175, 1.0001613550467185, 5.808277134931538, -1.922029900742552, -7.261809419814293, -4.076761570145919, -4.966116210606011, -3.8792119573823935, -1.7085303495334863, 1.9074497536837538, 4.275170320923833, 4.0460737908628355, -2.2462958991475226, -0.8657084006032092, 9.263411963714285, -0.18298576831806418, 1.2853539707768527, 3.0068425978753406, -0.24326380727721822, -0.6818309173347861, -6.171263148079859, 1.025890730408748, -4.931346060626503, 0.6419162470825523, -5.860782051076701, 7.981419410697533, 0.5014084649704817, 4.125705315382386, -0.8198078730422345, 4.585202822396976, 2.0563101170387696, -4.837890191517434, -3.500666360224386, 1.3132825455421744, 3.624552021470388, -1.4194578466580041, -1.7883462794704135, -1.2459893398192667, 5.898875997728364, -2.880041970676364, -2.650948913618318, -2.2849478629845064, 4.937075625800201, -1.8311161246200365, -2.5849546026253596, -1.1409963205195024, 0.01651972867107232, -5.12416161507577, 6.347962426297438, -2.928310707356801, 5.122212524196483, 6.354425455454751, 3.9771646560146254, -7.294866616111621, -2.277141757170717, -5.804302139517302, -1.633534110325352, -1.087942960460552, 7.693282724627428, 7.411119910169566, 3.3958278635837753, 1.006838718956454, -2.368485384004626, 2.5828708998133285, -1.7710661118372963, 2.6949478653200214, 1.3402994587845465, 6.040853052112292, 2.021112388601508, -1.4525502171312579, -6.654290046991296, 6.1427711078449505, 4.692435931842833, 4.468224989380146, 2.0211636429001927, 2.4571938607439505, 5.370111531275486, -5.144131550205403, 3.7440669278696843, -6.792834645990971, -3.120593663447015, 3.511861337048225, -2.9339484996363088, 5.5098109042192815, -2.7109797488339806, -10.216582249416629, -1.6230524648193594, -4.625461424106035, -2.5754223174828463, 3.2086574380581303, 0.7127858091825772, 7.181241350756833, 0.4425174459816989, 2.1997825429246323, -0.21344803730072695, -3.1523571352792894, -2.6223537811136, 1.0561520788518968, 1.9235921579295203, -5.228032447558846, -9.545353068763964, 1.708727499485978, 6.700142170143065, -4.468716682131817, -2.409670168742461, 3.5321286428548526, -1.5678748894417136, -3.4723859628755487, -0.2118852248347749, 2.0824201717056736, -2.9640080954979577, -6.977912569727392, 7.290350190569496, 7.5667035616482226, -1.4142840104382028, -2.2724453934785775, 8.112180676912073, -2.318901406350991, 2.4525985436573814, 1.526719695160787, -3.7685005279125843, -7.069234330800023, 1.0728394235451364, 0.9287413512155251, 0.3918060183095918, -4.131090382300937, -7.330545043393221, -5.799551134153012, -1.271108711464187, -5.2441088781912155, -4.405888076786671, -3.6012650472146244, -6.086703251571426, -5.066685343817652, 6.69776206089067, 2.4992126261549155, -0.5678349772677811, 0.23983474449100955, 1.1604288999347023, 3.3142971953974714, -0.3091178690171096, 1.794517397490464, -3.0165403689122825, -3.309807958330236, 2.133256505141118, 1.054959795646752, -6.582352432242052, -4.99086040339242, 2.1642652328526992, -8.63984625442449, 8.706803259659647, 3.4502368515361557, -5.674333454713438, -4.197720848531091, -0.7254250004899252, 5.466058155330241, -5.489175246869344, -4.831881355684919, 6.830971924002387, -5.207556790054048, -5.091137688470267, 4.8395686109624885, 2.297157725057897, -5.969908456522602, -5.593016955475546, 6.9074184652607205, 4.014873580083077, -0.08793949658057737, 7.218633465065046, -5.5236907930068035, -4.802295533376279, 6.298452695482473, 0.9653400743380642, -0.5807780696929838, 2.838131970458582, 3.266789162129553, -0.7037057250554476, -7.21329349442146, 7.19719986260659, -7.132327093475604, -1.9845934549238697, 1.8946018741944788, 7.111780603376782, 6.361354740320141, 5.795438720634738, -0.6142692750414893, -1.4297361168900122, -2.55866034585314, 0.7728118860660786, -2.4972118485136914, -2.5197267434309354, 0.7813481556774797, -1.9722763724037424, -4.4082400190243645, 6.494412534144912, -1.2867431881753548, -1.6524773953546819, -3.759393665543671, 2.832738475496439, 2.464044735088857, 0.7509568618486206, 6.096650774694437, 3.4243552436422418, 3.8033124692749616, 0.4840291915839802, 5.358824682448732, -6.002486395959538, -3.254410997289354, -5.187215082442421, -6.268540921428512, 7.260298394267455, -6.9711181016737145, 1.463118861618594, 0.4418801188277173, -3.137751682698653, 0.12852728270866093, 4.373126941681602, -4.126775174311721, -7.393557947816573, 1.826714002422337, 1.703439232689135, -4.89991057027689, 6.352224038481016, -1.6247285190732579, 2.1404541555676095, -0.8614077807228444, -4.257696668644493, 6.472117187249281, -3.9029575272825303, 5.787237386613815, -3.993957273343094, 2.773060221027506, -1.6657576220760482, -5.139236698091844, 4.635550054604455, -2.734563802644403, 0.6086846142382691, -8.318248313046228, 6.72244233609544, 3.6141954631923316, -9.757989027574, 1.8339209930129954, -6.465465307573858, -0.671319351729385, 0.26466892162011507, 5.68170505510699, -4.776834036449444, -1.100720345812845, 2.8818779843870796, -0.9276968076570413, 4.111383103072377, -5.55082466782085, 2.475027964449934, 3.118813756423067, 1.6058414938253043, 2.5833073412667837, -6.330209134434088, 10.399489361024873, 8.940791390813727, 0.9111656535646544, -3.86623419613705, 6.20047691460748, -0.7993014983634752, -0.7819985716530495, -6.306009460832818, -1.0211201365958553, 0.24275574993899457, 4.561424760679219, 2.4251711793118393, -1.5882511084582467, -0.3361690512784794, 5.033646691403598, 0.1221196402257202, -1.6789568021120527, -6.999570174229799, 1.7137361001115818, -4.003610689497147, 1.3456299845441813, 3.9167505750104428, -2.2467523785140826, -2.2124632133519677, -7.992682443223106, -3.4543247660732637, 7.558507699116509, 5.373718880562296, -3.2034522005384334, 4.23756440564574, 1.0109116200081254, 3.494867048196338, -3.0580808752707833, 2.7871274913302955, -3.092072129667202, 5.981883522447863, 1.3213837183254673, -0.2517687899068723, 0.7433548874160487, 3.3812825749488247, -7.824892814166935, -0.5241552897783808, -3.6464327419806737, -6.641375391680013, -0.7267021715421893, -3.7091599109407896, 2.4385383083793126, 5.070239395512047, -1.8692079150563214, -7.098337456263221, 5.454240010559839, 3.343409754902733, -2.3114795188197346, -5.519499590482452, -4.488797468877972, -3.5943123913650177, -1.7419097325178439, 7.142262188568547, -3.7314953252985403, -7.323428008246399, 1.856547829918393, 8.646129626797551, 9.017550271541896, -8.82603113360909, -6.791692209182336, 2.7594044163595033, 8.17725523193997, -2.8123581927635755, 2.246822443085827, 7.464538387928083, 6.342630872067872, -2.3966900902618806, 7.074835176580827, -4.106714285211482, -1.1001616285008293, 1.4938749477423001, -0.8668080018085951, 2.7315329458258386, -5.63493841551778, -5.876407757032095, -2.0710199719506073, 2.45178107492651, 7.7389316908878625, 4.17925497160659, 0.045170449891656916, 3.768921149743188, 0.0012035783062412375, -2.1691223292316493, -4.903284244625913, -1.1439417011684068, -1.6695070830497727, 4.933611255998221, 1.7868060061801039, 3.001414468014764, 4.212063418680213, 3.5473329032139174, -3.2732091981992792, 1.9922572167245645, 6.316731712881557, 3.0608187097373745, 0.7463214658877737, 1.907171945270329, 0.28769002711109964, -3.426535197596635, -1.3527520540285463, -3.8339498595825865, 1.4477874256913112, 1.4417414335010894, -0.12641083874428108, 1.7416704974017212, 3.105252714446286, -2.4470316688947187, -6.2839926028324244, 2.962856346305437, -5.537143894137149, 6.233149715716644, -0.3234042892110628, 1.7370920390404094, -3.38449126641984, 0.6027956240150871, 2.3106672545164, 2.8381406421659374, 2.8265241330841495, 3.1740214674880165, 3.4319275407620067, 0.02788839172454599, -2.3777716342788855, -2.673691160961926, -3.1503970173902345, -0.26723169154305926, 1.2755174847388286, -1.1314329270323322, 0.9797154841086306, 3.2840738381925307, 3.9819218603187703, 2.0880748947913177, 1.4719584719435774, -4.524938283627479, 9.236046587305962, -3.307692695636544, 4.895852173377348, 4.19962591487028, -0.49594246018373334, 4.860835941517448, 0.3006868226084915, 3.11346694128649, 0.5760168515148911, 3.1718145971995724, -1.5836724367355377, -1.4201404725875986, -6.0512999443308075, -7.786197066079989, 1.0954210759541936, -3.7631499564561057, 1.601693008243616, 1.5355273990201486, 0.9228598684416593, 6.97599025324362, 7.36536154501567, 2.8744981781545844, -5.793051662178678, 1.3004985446106492, 5.127495303548952, -3.6763282522801464, 3.0450440721723826, 1.967383420971574, 5.846741865851157, -0.3260572231221179, -4.341344991509157, 6.589688479934703, 0.07114052885748051, 3.504515218836516, -2.56065819353805, -3.6925424054918228, 1.0920004281662647, 0.7011126053900483, 3.223268526704579, -4.354455151047649, 5.296079942137328, 5.6811131865044775, -3.3782503551151057, -8.054054617717853, 5.320568801892094, -1.5042673587765116, 7.056002349665422, -0.09677545287161832, 1.3553174623986302, -9.191826129912652, -4.354401145939731, -0.7631904866851515, -1.6948706309099066, -0.7049771327838008, -7.080799861297874, -1.15251658309142, 7.825928760224126, 7.937669423252912, 0.37514588371532903, -1.0988505721640314, -1.5220762407676622, 5.458403243371084, -4.065968076075093, -2.2907012222194885, 4.49329804746854, 0.895990745215506, -3.2185576348165066, 5.2359051861476225, 1.5374648220095022, -1.14890759681881, -1.3715048854802023, 2.102813617621426, 3.2583991647804473, 3.7902040364419674, -3.2845062998726005, -0.8012275826103172, -2.6609875381748336, 7.149565481606469, 2.9073452605208807, -3.278072233474555, 5.492384275343068, -1.6045732126548042, -0.145098526724048, -1.31780559731264, 2.1557375793835956, 0.31917427888345423, 3.6929240738388502, -6.992556323435401, -1.6328094085229836, -0.022258106642866704, -3.915365383503271, -2.125209369937497, 0.5276516582377908, 2.3489090512818933, 3.7618230764508165, 6.0662667490885, 2.280834899978741, -4.606578881714083, -2.8277991617949123, -7.939931275214202, -0.28051686259263514, -3.971439182845661, -1.2571069244520252, -2.854131688699618, 3.8917800519539463, -3.529118025119016, -6.818555214052307, -3.002846916048308, -4.007014763513184, -0.29451574843620026, 1.908910251078892, -1.765665408666014, 2.561875023211151, 0.933389530644742, 6.757420750122242, -1.1496531219413872, 4.399895471276528, -3.7509358998246882, -0.024326799614874633, 1.704063145182964, -8.163951818954164, -8.37687987681184, -8.383138902327754, 6.072936372384993, 4.055098095970522, 2.2769383990288796, -0.4681055186584176, 1.347748690871006, -0.44626637981020467, 0.7454546929937349, -2.881211546278239, 3.7784520745744516, 3.9215107619865823, 3.0485310663053338, -5.179876810050049, 0.413804723313474, -6.619442323480855, -0.6190775236222466, -0.5205218541596393, -3.338171004030217, -8.154449242602283, -0.9285780676513862, -3.094183859284494, 2.067306617184582, -5.510099003263727, -0.8053662245330171, 0.5999511676762324, 1.9117335856144928, -7.027829942986895, 3.2460290837897254, 3.8466877870164553, 6.171827432515673, -6.1519693516540785, 2.3679345432896124, -1.8428801722315513, -4.812287642846551, 0.8231234439982373, 3.3569282700228373, -1.9353169628921496, -0.4009314998666116, 3.8694741949136646, -0.49791120975416087, -1.3721852727954258, 3.5450297243793054, -4.835850879529805, 1.3673389357596402, -0.9757074152012974, 0.9870697398869868, -4.909585492926331, -2.548960325485182, 1.6888640395303416, -0.49859011221437083, 1.160892316023865, 8.899522321705016, -3.8406265495598393, -10.260001507440546, 0.5386683736951545, -1.1728793626742817, -1.3376230752830023, 5.341287106372236, -4.496458628891607, -2.763257502204658, -1.7097702034411948, 2.009462239346194, -4.028988837860999, -2.96270957253417]
BIASES_LIST = [3.8720082210678544, 2.2648246496526663, 7.3100441047675115, 2.2360666000093254, 1.2868002285022386, -3.751879370007854, -6.620125733138325, 2.3434685245194586, 5.4212767874689, -1.1734559833814973, 6.130882792794108, -6.718675998307699, -1.6717834539901186, -2.299832460950729, -0.6707496714696106, -1.0512964759335501, -3.3349202437786065, -1.3554100254228454, 0.09814678845604474, -4.024958040857516, 5.9402326811278945, 3.2365558443391995, -3.8005598988693543, 0.4665098497901922, 5.444604886071084, -7.5842476410326904, -1.8053258087912183, -5.715663048653661]
SHAPE = [27, 16, 10, 2]
>>>>>>> 7d31a6a87a720dfe4ed79aa94e6595884cb1bc5d

IN_TRAINING = True

## NEURAL NET FUNCTIONS ##
if IN_TRAINING:
    import numpy as np
    def sigmoid_list(x):
        return 1/(1+np.exp(-x))
    def dot(x, y):
        return np.dot(x,y)
    def vector_sum(x, y):
        return x+y
    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = dot(weight, v)
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v
else:
    def sigmoid(x):
        return 1/(1+math.exp(-x))
    def sigmoid_list(x):
        return [1/(1+math.exp(-v)) for v in x]

    def dot(x, y):
        return sum(a*b for a,b in zip(x,y))

    def vector_sum(x, y):
        return [a+b for a,b in zip(x,y)]

    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = [dot(v, w) for w in weight]
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v

def list_to_weights(lis, shape=[27, 16, 10, 2]):
    weights = []
    index = 0
    for i in range(len(shape) - 1):
        row = []
        dx = shape[i]
        for j in range(shape[i+1]):
            row.append(lis[index:index + dx])
            index += dx
        weights.append(row)
    return weights

def list_to_biases(lis, shape=[27, 16, 10, 2]):
    biases = []
    index = 0
    for i in shape[1:]:
        biases.append(lis[index: index + i])
        index += i
    return biases

weights = list_to_weights(WEIGHT_LIST, SHAPE)
biases = list_to_biases(BIASES_LIST, SHAPE)
if IN_TRAINING:
    weights = np.array(weights)
    biases = np.array(biases)

nn = NeuralNet(weights, biases)

def check_space_wrapper(r, c, board_size, team=Team.WHITE, opp_team=Team.BLACK):
    # check space, except doesn't hit you with game errors
    if r < 0 or c < 0 or c >= board_size or r >= board_size:
        return 0
    try:
        team_there = check_space(r, c)
        if team_there is team:
            return 1
        elif team_there is opp_team:
            return -1
        return 0
    except:
        return 0

def flatten(board):
    lis = []
    for row in board:
        lis += row
    return lis

def copy(board):
    return [row.copy() for row in board]

def pawn_turn():
    board_size = get_board_size()
    team = get_team()
    opp_team = Team.WHITE if team == Team.BLACK else team.BLACK
    row, col = get_location()
    
    if team == Team.WHITE and row == board_size - 1:
        return
    if team == Team.BLACK and row == 0:
        return
    
    board = [[check_space_wrapper(row+y, col+x, board_size, team, opp_team) for x in range(-2, 3)] for y in range(-2, 3)]

    if team == Team.WHITE:
        forward = 1
    else:
        forward = -1
        board = board[::-1]

    inputs = flatten(board) + [row/board_size, col/board_size]
    results = nn.compute(inputs)
    best_move = 0
    val = 0
    for i, v in enumerate(results):
        if v >= val:
            val = v
            best_move = i

    if best_move == 1:
        if board[3][2] == 0:
            move_forward()
        return
    if board[3][1] == -1:
        capture(row + forward, col - 1)
        return
    if board[3][3] == -1:
        capture(row + forward, col + 1)
        return
    return

def overlord_turn():
    board_size = get_board_size()
    team = get_team()
    board = get_board()
    board = [[0 if not x else 1 if x == team else -1 for x in row] for row in board]
    cols = [0 for i in range(board_size)]
    for row in board:
        for i,x in enumerate(row):
            cols[i] = cols[i] + x
            if i > 0:
                cols[i-1] = cols[i-1] + x/2
            if i < board_size - 1:
                cols[i+1] = cols[i+1] + x/2
    m = 10000
    index = [0]
    spawn_row = 0 if team == Team.WHITE else board_size - 1
    found = False
    for i in range(board_size):
        if not check_space(spawn_row, i):
            if cols[i] < m:
                found = True
                m = cols[i]
                index = [i]
            elif cols[i] == m:
                index.append(i)
    if found:
        spawn(spawn_row, random.choice(index))

def turn():
    """
    MUST be defined for robot to run
    This function will be called at the beginning of every turn and should contain the bulk of your robot commands
    """
    
    robottype = get_type()
    if robottype == RobotType.PAWN:
        pawn_turn()
    else:
        overlord_turn()
    bytecode = get_bytecode()

