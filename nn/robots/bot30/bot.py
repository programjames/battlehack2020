import random
import math

<<<<<<< HEAD
WEIGHT_LIST = [9.509151919018425, -0.8803881578814199, 0.9408856232275404, 4.187091315804929, -9.65132610289255, -1.454612176003467, -9.720985375948693, -8.71342988738839, 4.882518057079338, 2.977283962655843, -9.89633591244651, -9.985578767391525, -5.1021931473105875, -1.826713365890999, -9.099187225846405, 4.2650461066598755, 8.698561806585744, 9.797821868136548, 2.2129207237114272, -3.3572716688978943, -9.545957098565179, -0.4012716422568037, 6.349548850978309, 4.395002395025287, 5.731975674092038, 5.559211168570922, 2.3524587098749628, -4.626265836939673, 0.08094395711439262, -9.346464082772608, 7.270878322607032, -4.911662486568586, -4.377900465817652, -3.4020448026970174, -8.639709277649853, 2.762400088913296, 4.428986262425681, 2.7749679319409672, -7.321591606543636, 2.3375810907849033, -9.840023926528382, -1.8958070632737538, -7.2064345385781925, 0.32371535814693786, -1.9970639595638051, 4.847352702876213, 1.0207989427443849, -3.210039726514589, -7.238516294432964, 4.308149089831971, 5.338875345403608, -9.92612915362068, 3.651719975449275, -3.1305094991519127, -9.458349830367133, -9.678010547130002, -5.535768163702444, -2.315907433982547, 0.8924942175051065, -0.47233866582357287, 2.1600189002757055, 0.5771332283482309, -8.802707490923034, -3.223026094811086, -7.217615636268009, 4.041583529338036, -7.173662550251006, -2.7685700539833613, -4.115019468836674, 1.1630501092401886, -4.816056218955033, 5.531358358292737, -2.9785535773061245, -9.78755343674063, -8.813271793384725, 8.78232494542798, -6.011562806979674, 3.1260906108525592, 7.86250568596741, 4.970088344653993, 8.995427353667719, -6.260229668762333, -7.431029532242439, -4.002539301630028, -0.9257422174235117, -3.7910664649979893, 1.3627192124153709, -1.679460674335873, 9.962041971449857, -3.490141555231494, 8.066207358321577, 4.157068736696743, -3.027661952383176, 0.9427359624707776, 8.21727814267754, 5.82499989334991, 2.368774950666433, 6.673234102966937, -4.927863088044675, 4.9535069935641936, -6.266983884215023, 5.097578873708786, -4.1868105674945095, -5.496159772289204, -6.652310661182545, -9.790174418603446, -0.6106082062447733, -1.0685040866289377, 3.5651669972639066, 1.267936052142817, 3.4808288922580815, -2.3691958991728734, -6.694699810018974, -5.692610773344089, -1.0388371611693152, 1.821879627274349, 4.056745161985342, 7.285677304577355, 5.46630019023717, -4.599852268115403, -3.1923910305189533, 6.737067484738532, -6.5759498512190095, 9.230176176455053, -0.8870548926625315, 2.0676041372027285, -4.338185515451956, -3.9283391386345468, 5.40038149150025, 0.13277847233190876, 2.308910217115283, -2.054843274366542, 8.069185669496665, -5.519314160797144, -7.773590847964265, -0.5233469984020562, 9.319824211352511, 3.547206062374869, -4.1709268219120705, 4.274697514114152, -4.55831624544942, 3.285292558375417, -5.252357298474899, 9.741757573942042, 3.577022465502113, -5.071835202043471, -5.16877286806541, -4.441839009153594, -3.00715804897356, 8.161021957691354, -3.189441863997276, -7.921574436690939, 7.390323512372753, 8.95829019907151, 1.7210052204189896, -3.2543859616774924, 6.800978272774888, 5.850789275403919, 2.1835805163065025, -9.956497590146949, -8.131114706771633, -3.1347606318874917, -0.8319129253307693, 3.2815122929254965, -6.788413751650917, 6.504407858138499, -5.254431956039065, 2.326895665772108, -6.10194391860897, 7.663813508283571, -9.818541495392868, -4.387308861519131, -8.538910483419468, -9.171854808228009, 4.911639508519194, 2.200414371982493, 5.563045934182965, -9.377442984932117, 8.956452357574111, -2.1335165152889353, 9.908907610266787, -9.00256877700237, -9.497375041196168, 0.40792567149346937, 8.604045692950098, 7.0124124598177, 7.48270777916661, -0.008780296740237503, -1.3092823212302527, 5.382715613970067, -0.620929636005922, 2.9755428247477553, 5.809463664626849, -7.974132790624521, 8.36038643943198, -9.85189620252841, 7.350268199261553, -4.004141439686069, 8.284962854642703, 2.614082485238697, 4.579268528294671, 6.042820590732983, -3.2078411165892877, 5.867201798970923, -6.499729840417794, -6.5957581934935945, 6.245919069993839, -2.4950903191836638, -3.631088979812038, -8.10453079239769, -2.847814986435653, -6.9977856495938155, -7.544170729388336, -5.618118271663368, -6.6763260992156725, -8.173382484830768, 7.046399817366499, 5.211537853914489, 0.03237141598548199, 7.778984805679514, 0.5298326571747225, 4.843849492093861, -3.3053909609459, 2.7176826458489227, -9.214477925955505, -6.730688961651619, 2.81162262497479, 0.31805745455133483, -9.261323699012449, 4.26893270063178, -2.588639435909732, 3.554888207175498, -6.845215442624342, 6.501737224751402, 0.9239143525401516, 2.4282786956938818, 3.221919808016189, 1.1283607694169628, 3.365321695107923, 6.123857247356582, -6.354284659636766, -9.157172856547904, -9.79196533791628, 5.867639146555746, -6.1945863812456565, 0.15173457125051648, -3.628730898962374, 9.396518776366946, -4.512543972251592, -3.6834737366243004, -9.726299226606265, -9.009724910842944, -7.14257743298745, -2.1064220053926785, 3.2446051673233143, -0.39096042414905163, 1.788328947642393, 4.778539282711737, 8.634199732182275, -6.6732193094531445, 4.668094324211465, 6.534321967873794, 2.829806348642993, 1.8265062749905283, -3.735869424289742, 7.784831830635884, 4.869886336874863, -2.1598346353564546, 3.898959796241126, -7.823167873598704, -7.936651051052815, -8.42594289624265, -2.055099784563428, -9.475295325250894, -7.229566612599911, -5.041546707498852, -6.867208114010824, 9.851471459215112, 1.524791721155692, 8.59577409995368, -4.452521321640075, -8.286704409842597, -6.168077541484487, -1.6699100225850838, -4.887729809462959, -9.428203364122226, 7.8529905744961965, -4.733647501712744, -3.964553830641866, -3.205684264721018, 8.469968632086648, -9.770530064440264, 6.487927424349412, -6.6310324349044425, -2.611140577120892, 2.6500218035203353, 8.219903622584294, 3.7689578111054107, -6.489126806690861, -2.402016950403338, -3.5892454153324334, -5.807679877631779, -8.185035379313677, -5.75185351597391, -5.0882093956774765, 4.695414357290744, 2.3667728997627293, -8.187094086227297, -1.5201988013287675, -3.6224794209060907, 8.346696148052423, -1.7523145215773628, -1.809974225430409, -9.371028890888475, 4.221735114826311, -9.447961453548249, 2.085596225749768, -3.4281313311942956, -0.826239546728134, -1.5878336350122204, 9.591242266311667, 7.342721157724377, -6.746705824169221, 3.641491456470975, -8.396230987539628, -1.1943626000389997, -7.525125843020284, 4.575153185551489, 6.73875256520034, -9.313736489533763, 8.597335466215426, -0.9814428109681224, -6.770247442979082, 0.859544167684378, -0.08175699384817747, -8.125429316234587, 0.11553542437660447, -5.444927725437283, 5.646501975959669, 7.04881713001053, -9.837292566700643, -5.236234766888009, 2.359560486816136, -2.049138047891619, 9.012818899265564, 0.23670417154520074, -0.758746928903193, 8.199482761420132, -6.297455004378474, -0.11440929336573369, 7.690137586752023, -5.540777295054744, -4.715470807362507, -7.265634983345151, -4.376365459674765, -9.43002816525307, 2.909343356742218, -4.715118958691333, 5.417457622690369, -6.8892311198714395, 2.348946310267424, -2.6949156253149553, 1.5313210944794768, 0.47030499172862505, 4.219546034779464, 3.8472445659145027, 6.696759975210696, -1.3055790973401198, 1.3296725192792724, -9.025424925326856, 4.173845112475332, 9.277812385564129, -7.043290205435899, 9.755024015175536, -5.422644443827367, -6.59249374637816, -0.09733009983344765, 7.2571595367142585, -9.7868833182505, -3.7670842351572276, 6.347035418055313, 4.888807643587867, 3.527669024282037, -0.9166314775029143, 4.3157680980894355, 2.3745810118695907, 8.278590331977917, -8.561605589267883, -5.696437585908988, 4.2685703033100975, -5.9902670212274, 1.182632572702131, 8.53587696280998, -2.9247658194098314, 5.152080686649867, 1.2373619104048288, 6.725694517229279, 0.5392667304291425, 0.24514676762706422, -3.0582069782938115, -3.5214504195927283, 5.8230021256180144, 8.09871702471159, 4.687026783230095, -3.8184867995942717, -8.814407651240446, 8.414824973581435, -2.892162345348533, 4.071342996402079, -6.953559427563731, 1.8738812383860264, -3.254580331201482, 7.40978383789167, 0.3635367138993395, 3.7868680525279963, -1.6692977253886117, -0.004991842201206964, 3.325751371991611, -4.6500141841487075, 2.1108698690300685, -0.5619760205550168, 9.495218423177832, 4.8104124355327045, 7.7062421212690815, 8.710282568371852, 7.600037544195796, 5.3720574320779875, -1.802803250844974, 2.4593231536141165, 8.302743723798717, 2.4605573836502774, 5.616525955998323, 1.9382211944230203, -1.7440075695568389, 4.401055372105846, -3.816657859752617, 7.9185016292348465, -9.537105698833033, -3.238244535559418, -0.930661514991634, 6.689191432935189, -9.341171852143404, 2.017738587484182, -9.346023308473372, -0.9323089824821693, -4.493557527341929, -9.178218768297345, 8.885377080406201, -2.30600678389846, 7.316153850447126, -5.122799678375014, -7.44168873014077, -5.158410032244049, 9.082294963271572, -8.276966820709738, 9.955999208851996, 0.1099377936281094, 6.038884679889168, 2.461100605469362, 9.213492944634986, -2.9657316690318547, 4.450053064003011, -0.9393157199252435, -2.133316826027465, -6.37806291540862, -6.235751074870657, 9.907695381053042, -9.690637627057313, -1.5042816441560056, -9.556024649566714, 8.084937600845436, 1.8760236822722547, -4.787647815482583, -1.6092173164489303, 0.8904105770213171, 8.098369500278885, 8.355251850487424, -1.690745613674716, 3.625907850716672, 0.050294632691157304, -6.33734040021777, -1.5655622031029424, -4.405870457726944, 9.608724631591926, 0.75935371086263, 0.7018767579159668, -2.235724493892959, 8.54312614773169, 2.4447543863035968, -9.723629277495323, 1.9594330679358123, -7.8151607245304255, 2.6461444943608132, 0.2956663837379008, 4.514672936503519, -8.258316628297933, 4.337126076580356, 3.4348217290224152, 9.536261843047704, 5.567469911134422, -6.590677994064896, -0.7907791299988087, -7.614059552399455, -7.6397133740458, 1.3038658143483577, -6.01460037117703, -0.9857236422324238, 7.982931580042653, 3.4160972996245516, 6.481092668322649, -7.300552385912827, -4.571902982010812, -1.7187114643580763, -5.551390441981545, 5.491242112724352, -8.798926827464753, 5.865359878245208, -2.8163683170890756, -6.092241009839721, -5.297571423891103, -7.109826304287486, -5.782460959856737, -1.6385096879695773, -1.8055968358919916, 0.7578916961873521, 7.974267888947757, -6.193137913743339, 7.396490774145196, 7.869829646298246, 7.757784427548728, -3.0376595747711344, 0.5587419701742284, -6.675313491347961, 2.0249163361674487, 4.233321905064663, 1.4924872699938732, -4.948322749658923, 5.597446328550626, -0.9102891793672754, -8.737271775296627, -2.5487275610114235, 4.862988901281149, -3.764940632001135, 2.137095110339505, -7.924327454435902, -7.736536930173859, -4.429823863011871, -1.0706402226347418, 2.551193801371239, -9.219353506096015, -1.3699705876155033, 0.28946189839461667, 8.048755519775025, -4.472329063428071, -5.4331199893124715, -3.0465494548896004, -6.901879821847572, -7.239367476897214, -8.874210744553046, 0.5144087880590913, 0.3929557818205982, -1.4756472085127985, -2.0036270510314846, -8.562254202192669, -8.07936041261462, 4.504796817496322, -4.827891622231444, 2.1028706871811487, -2.3263292743691917, -4.224336483586228, 5.263539250649549, 2.414289964382947, -6.636376367821293, 3.6933696450673796, 3.334457274626759, -7.9676512967655055, -7.52116748916732, -6.637934780381061, 2.9631968323654263, 9.49410596619434, -5.3033836005680035, 2.5501596548028704, 1.5921176067748313, 1.6472018159890354, 3.7454478801822653, -3.9999830085264376, -0.46475947726633393, 4.1909158861441735, 6.9552971524904095, -9.549627889774648, 1.8513291095740474, -0.4919668507294297, -7.761924070990977, -5.839192259571673, -6.977248595571098, 4.7261549515213055, 7.728351337996251, -7.995836344494098, 0.15121387315795154, 3.995226214551046, -4.305532424516736, 3.789286931310601, -6.860099763928382, -4.949493878847928, 4.006249767076021, 8.826454911121424, 9.575614491679048, -7.394632033528962, -8.451464197732827, -0.8725679743842498, 3.6313442883585427, 7.528172468550576, 4.311647521888279, -1.34018244649398, 1.6664834224679677, -4.64940843399061, -9.35669901531589, -7.232967199833869, 5.873025911844563, 2.14020967290198, 6.373214149551586, -3.814163163686393, 9.452606448980529, 9.460743447595195, 4.179472792281761, -6.398730113659086, -2.6256960349691845, -6.593474070048925, -1.6911982627262283, -4.462786423094538, 4.170615487280244, -4.514808743738423, 5.128084055077375, 0.7322996074879065, 0.9134107015226789, 1.1897026255380325, -6.544021699675547, 8.702446618753573, -4.811849468307883, -4.923979655087891, 2.4067094625415724, 5.637600298980123, -5.006338048943748, -6.256913520891263, -3.769177695174175, -2.412147802659992, -2.8049476833651843, 4.323072375791867, -3.3501325559747492, 2.057099866813502, -5.244210249821817, -7.33369212086817, 2.6292103709677956, -3.5499239882668494, 3.807036002724134, 0.1271577987274206, 7.759006175762192, 9.99552893279262, -5.697720594975824, -8.027962949128176, -4.989729848164915, 2.8019873038457206, -2.4943603746701353, 6.695740119184638, -2.84707951886306, -6.451103764102932, 3.341724837462049, -9.17203219191197, 8.867362373050426, -0.5495591532429813, -5.383917978845513, -1.7089998145066154, 1.722673594620744, 1.669123110680161, -4.9437293244923435, -0.39496503787902704, 0.26135758679465937, 0.3191731650205849, -6.833618895500435, 2.3187487279857333, -3.6839477599128774, 4.676471876677153, 0.5762571811585779, 2.4765273315549443, -0.5244156446867709, -6.786535211166981, 4.422520626601125, -4.823533226583338, -8.441379785885552, -8.583493415733205, 8.945106945737852, 7.816018653413142, -2.735309497016491, -1.7225595169211232, 6.626905346191897, -4.132385408430115, 1.3022361568857743, -8.518850286254096, 0.5086203999020888, -4.999227377132303, 5.571055159141977, -4.93760532718122, 6.764608867749896, -8.844671683059378, 5.802446289563164, -0.7028464505985106, -6.474776841962628, 8.066560746628252, 4.831489789127799, 3.8655631048191665, -6.765870630637005, 1.3921273299056818, 4.900132506279434, -1.2791646142499253, -0.5817050757242193, -1.268190468401265, -5.712267237653881, 3.3544672242112803, 8.77241447030704, 6.667077417445636, 9.930010757389041, -7.702758106234273, -9.09734180496146, -3.903317647669131, 8.012016317626578, 9.15294126035715, 3.9938322849295727, -3.9075274969009754, 2.796970331660191, 8.984612953307924, -6.019286903122496, 6.032367547402885, 2.2917385121288714, -4.965560057784595, -9.561702641954433, 9.408104206475283, 0.060266446636509485, -3.724237355716708, -8.517618912850724, 4.004315249000523, -4.358970888802853, 9.931338199030552, -1.7686463309260976, 5.297415429605053, 8.492340782769862, 3.844527860339685, 8.713380063424548, -2.261097946934947, -6.657532394563617, 1.9673004949394741, 5.755988917424615, -7.895084477546346]
BIASES_LIST = [-9.828436806138072, -1.9188283454108817, 6.939051199816781, 8.307198130546304, 7.828429524172375, -3.8719964475205293, 1.9350909146535837, -6.4194917728587, -5.868430074316651, 4.832995994199907, 4.095844803153959, -4.9803599329520125, 5.880353030885017, -2.309814315405956, 0.7840641523476393, 7.6408768056099845, -2.926457923621644, -3.688584937666331, -8.442966916517648, -1.3030824688603264, 9.749105594481719, -5.0306900085540125, -1.8817859805679724, 7.825538799146031, -7.024165713114698, -3.849750741245048, 1.3563083599174917, 0.8748548786334496, 0.6428838549487814, 9.21009867911631, -9.51425109402046, 7.399961815812514, -4.00207316910032, 8.658431423841325, 3.3375255695946358, -5.407038561154991]
SHAPE = [27, 16, 16, 4]
=======
WEIGHT_LIST = [-2.7960264178998457, 6.107247281865369, 7.282109118118665, 1.693635673555189, -3.430801529679295, -9.989499323243097, 3.49545890329429, 3.8616671121586066, 8.789582167922742, -2.5292158581401676, 3.343474797324511, -7.509626881956672, -1.1891364269292364, -4.319138631650226, -7.471414695911596, -9.720025234506595, -5.646300554898649, -0.6317042371053194, -5.557325018641501, -7.93565394779622, 7.54354279720441, 2.930377738301928, -5.707464789155892, 9.38078052377504, -9.765497256899451, 1.8812713787536914, 2.238542588624025, -9.279976470430567, -9.082268997211976, 6.069080748338756, -8.515453732016347, 2.7926910761491115, 3.045387631428614, -4.706953232813049, 6.559993125437007, 7.080617356516882, 2.949555441224369, -7.739735849674972, -4.413936548068589, -1.656782231834546, 0.358467132808169, -5.28435327912409, -3.2365461950491303, -5.054854487767835, -8.936330715957757, -0.639830288085177, -6.269954993148916, -4.941876193429047, 4.645267992337756, 7.770673590557639, -1.8074916482037615, 2.2086540290013623, -4.669240088538553, 1.9618915872946463, -8.071309881046895, 6.401680198133555, 3.5915360589045733, -1.3129806614579227, -2.155307953358127, -2.093005077943417, 7.279272961676281, -0.15020193731549547, -7.642052662245864, 0.7347241356135736, -7.041549559603137, 1.3467130148531847, -8.286698635688094, 4.0143559245243665, 4.407203316969765, -5.498702251333089, -2.85070761776449, 3.7529830021822708, 1.4004329710420684, -5.945194494332318, 4.6864982272373705, -0.4146344057589282, -2.8976447666056053, 6.162891619886302, -5.553452032550998, 7.331481607659406, 7.1337257583360625, 6.160492364555719, 6.1692189870514476, 9.63167003891872, -4.587877048271154, -7.24630096533696, 8.873913778533389, 6.375045312914974, 4.539143153421566, -8.774719811743779, -1.6264852452268936, 1.2693035761112288, 2.3526431692870258, 2.1082364571099177, 0.2180465978187911, -7.184447595975736, -2.8532240174657524, 7.949894922770742, -0.47984168195421617, -1.237940104949601, -6.592137031247612, -2.0283510557454836, 6.88287981542198, -7.152043601718687, 6.596657494227415, -1.1277273714672802, -8.94146327024214, 3.1870400158635235, -2.5265598633514497, 8.204663600509509, -1.394042187783736, 5.9521461571961005, -5.022850993581953, -0.15675412284192802, -6.579608031116944, -0.5010523674006606, -5.186305985072783, -1.5402219657859781, -5.46567293361888, 1.561093172322396, -2.683588309019445, 2.4634206092348077, -2.19255874978201, 7.154549694957627, 8.683176276515631, 1.6993351483225432, 0.9751858747044384, -7.942851831166802, -5.237897004951575, -3.7997417151241457, -7.70044462029273, 6.149137412385915, 1.3998116137316146, 5.018681704258924, -7.47824073421707, -4.41091679020452, 3.866080531805663, 5.482052449839474, -9.113972311448483, 2.3537611546936006, -1.4778116812189737, -5.884734501511046, 0.8772543020055714, -6.697368058680581, 2.7139982418475768, -7.150972186454818, 4.914125265729343, -6.589138227750341, -6.712984425160846, 7.719613627862845, 8.028887126512306, -8.702525561767104, -4.071555612272332, -3.0081758520428226, -6.199839998987809, -3.209977479116639, 1.037517265339222, -3.416243433271582, -1.9368428880617543, 0.5591400689367383, -3.928272176025313, 6.68311973091479, 0.9094771515858788, 9.289158850955246, 9.688689483866831, -6.819439865100303, 2.4111790653308756, -7.4729830742383445, 8.376891695663964, 4.549342809574025, -4.6471206886987115, 5.176580499592152, 3.187658772424486, 5.80463943764723, 4.282029209029723, 0.9564762026567291, -9.81912229990807, -6.551910490245043, -6.305370176528338, 0.588648747229918, -1.2884479117535292, -2.9385217578607765, 3.3695576822769606, -4.759312992362368, -7.535034383644064, -8.073079768153557, -2.366468701335968, -9.293985364358683, -6.71444507730135, -3.1223977944955905, 9.170566236337386, -6.967388690511478, -7.098981703860825, 5.442841570298869, -2.9102474398943183, -0.703631809679079, -9.483465570162918, -7.439204852336287, 0.5600608412298076, -9.629657085457923, -4.813762408538249, -2.7959492429101935, -2.444662718698442, 0.3530988003613711, -9.40248624334447, 5.540162121256847, 3.092566732158062, -6.856315519675311, -6.075470685112547, 3.0249063521210786, -2.4754929295663475, 4.301969057239159, -3.6029048428080834, -6.669448168145349, 5.770539569683704, -7.152608490526731, -3.2027456035226276, -1.519912738169607, -2.2940451646715543, -9.218186506690815, -0.9381953806856593, 1.4681704481462248, 8.009976910133343, -4.755068224956435, 1.42037357888608, -4.796573977516736, -9.469570686364605, 2.7655577649298575, -3.333498509972208, 8.351165580780478, 8.872572529594269, 9.790731317319828, 0.45992495203980965, 3.862389835985198, 0.6816235463118918, 7.493918782421993, 2.5521902815933046, 6.468858239671857, 4.077124689636772, 7.306421596823686, 7.072287532479024, 3.7094808549912788, 9.064438788071115, -3.530112273418906, 0.17579344060540336, 7.429351705744487, -3.27797483743697, 2.374480984563876, 8.106761865495734, -1.095955540789074, -9.423128880160153, 2.265705625768197, 2.039852412994561, -8.13265492699202, -5.0409852758489055, -2.3092471094505225, 6.460731348020396, -9.076131296512077, 3.15686559307553, 8.178980551948335, 9.301252303703677, 0.9894532219874144, 8.20359366180848, -9.06968447084541, -9.620854190049027, -7.119695106484267, 3.354770001571678, -8.61429482962826, 1.2751298884303957, -9.830496949761184, -8.89492554250367, 5.6435135750072725, -4.3098483618675925, 7.124199859260813, -4.774212001986524, 6.223056836134205, -3.477182276664097, -8.494168714537665, -7.237165447726035, 9.904985892805339, -8.988821533181879, 4.080783068216643, 3.222016317048098, -6.503288496458262, -2.0524719051918483, 9.710015323756313, -3.602830648965818, -0.8542873981804675, 5.569554373991066, -3.286442397909319, 6.654366812285865, 9.060391935809996, -1.3288261946242415, -0.014222329237572495, -8.34772945158262, 8.789855313677826, 1.62862686895968, 4.939562022330893, 4.44899573391014, -2.1649811807925197, 4.69475963845991, 2.595075434714671, 5.361524616940809, -1.086540591779226, -3.0487658363554537, 0.9018938730079498, -8.681363901121294, -5.908134076334878, 3.7582703478154222, -5.663102907371089, 2.3664333446647223, 8.995622537984175, 6.574459766905278, 6.209348248877198, 5.13256014334339, 9.362804454601125, -8.585260167460135, -5.167523988906773, 8.175400562169479, 2.8917088951905185, 3.9603939767064293, -6.063161462999112, -4.015598435579557, -6.116337454770733, 0.13959988017716185, 0.9976937976752236, -2.106800813825531, -4.466060863860126, 8.285635704221686, -5.4832995773256155, 0.7924933127339386, 3.296173907470571, -2.636663809080244, 6.052080965158776, -2.7866003520150446, 8.316868057551662, -5.236538293138344, 3.911114846292193, 3.2580984892697273, 4.281148575552237, -0.3796665495510627, -5.922632656208718, -1.1791257491569045, -6.479253662099389, -3.652778205809768, 6.333824746994885, -0.49953086011907644, -6.967348140445591, -7.99094138746179, 9.942702008208911, -7.1986156822149105, -8.997273306006194, -4.706872346457027, -8.88040334935843, -2.7774562872661352, 4.756482923147798, 8.205719967534122, 0.36043498575784483, -2.672056197632646, -0.07265036057983565, -9.010782187677517, 8.007748939204397, 6.576918620763731, 3.8401939157605938, -2.5620710658761014, 9.192498010984337, -6.131446659181332, -2.907245390182533, 9.475608864027002, -3.4862618713412097, 5.450043506697957, -6.44943184775983, 2.326067886595114, 9.721904848254002, -0.499379977867104, -2.613769410686178, -7.313542698839228, -0.4622677443160157, -5.805936352424881, 8.92760415817509, -7.7498342226303985, 7.799336885266975, 9.776081560413836, 6.9386947128749945, -5.684876684223415, 7.851574894767708, 4.404271236155031, 3.4234742284915995, 7.656362947601551, -6.08440777286908, 9.971583157457328, -8.146567495708858, 7.164628349026355, 9.365471625980714, 9.041613492671424, 2.7937516081079234, -9.092808895521785, 0.1980115371105473, -5.9219018133639185, 9.236772496348568, -8.646292628616434, -1.172911735798131, -5.869897701377402, 2.191947947737468, -8.766781499557952, 9.836537962410773, 7.002515666931455, 4.473710811934197, -6.168258544836176, -7.803515485731996, 5.153246323170395, -6.293604859039894, 6.475231460414452, 2.6113010641305117, 3.270799677979504, -0.5543942202904795, 2.0834673525488423, 2.2655656326404188, -8.749667001227039, -1.3534207858666214, 2.4754584311509156, 3.86274395748025, 0.5692525015670373, 0.5648578103632218, 3.095465900885266, 4.888673237720052, 7.11488946065165, -1.4248362439328144, -4.341906151846581, 5.298484785536592, -1.9976770395354482, -6.953393755490325, 8.256630422283294, 5.069097633765498, -4.045264517768549, -3.2638535944569913, -8.658199735080155, 3.4124735406200877, 6.617951424176642, -0.020107008148693595, 9.100415671514348, 4.850022093932328, -6.67531327060318, 2.2411904249634915, 8.430255741054197, 8.863637833743525, 1.7067552944076585, -7.482050346224181, -5.476402727206056, 6.859146634131029, 8.839541328044863, -4.337835009560001, -3.3423233844957494, -0.1918511698377312, 1.8983955959029704, 1.7463308408027363, -0.06928496300115938, 0.5323323964377362, 9.126644779821365, -3.2849638107391037, -2.692937437124689, -1.2518599124413363, -3.4470761553278795, 8.155679750571242, 8.483277662522429, -7.644905544584586, -2.4933674119400457, 0.7852838279098684, 7.59321156944193, -1.5158461363589808, 8.501214039871009, -7.887648536042513, 8.211821712640162, 3.141260591743343, 9.744893703488248, -8.28452968525928, 6.674468551780365, 9.437066401132903, 8.698083295248725, -9.68868636253313, -2.054653744913912, -3.494004537090185, -2.429744085651606, 6.67202869157504, 9.013929550287745, 6.845065661198262, -9.36421180844966, 8.82804936404768, -3.0936564528870143, 2.164499521911834, 2.7157179081470737, -4.052269838169211, -4.925370879289412, 0.3663283263686594, -9.536124834902004, 4.12685981400929, 1.237740278231378, -0.20780506860963222, 8.951701640936534, -6.52638362400856, 4.058600902695478, -8.218038157053535, 7.782241441244786, -9.86158934576348, -7.516213335781297, 7.178309581077791, -4.825187046782807, 4.120904870347317, -2.9553989661308666, -8.73850426249854, -7.760919351479507, 2.857209843303771, -5.4774230639598205, 8.813414577027128, 8.626181663727401, 9.837654037944038, 8.243447681982378, -4.878351203363418, 1.853436353600273, 8.686657182735637, -2.7473264141402627, 9.328043608632203, -1.817575112207157, 2.0111887872056506, 6.0548611344244065, -6.655728194958139, 6.9164944494272795, -7.699431292326202, 7.46137857955577, -0.18961597531911423, 5.397158295581487, 0.5223493289963788, 9.09922490079548, -3.081042564188225, 1.2914716456897892, -1.315639100041432, -3.3217443613404036, 5.977395368455095, -4.03425817874523, 0.3701721460059737, -0.8568934704680302, -5.087303343979701, -3.4287346618390817, 0.8903719403372286, 1.675289766930046, 8.590036103301316, 7.497548558464796, 4.616038592473453, 0.10106214279363002, -0.8222207435589652, -6.9234074619029995, -7.067411369961083, -5.261765796173989, 9.367158707417154, 2.176720209914656, -4.691545420345349, -8.85361427358055, 6.732890617120322, 1.3259313245795816, -0.3190825309570027, 9.744768304140162, -0.9565550336068256, -7.111529764103572, -7.139273370698211, -3.942276109159568, -9.563713190718833, 4.203358468666142, 8.31205530419076, 2.2721106792294155, -6.534729408153675, -2.240505947170819, 3.8714307289754757, -3.7713879016016705, -1.9227637061393672, 5.255915390538814, -4.859632563079897, -1.8760208190538101, -6.0529933560592575, -5.7382662789705075, 0.029754573709654508, -8.699752603740672, -5.787080101012627, 3.5817661465247213, 4.374333269027231, 6.240848992133628, 1.7081176931119018, 2.3590883651469756, 9.546954594745756, -7.636209898306925, 9.108458968462948, 0.8536679061683152, -0.13994090296500872, 3.0526256251104797, -0.8756784415069383, -1.0396738025121657, 3.552435731587396, 6.920239718162875, 8.530136477766352, -2.9255684928976766, -7.730593863954605, -3.531270218109233, 6.340278834238148, -1.3842286821377403, -5.7018796742596045, 0.1712162664331789, 4.879373283661465, 4.413014305672522, 8.228366471279518, -9.241459206595458, 7.894239598920301, 0.8068511364977304, -2.9343049469527083]
BIASES_LIST = [-8.344031735443595, 2.9516400864710928, -2.0371702006961794, -0.6350636162111165, -2.4832854680458354, -2.5032842375899333, 9.742584938005084, 5.69498469769303, -1.0875901979161426, 5.795339210535651, -5.592232414686189, -8.750582669527013, 5.985588108495294, -6.530659498044004, -4.111294058120645, 9.03963828697691, -3.0734128193897003, 2.0001599162100625, 7.254318546721649, 8.299516644657537, -4.874358966706247, -1.2359597033316732, -2.6550095227031223, -6.372820283463055, 9.663877550989785, -3.1090718278923957, 8.149706982662256, -9.011713117028926]
SHAPE = [27, 16, 10, 2]
>>>>>>> 7d31a6a87a720dfe4ed79aa94e6595884cb1bc5d

IN_TRAINING = True

## NEURAL NET FUNCTIONS ##
if IN_TRAINING:
    import numpy as np
    def sigmoid_list(x):
        return 1/(1+np.exp(-x))
    def dot(x, y):
        return np.dot(x,y)
    def vector_sum(x, y):
        return x+y
    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = dot(weight, v)
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v
else:
    def sigmoid(x):
        return 1/(1+math.exp(-x))
    def sigmoid_list(x):
        return [1/(1+math.exp(-v)) for v in x]

    def dot(x, y):
        return sum(a*b for a,b in zip(x,y))

    def vector_sum(x, y):
        return [a+b for a,b in zip(x,y)]

    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = [dot(v, w) for w in weight]
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v

def list_to_weights(lis, shape=[27, 16, 10, 2]):
    weights = []
    index = 0
    for i in range(len(shape) - 1):
        row = []
        dx = shape[i]
        for j in range(shape[i+1]):
            row.append(lis[index:index + dx])
            index += dx
        weights.append(row)
    return weights

def list_to_biases(lis, shape=[27, 16, 10, 2]):
    biases = []
    index = 0
    for i in shape[1:]:
        biases.append(lis[index: index + i])
        index += i
    return biases

weights = list_to_weights(WEIGHT_LIST, SHAPE)
biases = list_to_biases(BIASES_LIST, SHAPE)
if IN_TRAINING:
    weights = np.array(weights)
    biases = np.array(biases)

nn = NeuralNet(weights, biases)

def check_space_wrapper(r, c, board_size, team=Team.WHITE, opp_team=Team.BLACK):
    # check space, except doesn't hit you with game errors
    if r < 0 or c < 0 or c >= board_size or r >= board_size:
        return 0
    try:
        team_there = check_space(r, c)
        if team_there is team:
            return 1
        elif team_there is opp_team:
            return -1
        return 0
    except:
        return 0

def flatten(board):
    lis = []
    for row in board:
        lis += row
    return lis

def copy(board):
    return [row.copy() for row in board]

def pawn_turn():
    board_size = get_board_size()
    team = get_team()
    opp_team = Team.WHITE if team == Team.BLACK else team.BLACK
    row, col = get_location()
    
    if team == Team.WHITE and row == board_size - 1:
        return
    if team == Team.BLACK and row == 0:
        return
    
    board = [[check_space_wrapper(row+y, col+x, board_size, team, opp_team) for x in range(-2, 3)] for y in range(-2, 3)]

    if team == Team.WHITE:
        forward = 1
    else:
        forward = -1
        board = board[::-1]

    inputs = flatten(board) + [row/board_size, col/board_size]
    results = nn.compute(inputs)
    best_move = 0
    val = 0
    for i, v in enumerate(results):
        if v >= val:
            val = v
            best_move = i

    if best_move == 1:
        if board[3][2] == 0:
            move_forward()
        return
    if board[3][1] == -1:
        capture(row + forward, col - 1)
        return
    if board[3][3] == -1:
        capture(row + forward, col + 1)
        return
    return

def overlord_turn():
    board_size = get_board_size()
    team = get_team()
    board = get_board()
    board = [[0 if not x else 1 if x == team else -1 for x in row] for row in board]
    cols = [0 for i in range(board_size)]
    for row in board:
        for i,x in enumerate(row):
            cols[i] = cols[i] + x
            if i > 0:
                cols[i-1] = cols[i-1] + x/2
            if i < board_size - 1:
                cols[i+1] = cols[i+1] + x/2
    m = 10000
    index = [0]
    spawn_row = 0 if team == Team.WHITE else board_size - 1
    found = False
    for i in range(board_size):
        if not check_space(spawn_row, i):
            if cols[i] < m:
                found = True
                m = cols[i]
                index = [i]
            elif cols[i] == m:
                index.append(i)
    if found:
        spawn(spawn_row, random.choice(index))

def turn():
    """
    MUST be defined for robot to run
    This function will be called at the beginning of every turn and should contain the bulk of your robot commands
    """
    
    robottype = get_type()
    if robottype == RobotType.PAWN:
        pawn_turn()
    else:
        overlord_turn()
    bytecode = get_bytecode()

