import random
import math

<<<<<<< HEAD
WEIGHT_LIST = [0.5552563465897383, 4.90343181341726, -2.3195933004514906, -3.5445570059588705, -2.3217776374199968, -5.287660122650041, 2.871611641603295, 1.825985582534972, 0.8013053593732272, -1.1030675114263913, 2.6048049474961568, -0.012642289028018658, -0.9030327060356702, -0.7556627515887313, 0.2391482315137673, 4.93240706352681, 4.678907821855184, -2.9834475338065154, 2.8342586214892114, 1.825414749735411, -0.377994244345163, 4.35043623851168, 4.934247868227064, 5.412420873009871, -2.1129379112416458, 1.6095662298492688, -2.1866766456127418, -4.357990139057622, -4.908033441342065, 1.3785444670578824, 1.3614442878049167, -1.1173279345465545, -3.394793357027654, 5.259389037704193, 0.9934962527163422, -2.499673916929877, 4.150127136160164, -3.2842650387364904, -3.7458500942745996, -1.0329024941333238, 3.8318390360821537, -1.8623453799629792, 0.44048865195500636, 0.16358955001055156, -3.2615774709197924, 5.725090074507251, -7.880965834789534, -1.0375006298642306, -4.6135171048378485, 0.8787678802226505, -3.836642672319414, 0.6724032976951667, -3.5802828477910777, 1.888960327383898, -2.255515466798569, -1.5911782646933421, -0.41469800496550097, -1.9777202066337438, 4.890167932968793, 9.882537904942218, -2.195275411143964, -4.4925323378667, -4.3156736149277775, -3.5228461042540387, 0.72622283924458, 0.19924261206291047, 5.359910191182756, -2.193663170266677, 1.2324607255866251, -0.6893216712235997, 0.45120505912030956, -10.348204102156563, 0.48969267433377134, -3.6889800357420994, 0.045629262181142716, -0.965426548738368, 3.3942370306369845, -9.80234072512636, -0.07205406607057445, -0.567537954726347, -2.41418395068459, -1.107309050705243, -3.249844076011275, -1.2215097474627192, 1.016308484088834, 4.804821374831275, -1.8327286388723305, 3.9947699031823265, 1.3616665180583898, -0.6866649826457475, 1.0005278273276814, 3.780972544700781, -1.2454803235513807, -1.061217605449273, -1.580019199585271, 0.5347631206215367, -1.7484159254489635, -1.1332414037892449, -0.6263252079612798, -3.6899065424474755, 4.120205784475495, -4.828985689802749, -2.329239621611038, -3.6115132054174146, 4.935673342233405, 0.7500680070116331, 2.6953141204316484, 2.6880101202377515, 4.963365077169382, 1.8812735630346318, 4.383881784313146, 0.6052850791614355, -0.5353096949935197, -4.313452551806508, 4.457913978168301, -1.7107283354990555, 2.55765111391494, -2.772174921608909, 4.561816250597249, 0.5753317476579437, 0.6285769668027, -0.15858293692325082, 3.6004922400723016, 2.62025339326803, 7.012389447724829, 2.4374416461222306, -5.3573082427466705, -5.6354035045835085, 2.555929482790684, 0.05576628131912295, 3.62586604176479, 3.847483514830896, 6.496833901521004, -5.748514778748075, -5.194654584292324, -5.160482302592201, 5.247098931897873, 3.506073274845976, 3.5654848793185434, 4.549024918757171, 2.0709859151187704, 3.4844577287917153, -5.229162690917642, -1.0539605374750673, -3.6845596082561483, 2.5189908690615335, -3.948196405165419, 2.478491787057627, 0.4673087605877121, -2.477448176830881, -0.4264205104915267, -5.1210487687289294, -2.4225006260275648, -0.00590504460481312, -4.155167618151987, -8.68104038700831, -0.2160839055314889, -1.8161328772223453, 5.459089988941039, 3.7986574273106943, -0.9484483161105162, 3.8395904288104394, -4.556886677687515, 4.488046629069269, -1.1286138905925696, 0.36807154461609065, 2.104673832118925, -1.6873067344831478, 3.373547449038888, -2.6029623418777907, -3.4508194671619417, -2.423240331834589, 2.0618379006074465, -3.285708527649733, 1.8387793161541341, 0.19404615005969406, 7.303999646185152, 0.1367951867146557, -1.2372263259235783, -5.374798302049373, -3.224220578196765, -1.8823336189817992, 2.148812007401934, 3.655306660938783, 5.118861742849711, 1.1292683637459435, -2.6299884945492793, -6.111685054287558, -2.5120546495196403, -2.131958587852426, 0.09066467742298359, -4.282635051478073, 4.580321015731349, 3.2539746890989347, 1.9123170397907596, -0.43305247837848926, 0.7584398478459659, -0.521524453127236, 1.6990529347582275, 1.7660365985547588, 0.1283942544778335, 0.7042206339445304, 3.0333770797763004, 2.4166426587124863, 2.246276681977956, -1.349692641782432, 1.0355150592312579, 10.581234858435558, 0.5774055995914215, -1.1243913971226285, 0.6024273526761674, 0.7548829260683603, -2.937122928738197, 1.3024912910074284, -0.655554547747739, -1.7559163229976316, -1.6058818603800995, 0.3398523139331991, 1.2980226290678125, -0.7463467710655131, -3.9271782892122973, 4.079470998452047, -1.5695533316341297, -0.9517763289619265, 4.247733758545769, -3.5275256251956346, -5.027912265751969, -3.326999252145481, 0.16129422208007216, 1.7365315560162604, -5.340665931951838, -1.7059911682269637, -4.686984483022519, -1.6470639282489359, 5.2761792839184665, 2.402022180885073, 4.281148944831458, -1.1709927587515614, -3.6244696841279813, -5.933551758940212, -2.5669932542022487, -2.589282511205198, -3.59571810023101, 4.864808983348851, -2.604881020049079, 1.2125615938066405, 2.595060490127663, 0.22086884460676331, -0.08015643779266436, 7.1241648613141075, -1.5413164851046952, -2.1164381059409436, -2.295446808246536, -4.270954537902915, -4.851094324365832, 1.0211650557970278, -0.4228967402571615, -0.34905147527069974, -5.8067517342528605, -2.5115252331371303, -2.7315775929477066, -4.579767330733438, -1.826261161390328, -5.906803727585064, -3.0639144517865895, 2.6918048089953057, -2.3697542569621577, 0.594820327616203, -3.761948724950984, -0.5526801439596117, -1.6586739344403536, 0.16419857014921566, -2.9010783704754735, -5.621116956449444, 1.523766582888515, 2.0296009799530617, 0.2062508720491264, 0.9983407629619904, -0.7779731694879667, 0.3650393241665477, 3.9487527835840783, -1.029243030380146, -3.8944899823273187, 3.7503733340837604, 6.159941415486778, -0.07619020061942418, -3.3814644425978275, -1.8241052616589641, 2.6379310468420054, 1.7027683253087542, -2.9759557155137553, -2.6957832658874312, 2.548462987027124, -3.5736143469307784, -2.260583505640121, 2.355314508722025, 8.82990041715305, 5.943274269975164, 1.7992087649176924, 2.0457913955987808, 4.561549929996318, -1.8787311349502946, -5.845718589342271, -1.7712301918780071, -2.377422265068658, -6.869603315760177, -2.884457603108216, 2.296622209833007, 5.065601793140557, -1.4246102243976788, 0.6770441614470882, -3.920650440743922, -3.60109986124179, 3.2580857628479705, 1.8469793919380562, -1.7799535946469665, -5.645801556556922, -2.4022623869430766, 1.289508545917401, -5.594409779728976, -5.319878266111703, 1.2776985994253227, -6.803778034325755, 6.407228209743777, 3.433299618865391, 4.603705958187396, 1.9983284651752107, 0.27760528433822235, -1.269208250695654, -5.558254741609818, 3.963443967433925, -0.33532284374631005, -7.431014008255808, -0.09536141912757794, -5.032630076799139, -0.510354910360201, -1.6750350930147007, -3.452497582361248, 6.5130879746430645, -6.781593039404237, -3.2361129762817096, 2.6614728540309476, 1.4771350373470238, 4.181982307268758, -5.694688820333785, -4.635045112448878, 1.707339463642638, 4.798028376815008, -4.854448885542202, 4.647984112802742, 3.2538234951923, -4.022894322156574, -3.4004087337043387, 2.3135152932149925, 2.3304053528812565, -3.3912783721131516, 0.031676689862526364, -0.008535375342541503, 2.8129597526463037, 3.244470308271906, -2.243374891813016, -2.8281580457119984, 4.921840521802227, 6.048723183362772, 5.284807988301774, 0.11325232891864462, -5.839213112738209, 4.260581899777528, 2.607005903723315, 0.8503728238114315, -3.22667508409486, -4.712649417944712, -3.6677531675310737, -0.8940544679284681, 0.34006951731189916, 2.074984265433744, 3.920869424268785, 0.6826894584587799, -5.649257854196794, -5.260316959025734, 0.4240453962574401, 3.42423376517187, -0.8691020893022997, 3.170768818488699, 0.12267979647621115, -2.872063648079129, -7.234690897265211, -7.879285164181563, -4.59898286608484, 2.464895415607138, 5.6082325649856415, -1.7009131768873489, 4.70530778765715, 0.5099076572563466, 1.4409507488515618, -1.297876545633066, 0.34307161816958104, 1.1764569700575127, 2.2635374302974327, -1.498597368841214, 4.293606618580001, 5.551471352681845, 2.71115386717541, -3.454225950721982, -1.7097181542639948, 4.54279905552329, 0.7014139609020318, -2.1487422133534264, 3.8670209703457212, -5.551764920610315, -0.2995237727582549, 0.7873201824468948, 0.901210705056125, -3.2748473559965503, 0.9645610956077224, -5.6898231182605175, 4.129392679706908, -1.577772962135146, -0.7113106203884771, -0.9978123479242886, -7.395500703246151, -1.8334188835295213, 0.7517576951427254, 5.2248458631163155, -4.35216211475394, -1.1499936354338103, 4.089611337672337, -2.742834809854134, 0.9159473327179941, -1.9406941475557347, 4.3935273039516245, 2.7845061182550603, 2.9891916585856526, -5.909432741150841, 4.935339221609992, 6.186546789353798, -0.7350860861654498, 0.8081466246236271, 1.5841761668306993, -4.760142001349436, -1.6143859642949459, 0.656010820083332, 2.0184597771391823, -1.8305106518192642, -0.37682593193363184, -4.325772516697716, 0.711933945489717, 7.989120588190588, 1.8039707596565835, 2.9302353127173215, 2.4134940502816646, 4.523953851987925, 4.943223816065048, -4.361501281161119, 4.688519043539933, 0.001901349167731936, 3.6289988052027926, 2.553715177734053, -0.3773708620442624, 2.5177315299102876, -0.42301445616574895, -5.913920864333439, 7.693190544699909, 3.6807195504434826, -2.039349448872707, 2.06758940826206, 1.4950453205613599, 3.195344504581809, 1.3743928377817831, 3.0501707139773555, 5.181889566556973, 1.6573125261084365, -2.319559792010845, -0.10906049816899509, 2.498541727102656, 1.3498410538090444, 1.5777859618767662, 6.845657892880913, -4.275531611925342, -2.455110637229467, -1.194566333086118, -5.080644693858065, 0.5673191600401892, -4.342022452382132, 2.6965755980163797, 0.3999338783158273, -4.412018669987878, -0.812941143302781, 0.4792237726010169, 6.2665428759373, -3.2862954848807173, -2.8809664381452382, -0.6979087666890357, -0.2403742192058954, -4.864202483821114, 1.3656568720256046, 2.6064571362784683, 1.8393919093663182, -0.3706793188280051, 2.7273667043111707, -0.2898737211663028, 0.11087352405879616, 1.5465900699614044, -4.742574857382189, -1.6609243112370802, 3.6066038388940087, 2.866756137448164, 0.4920428129499721, 4.255057902824765, -3.0550885576834323, 1.8206297322544585, 1.0538528295139744, -3.7780088281971937, -1.7949088321895996, -4.913370124734251, -0.9755682259772153, -3.9872070892229443, -1.0059549151692881, -5.974629651260273, 0.2954373766386481, -0.04519486287143096, 7.00707788520285, -1.1827558045286233, 1.1077851524665923, -4.02098418553107, 6.96048647193782, -4.081432524521385, -4.130056081014578, 2.0471652803050464, 5.107550027675846, -5.502554700581706, -6.405059558740243, 0.9161349495597898, 4.223871369231204, -0.8999393029594743, 8.079507162008749, 2.523685229135037, -2.2999996285928677, -3.3300498963689478, -1.9880681082025915, 1.4646198639870323, 1.062886062590392, 1.438749730121715, 9.025657189981475, 3.803293205548908, 0.5694016132146761, -1.2689471149096636, 1.80910065908648, 1.5010465121148706, -0.5517608992382187, -0.28865009510809236, 5.977164157478591, -0.12506924539464614, -2.791430751386954, 5.4101755394181374, -7.766688847819005, 5.250567151967615, -3.88103664847454, 3.39895448556198, -1.009139847385709, 7.8052675153165065, 1.8964218403492932, -2.255837751500112, -2.1875312887525027, 0.02904512469377243, -0.11574923796606099, -2.461075726248647, -4.4207304529210845, 2.216500474923631, 3.959385463483786, 6.041431180505582, 4.874601200619471, 2.2476169087926787, -2.1533429508119997, 0.029686916596250303, 1.8500262669176781, 3.7026383790957915, 8.937936064892872, 0.3945577873020221, 0.22921571517109385, 9.609516307981375, -0.6105222060096829, 0.53573010212521, -3.1892593378826315, -2.555410075482917, 5.774540408628015, -2.352197853396089, -5.447777491267269, -0.23684568658152813, -7.364091431872863, 2.425095735743707, 3.0786418012503667, 6.111104020328696, 4.944775410415943, -0.9499783981887547, 3.806627934066962, 2.918484186320495, 4.107468827489608, 6.790736858340502, 1.3853922373741285, 2.303002494709557, -4.252477191233399, 2.013933295636522, -7.7158663153979, 2.159873705496756, 1.2664668559678778, 1.2182754528292083, -5.140241833193032, -4.542118792453892, 2.360126525547781, 3.036674323668946, 4.271394063570287, -9.137318343568529, -2.419121080535177, 7.444461311371337, -1.3560886509920058, 1.4423463900333087, 5.8290092354919505, -3.4731583985036063, 3.165335276637712, -2.0070642552903553, -9.991217402834083, -1.0501871036532697, 1.47376435193739, 2.901200548025127, -0.9072034735988491, -0.7008412554980572, -0.8067954673393011, 2.276401212778893, 2.4852961065178554, 3.2271226080424475, 0.28171385602645166, -1.4176901708191334, -4.2911694632385, -3.2279376419348593, -3.4221827448473965, -0.7067337155363733, 0.8595483502542318, 4.2241138407753525, 1.9516981875888284, 3.1780651693995003, 3.1080899068705476, -1.437071868596684, 0.16688078727720326, 0.9621780361454575, -3.0814240267423183, -1.6469597432704937, 3.474550073652224, -4.016511403368715, 3.36305096112137, 0.566058274670646, -3.691762787093735, 3.4475705367724117, 5.923986584917061, -0.4460388967604472, 3.2269342651277, 0.3772265061144927, 1.8509099847147878, -0.9160658940256606, -0.20122514419556015, -5.258689149276475, -3.35599686891032, -3.7151508317225543, 2.3414253539028955, -3.895270640944751, -1.5416948443917091, -1.133997644119111, -2.057260494590412, -4.905621037446614, -3.8691685668930536, 1.988574363117413, 5.6782342779322, -0.2071842808841124, -1.8284117894023755, -1.3587213148524586, -4.279298129954516, 2.3459695209247617, -1.5567080927105987, 6.690153948652612, -2.67310896365025, -4.74378976859322, 7.8852394462209725, -2.0447940046572697, -3.278979280251926, -5.161293980975835, 2.994210439981669, 1.517840421708349, -3.5556553717861297, -1.3621587536306936, -1.5927837699690868, -4.80921274305699, 3.3302160857987966, -1.3078288573723758, 4.379214249693308, 4.633041301019823, 4.290722354592674, -4.910053443166317, 3.6507233492044184, 0.2404961037213927, -3.3959975602093713, -0.36498008500494206, -4.744015117438944, -3.5419449436640584, -2.070701248265956, 2.5217655718464616, -3.4105632447945466, -4.679883925518828, 1.434116254718146, -2.755735686243185, 2.014110045934986, 0.4713590297611857, 1.6705378815781498, 3.9717595200453713, 2.93775119015685, 2.795236719205558, -5.86907459796889, 6.986261801842116, -1.3585811806216501, -3.46690772018134, -2.842913772128781, 0.15290794034077176, 1.4927250627553255, 3.0342583452877907, -3.5975687661219253, -1.0487255190510154, -2.764125217175078, 0.5864760808898083, 2.1882011489421953, 6.123741091763348, -2.7567955587277932, 0.0933824574186139, 1.4792306111277918, -1.2532898531691787, 0.7299035317750678, -5.734728708641769, -0.8391658775547465, -2.3812415304739343, 2.3550508943496133, 3.7753662126000793, 6.926700744333587, -0.8697835897959535, -2.2349703940331236, -7.985477305003767, -4.327537156627438, 2.992599139799923, 4.2169585474455, -4.418189813613118, -1.7747676076189483, 0.9783012288158257, 7.594493342586129, 3.7537502773015867, 4.879666529120703]
BIASES_LIST = [-1.3819735094014642, 3.7099313946405528, -3.6200819762262055, 4.794790990162171, 6.33659599463282, 2.7736359522018232, 1.1043688123373592, -0.08651104713034087, -1.1071462524632107, 2.653958567033648, 2.1213423039590635, -1.369675726164442, -0.0025470735146658112, -2.6241751235728383, -5.501566810872712, 5.266197148153673, 4.821608827908062, 1.4758324577140147, -6.567285037715885, 0.022063155054348287, -5.07860779968676, -2.799375952070372, -4.0604614544846855, -6.097684925039008, 3.921805528046141, 2.650763112838316, -4.027619222472057, 2.9219840063577194, -1.0791076124153136, 2.303162740974442, -0.3392771027002683, -2.2965985769289707, 7.11581513863048, 1.8553730180030106, -1.6826582047836334, 0.44285857692009944]
SHAPE = [27, 16, 16, 4]
=======
WEIGHT_LIST = [-8.177413431534275, -2.4969977917350867, 7.2742161766931845, -0.8192549481587017, 4.097286207497103, 2.068955935505716, 0.39247039130731615, -7.106022093991099, -8.99943377837274, -1.0532664900641775, 0.2544052853817312, -1.901945954759473, 0.1374073330927223, 1.9778843213386286, 1.5374452487256258, 4.233782992243207, 5.5514758878848545, -4.534931700607523, -0.8604868327116137, -0.44732004828641025, 4.227625802992441, -1.2525467762196816, -3.5736652562610844, 5.475483392444632, 1.4670218992019763, 4.695250945105598, 0.6372466690866092, 1.3326095173115768, 1.0896780053077304, 4.386817977889036, 4.237983134263662, 5.623744029686656, 0.6036397118271744, 5.87291858760533, -2.54299330308456, -7.0793161865629886, -4.375972916870191, -4.793896845468251, -3.6894454987694276, -1.3240430340067304, 1.952211236790819, 4.731669163525354, 4.2032349947057295, -1.963024298132633, -1.2650569659492148, 8.995995093031123, -0.5805362348869263, 1.5143253009925934, 3.1662393164687694, 0.17631389931983105, -0.9061886777213022, -6.2601982290197205, 0.589814566234484, -5.148802495708127, 0.5181745465230232, -5.644630460998953, 7.813548730707615, 0.5838626893780012, 3.9974388763032827, -0.6602184697958104, 4.991417513369086, 2.178981684715137, -5.158070247290228, -3.515725984307049, 1.2024702560148395, 3.860397008282255, -0.9698946262164687, -1.9376099024771445, -1.2187298434311413, 5.942749349306723, -3.3102039998651684, -2.512864382800662, -2.841844326886226, 4.481454375140358, -1.7689258943765542, -2.49677306728622, -1.1670145693194196, -0.17058190200158713, -4.898319913562908, 5.943994032674652, -2.985434799592596, 4.533329042267138, 5.916139839483423, 4.006168440413706, -7.334067356018687, -2.337863206609839, -5.62410491863, -1.4326800928443837, -0.3481357528198455, 7.771958529759183, 7.638348904859973, 3.404032106998823, 0.5941558510604317, -2.218936990204162, 2.922416402913736, -2.0870606552022197, 2.6910845854303336, 1.554721883942051, 6.129211898925396, 2.3984765544266833, -1.3558760997251431, -6.859056785908402, 6.284821307642605, 4.87522983858476, 4.986921985114824, 2.174078084977877, 2.512548616333635, 5.169980200459144, -5.250645463573209, 4.1018973899831765, -7.174590649060371, -2.6467157761971016, 3.114076222689611, -2.824158465408749, 5.60383616281882, -2.171200277312652, -10.2798733751522, -1.8865163084307748, -4.839276419700438, -2.859380431270962, 3.528642061716809, 0.6273976552392388, 7.538393027214175, 0.987910226725266, 2.000654416975752, -0.2832191747795693, -2.4800557742207867, -2.821284797347513, 0.7388673517228042, 1.8505867209475335, -5.009149338290498, -9.431239902125254, 1.6044267774189718, 6.385511352020328, -4.843378190805861, -1.830975280805021, 3.4224577856996197, -1.6678177109623378, -3.449379958898753, -0.5688208724065502, 2.080475821070704, -2.587655724538876, -6.914202908248661, 7.427255684068002, 7.556944492947076, -1.0277837842993554, -2.377543690771102, 7.847064544855113, -2.4598973905808643, 2.4818633331050832, 1.9339373962861357, -4.21626603115352, -7.02281776698612, 0.9532375085556315, 1.4965550750885352, 0.6162575718564878, -3.7123575688884145, -7.47646503789252, -5.819618717606296, -1.2992181804483043, -5.491450904586707, -4.352010994838945, -2.8457759987445255, -6.409954894579546, -4.723792387746166, 6.975633385338174, 2.5976254766056956, -0.386792637573143, 0.3979764826927436, 0.8697656387508066, 3.286841003715023, -0.13739954103826776, 1.712229175210369, -3.4336402956442877, -4.303493010858401, 1.477289510937905, 1.0089977981176426, -6.708293402754685, -5.0859795493133175, 1.3779333826926843, -7.9868743814309475, 9.065868687874232, 4.040387843890446, -5.886727146928451, -4.0645113799569135, -0.6506339672974466, 6.062788941565791, -5.636516822907559, -4.852653641803625, 7.005650425320739, -5.0773727217641484, -4.674552991851645, 4.748584923709501, 2.0398913975277218, -5.525194770083249, -5.757405396601163, 6.77753996898808, 4.0633234402915575, -0.5781616335032039, 7.041939742747896, -5.52771109544633, -4.5725568854957706, 6.5561284643094915, 0.9583660918395378, -0.5288106075892479, 2.5771898132602984, 2.7085923359994246, -1.0633577860513368, -7.286643687830307, 6.927076014571013, -7.357425539960105, -1.994028198242032, 1.397618709982838, 6.945141082673316, 6.252497909027288, 5.8583998497248135, -0.5649998399545495, -1.581308475842616, -3.012593686910204, 0.5551484977268426, -2.2602816362312965, -2.377274512294021, 0.10024887618876072, -2.107795130902989, -4.957801138682057, 6.7461922722483765, -1.592064739160018, -1.5108772577800367, -3.6747543559996423, 2.946336054416493, 2.0201783456304567, 0.6352368604205503, 6.273008355415274, 3.6208059320728356, 3.89155679178647, 0.6011447415085556, 5.200183370501489, -6.6370063393173915, -3.1388768944064696, -5.577768686040162, -6.612921302854203, 7.386232669364395, -7.163314355855189, 1.3931821363523882, 0.16977124018160344, -2.9115812076832577, 0.06776716274857902, 4.368446639398374, -4.8958918696686595, -7.146025785263762, 2.0722610631961613, 1.4805901832766062, -5.267580309610885, 6.131643067471808, -1.5505381468265846, 1.9662054624580603, -0.8408087815128256, -4.156419588553708, 6.3455288867961865, -3.536905973570875, 5.977275334223312, -3.9908423556498507, 3.1095601042865093, -1.472331538438097, -5.061661462951752, 4.500831638265644, -2.597960417226132, 0.5704783931491155, -8.331887080212468, 7.237547038456116, 3.1050170327243, -10.099850020900236, 1.670713988832144, -6.865033232986773, -0.7272124077525013, 0.6119757321981623, 5.776057693158333, -4.2434204131556825, -1.0039312870225212, 3.236067443109413, -0.9741372547091847, 4.020556846174876, -5.845426272921462, 2.760563472441664, 3.1928738296627928, 1.950165862889507, 2.6437927322430137, -6.700201750230149, 9.923592880592837, 8.720648214375531, 0.9117745473643635, -3.619317350191773, 6.036075755003669, -1.4253069270585617, -0.4303041152310422, -5.9657863906351265, -1.214289267914763, 0.15893600651290357, 4.823620705653753, 2.2130338041868955, -1.3312343716648591, 0.08463383367577298, 5.281769450735491, 0.30593054051706686, -1.4616375781871884, -7.139991220400436, 2.232313867042945, -4.3077609560035475, 0.8009998411067134, 4.171094961646193, -2.1233528473383707, -2.280015467863587, -7.661421273350146, -2.885748669593134, 8.087451567135016, 5.216849520366472, -3.2695019913664347, 4.263351658422876, 1.0458441686516584, 3.429762230153985, -3.1727119787072366, 2.745250608384906, -3.483533119456198, 5.734625579818247, 1.2925697826829867, -0.2848252778803154, 0.43470584707716337, 2.9359390119865822, -7.384683194306198, -0.4002682668361873, -3.6489626133097777, -6.612621214208584, -0.4116111072853433, -4.181873957952078, 2.6514331846034183, 5.08632405823546, -1.8966014755515754, -6.319894786622635, 5.3187208954477905, 2.849428369942575, -2.104708620569127, -5.846570089861097, -4.266226411545762, -3.0957840152096114, -1.9506253226023873, 6.727506446067168, -3.935227800561969, -7.783297559929003, 1.9417576701080437, 8.885847658722197, 8.622540840214722, -8.983149267520993, -6.938801231178238, 2.6294023432104883, 8.06480252653993, -2.5114046101962963, 2.412421946568167, 7.833952626652709, 6.537967486865342, -1.838124621668333, 7.637369319705169, -4.210220204894721, -1.6458384910187516, 1.775032611635135, -0.9250350366449467, 2.442793823985239, -5.325738203565734, -5.698772565339623, -2.3458445954911036, 2.549767553428993, 7.278748923595499, 4.655852567100927, 0.36135473965134496, 3.9020940557712147, 0.03621739686993236, -2.3717316360012424, -5.2155394807479, -1.0683980154603723, -1.7593752273624839, 5.20542897956111, 1.3092172128428163, 2.9840034080126774, 3.9219997223672896, 3.53550235044386, -3.0004935199262546, 2.087462211882388, 6.32124485847002, 3.2291598381602737, 0.7036010783094784, 2.1587344199348792, 0.3479494766308843, -3.59387720975265, -1.307136995875336, -3.8185399549845087, 0.9442656755441292, 1.5285861772255456, -0.08880888679342414, 1.7888414635589327, 2.721363616994344, -3.1204267685976106, -6.391964397492547, 3.4246087267831156, -5.568270234953131, 5.879633899652303, -0.17414308983630095, 1.59476079670043, -2.9015766852211926, 0.7189703729443087, 2.45488970925205, 2.3442890841075936, 2.8108715079447752, 2.7752835573807815, 3.4706442570016107, 0.0558331783728091, -2.304607656124562, -2.0291699882220144, -2.7191666861390966, -0.03713927352873339, 1.145227578018643, -1.0768551231920471, 0.638501272474969, 3.283455367246633, 4.2519899238296475, 2.694335904166696, 1.3358764783302093, -4.110612711118645, 9.185230716172434, -3.802773961981234, 4.850305939413272, 3.9945466286404048, -0.198900928138455, 4.554075956488487, 0.1735421861916232, 3.0552874837630086, 1.2042159664386742, 3.374418786545703, -1.716240838925173, -1.8362517063840214, -6.275483676000416, -8.165942584454058, 1.4305567164899728, -3.557130019204686, 1.2205663862761584, 1.4996638926882817, 0.7055734081027958, 6.6960435879911575, 7.134696209032268, 2.9976088436232198, -5.3920137392974405, 1.4008145938283438, 5.1223926010332965, -3.7692451592100067, 3.1435501313392478, 2.544845805583378, 5.199201268963653, -0.7801635539592475, -4.1545558777325775, 6.654828372447728, 0.028827612216517307, 3.8403893940131044, -3.4181549895693832, -3.5173766579517487, 0.1782805168169978, 0.6341017615311111, 3.353193944030506, -4.234228255544968, 5.205038736201423, 5.3831953411182125, -3.513455641448744, -7.859967294346242, 5.544714770038791, -1.399538528268522, 7.564670963750129, 0.015691333881656444, 1.5232413612799185, -9.668195861977177, -4.054263054716392, -0.804602677312571, -1.9810530023041595, -0.9784671095680375, -7.075508664514224, -1.0277498051296734, 7.679164762305851, 7.668448724039613, 0.6556747902887987, -1.2902390954942222, -2.0531574677678335, 5.381853615181484, -4.4384994094755035, -2.057262405672668, 4.748991069768952, 0.6443321503372772, -3.4585211755302505, 4.734319270853191, 1.773377905251846, -1.3109551710988692, -1.368111869220258, 2.08674272773224, 3.0487450134433174, 3.524443686473752, -2.9244700261921617, -0.7134795442280901, -2.4861425822737666, 7.528510910547933, 3.1947645022565987, -2.6953219431005073, 5.211856186310253, -1.1503239918037398, 0.00636863102746088, -1.8876349489869018, 2.3786142743166456, 0.5492684719575922, 3.5814718685913944, -6.605831281086908, -1.5707573469920373, 0.12437904005538253, -3.315720268775007, -1.9844497755062451, 0.6182736985173116, 2.388888910700762, 3.7340871935854696, 5.8243019749395035, 2.4476761120919543, -4.668557480646961, -2.922939136885087, -8.05914731575992, -0.22215385003213356, -4.289700617935188, -1.3240072951443742, -2.8847810658332715, 4.1574209667979956, -4.147168638937959, -6.441372600288281, -3.0380316080312246, -4.086092157848511, -0.05863594966670693, 1.5032662521374989, -1.927147582888184, 2.1092468216219684, 1.0469004889555311, 6.806765587167937, -1.119533530874198, 4.640861404700167, -3.7975887072301875, -0.015550638836455022, 1.7606397649269765, -8.088322251252405, -8.3780569886524, -8.125415951867621, 6.273244988353193, 3.9985079368601597, 1.932987510864585, -0.4332937796359455, 0.9403662907979191, -0.07233155904919147, 1.2457774622391664, -2.8468604902847514, 3.8542433857152942, 3.890023964098097, 3.4285430070247136, -4.739485959044804, 0.4111885693287692, -7.053001177481096, -0.5781325084683189, -0.8747588393187244, -3.20525696817566, -8.401123865888655, -1.2609036624078611, -3.3503402964712192, 1.8973409115249114, -5.398073483521, -0.7084418948196047, 0.7919022020365167, 1.4582003748534496, -7.153736425859528, 3.5760257898799654, 3.58899054755013, 6.644223636359826, -5.796432316896959, 2.229628263237245, -2.2253931447491406, -5.216741105042854, 1.1711039457148997, 3.7376386806139292, -1.9326976075720537, -0.2948634905309921, 3.7910407647292232, -0.5927809786921943, -1.7254154364515402, 3.6337089595907286, -4.965719065157208, 1.3263589569187602, -0.8496728487513643, 1.1388661961630206, -5.4285834540185265, -2.9188343385361324, 2.297623132425849, -0.35081721645195424, 1.267100010619192, 9.278293890402066, -3.550419655512741, -9.90050120357925, 0.5204623502286951, -1.2668177240134264, -1.244087505580801, 5.863351509614873, -4.48364416497301, -3.3518972753434517, -1.1427397448925969, 2.0383096379185774, -3.9314186242811022, -3.1541653513472823]
BIASES_LIST = [3.8866950094489776, 2.2860509992256897, 7.253534420259507, 1.8077220990636835, 1.1494924718382498, -3.822525848420988, -6.459072751668388, 2.7117038900452797, 5.272828976725469, -1.1741799359251823, 6.000256367858234, -6.885540909428663, -1.8818201663894452, -2.871936303415296, -0.5027831297079701, -1.1369676316628856, -3.3711764491259237, -1.0136387287044368, 0.6985899215176352, -3.817420967237629, 5.663771965123506, 3.1833285596673147, -3.8351280943888417, 0.8203824418736363, 5.256594205009242, -7.978801336858579, -1.4411342592439667, -5.948704599059992]
SHAPE = [27, 16, 10, 2]
>>>>>>> 7d31a6a87a720dfe4ed79aa94e6595884cb1bc5d

IN_TRAINING = True

## NEURAL NET FUNCTIONS ##
if IN_TRAINING:
    import numpy as np
    def sigmoid_list(x):
        return 1/(1+np.exp(-x))
    def dot(x, y):
        return np.dot(x,y)
    def vector_sum(x, y):
        return x+y
    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = dot(weight, v)
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v
else:
    def sigmoid(x):
        return 1/(1+math.exp(-x))
    def sigmoid_list(x):
        return [1/(1+math.exp(-v)) for v in x]

    def dot(x, y):
        return sum(a*b for a,b in zip(x,y))

    def vector_sum(x, y):
        return [a+b for a,b in zip(x,y)]

    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = [dot(v, w) for w in weight]
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v

def list_to_weights(lis, shape=[27, 16, 10, 2]):
    weights = []
    index = 0
    for i in range(len(shape) - 1):
        row = []
        dx = shape[i]
        for j in range(shape[i+1]):
            row.append(lis[index:index + dx])
            index += dx
        weights.append(row)
    return weights

def list_to_biases(lis, shape=[27, 16, 10, 2]):
    biases = []
    index = 0
    for i in shape[1:]:
        biases.append(lis[index: index + i])
        index += i
    return biases

weights = list_to_weights(WEIGHT_LIST, SHAPE)
biases = list_to_biases(BIASES_LIST, SHAPE)
if IN_TRAINING:
    weights = np.array(weights)
    biases = np.array(biases)

nn = NeuralNet(weights, biases)

def check_space_wrapper(r, c, board_size, team=Team.WHITE, opp_team=Team.BLACK):
    # check space, except doesn't hit you with game errors
    if r < 0 or c < 0 or c >= board_size or r >= board_size:
        return 0
    try:
        team_there = check_space(r, c)
        if team_there is team:
            return 1
        elif team_there is opp_team:
            return -1
        return 0
    except:
        return 0

def flatten(board):
    lis = []
    for row in board:
        lis += row
    return lis

def copy(board):
    return [row.copy() for row in board]

def pawn_turn():
    board_size = get_board_size()
    team = get_team()
    opp_team = Team.WHITE if team == Team.BLACK else team.BLACK
    row, col = get_location()
    
    if team == Team.WHITE and row == board_size - 1:
        return
    if team == Team.BLACK and row == 0:
        return
    
    board = [[check_space_wrapper(row+y, col+x, board_size, team, opp_team) for x in range(-2, 3)] for y in range(-2, 3)]

    if team == Team.WHITE:
        forward = 1
    else:
        forward = -1
        board = board[::-1]

    inputs = flatten(board) + [row/board_size, col/board_size]
    results = nn.compute(inputs)
    best_move = 0
    val = 0
    for i, v in enumerate(results):
        if v >= val:
            val = v
            best_move = i

    if best_move == 1:
        if board[3][2] == 0:
            move_forward()
        return
    if board[3][1] == -1:
        capture(row + forward, col - 1)
        return
    if board[3][3] == -1:
        capture(row + forward, col + 1)
        return
    return

def overlord_turn():
    board_size = get_board_size()
    team = get_team()
    board = get_board()
    board = [[0 if not x else 1 if x == team else -1 for x in row] for row in board]
    cols = [0 for i in range(board_size)]
    for row in board:
        for i,x in enumerate(row):
            cols[i] = cols[i] + x
            if i > 0:
                cols[i-1] = cols[i-1] + x/2
            if i < board_size - 1:
                cols[i+1] = cols[i+1] + x/2
    m = 10000
    index = [0]
    spawn_row = 0 if team == Team.WHITE else board_size - 1
    found = False
    for i in range(board_size):
        if not check_space(spawn_row, i):
            if cols[i] < m:
                found = True
                m = cols[i]
                index = [i]
            elif cols[i] == m:
                index.append(i)
    if found:
        spawn(spawn_row, random.choice(index))

def turn():
    """
    MUST be defined for robot to run
    This function will be called at the beginning of every turn and should contain the bulk of your robot commands
    """
    
    robottype = get_type()
    if robottype == RobotType.PAWN:
        pawn_turn()
    else:
        overlord_turn()
    bytecode = get_bytecode()

