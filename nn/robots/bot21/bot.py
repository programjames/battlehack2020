import random
import math

<<<<<<< HEAD
WEIGHT_LIST = [0.5617928166900803, 4.905923446513454, -2.3127394620504638, -3.5473243507764716, -2.320310622732316, -5.285121376469469, 2.879778880816472, 1.8265517502997948, 0.8048981819549346, -1.0999741527042943, 2.60257689559425, -0.015172241884110278, -0.9040900411510466, -0.7555385710792789, 0.23164356763010663, 4.934565691935386, 4.67684184778221, -2.9760716465899604, 2.836473803086462, 1.829198441733389, -0.37778750533224087, 4.349487328346339, 4.929716137007573, 5.416151479656964, -2.1168749455629756, 1.6095289023703192, -2.1852143931882915, -4.354142621538329, -4.9072240781925816, 1.3836146300878174, 1.3632074198379107, -1.1223164721399284, -3.396526947122251, 5.26356144594521, 0.9997247914097543, -2.498071926508526, 4.153462539988301, -3.280244760214752, -3.7456400557783662, -1.0292666957328902, 3.826076406732087, -1.859917063164884, 0.43971570414460626, 0.15979342313904804, -3.257805430168839, 5.732356536964661, -7.8818144140671444, -1.039161209656198, -4.613986382189946, 0.8780477437708921, -3.844870149978413, 0.6793843199478719, -3.5808227878228007, 1.890001463806027, -2.245682115611534, -1.5904316850176405, -0.41079275471542925, -1.9789912049494531, 4.889871625296928, 9.880683232330501, -2.1928548947207456, -4.49027003603162, -4.320629883164376, -3.5165507045241005, 0.7308336609889113, 0.19672695503160356, 5.3651616875149, -2.196513331395618, 1.2275528765904484, -0.6882394628447488, 0.44497934534026373, -10.342605550604755, 0.49061834013537414, -3.689916481258859, 0.04021299146389805, -0.9653686853324532, 3.3932854706433084, -9.798307411912246, -0.06753437588068462, -0.5659053059240623, -2.417728702406451, -1.1068126349446301, -3.251615856761778, -1.212734931675254, 1.0198257700946123, 4.814898433696383, -1.835466264156588, 3.9929641458610647, 1.3645375716548769, -0.6894182928841613, 1.0028386149889017, 3.7809384511162274, -1.2479919777537634, -1.064498441587956, -1.5762781362232352, 0.5308096902989772, -1.7523129922683054, -1.1320828193075396, -0.6278529822301185, -3.692131144016755, 4.122473920401452, -4.82488691821139, -2.32612596267981, -3.6087999794595755, 4.932136480671268, 0.7445280318540406, 2.7042395762786007, 2.68837734461882, 4.9654194049180305, 1.8838597093697609, 4.38762545323857, 0.6045026323643115, -0.533464181161208, -4.3107559760378065, 4.457572391055425, -1.7110904538608231, 2.5519743069723266, -2.76798113190861, 4.565696384541438, 0.5787578653822797, 0.6295316154842825, -0.15892971440096682, 3.5914742502357915, 2.6159784617024915, 7.0088572887547045, 2.443400993448087, -5.359148133782569, -5.636995655479607, 2.5504262514805984, 0.057492683320495286, 3.6255212027953188, 3.844147653189008, 6.4997532204181745, -5.743096314149689, -5.198422767636233, -5.155518036381802, 5.24062582254446, 3.5129124398672538, 3.5713240356049916, 4.5513662223764575, 2.0728294521909967, 3.484796310460522, -5.22105536159642, -1.0501910594092703, -3.6879605434309255, 2.518986923336969, -3.943268663643297, 2.4815550483447857, 0.4652473718670391, -2.4871491334567075, -0.4248904313792778, -5.120461482381947, -2.419958282432955, -0.0038145202767403442, -4.157614828719791, -8.687244000822803, -0.22203745212900988, -1.8205901629625656, 5.465282832118559, 3.8048363078062746, -0.9503779194470607, 3.837750776331828, -4.558876202964487, 4.482936859676222, -1.1263949996066265, 0.3643635955453849, 2.113441599435466, -1.6871295532060404, 3.3729127189501438, -2.6049517866275673, -3.453595538836192, -2.4290045626297094, 2.0628012271484506, -3.2815228275273043, 1.833849816195865, 0.18957211585717026, 7.30373378630966, 0.13573713101342422, -1.2338757412724808, -5.3741374179590435, -3.2241209763590812, -1.8738791684582092, 2.1517877129132548, 3.6554259781174006, 5.117607103021195, 1.128205072267362, -2.633353292074454, -6.112176063696672, -2.5085231259694023, -2.1310067420047685, 0.08464977359514042, -4.288084921761057, 4.579564688018273, 3.250164628178226, 1.9194397576953117, -0.43042921377888826, 0.7606991625981977, -0.52073637991123, 1.6968611793200505, 1.764619199421931, 0.125509588015295, 0.70144188401865, 3.0391792687016674, 2.4205853316128287, 2.248833038281981, -1.3546127328435404, 1.0335144442639321, 10.579412644765947, 0.5791142673092045, -1.1221799796163214, 0.60754733847028, 0.7518104085164621, -2.9373438500744036, 1.3033183976752045, -0.6587550232589329, -1.7625428145079238, -1.6094332751865144, 0.33397352954865295, 1.29559302795382, -0.7493984437449642, -3.919693630332782, 4.0773674087274845, -1.572032540505895, -0.9505839057727365, 4.251278674670075, -3.5270769763876397, -5.032731869396295, -3.323980949359655, 0.1567342180568723, 1.742874262381033, -5.341390070926117, -1.700538713151102, -4.684804767617052, -1.646309915931198, 5.275210575101859, 2.4077530611996516, 4.2783250703132, -1.168715825885057, -3.623930023956508, -5.9405083402642225, -2.5670775576093714, -2.592060986080045, -3.593341176580279, 4.861943570721607, -2.6021147992721527, 1.2123227467882054, 2.5923515743629513, 0.21395747997317777, -0.07732828307365054, 7.123453666499909, -1.5410192215995926, -2.1115727409735303, -2.305222365396366, -4.266523200013101, -4.855778676689798, 1.0133519609872854, -0.417219081277482, -0.352271133159185, -5.813884616186573, -2.5077996040485284, -2.7278270120843384, -4.578269676260029, -1.8264519733695306, -5.904599665043475, -3.063045296546426, 2.6911692497361006, -2.3680778342464355, 0.597170839678449, -3.7609405662368505, -0.5475215797012766, -1.6643242611073998, 0.16444791374049192, -2.897640424617787, -5.6180294195712195, 1.5193540047777474, 2.026706994059877, 0.20676892689777926, 1.0004721456091963, -0.7775514908360966, 0.3664502353171948, 3.9498789381988786, -1.0356350601459925, -3.8951725013150185, 3.753671607658794, 6.158853668081892, -0.08263916736659425, -3.385428043409363, -1.8234084367197636, 2.6382777815089327, 1.7008846464508982, -2.972527226667063, -2.693327186197713, 2.5492981455720156, -3.5724765382777144, -2.2627794645423878, 2.360495433403471, 8.828856654663122, 5.940845946833149, 1.80016572469973, 2.048618167789842, 4.558966555642014, -1.8798677002938617, -5.843562886849873, -1.7704717393646516, -2.3757213762175926, -6.8640060467934765, -2.8787687839098806, 2.2969728525104496, 5.061043164195604, -1.4310409525475094, 0.6763390315901946, -3.913051952398492, -3.5944219485597775, 3.258486521192951, 1.84713092011224, -1.7831451013472768, -5.650877576746266, -2.4055559855854582, 1.2840977811787313, -5.5991537782880645, -5.31783003104684, 1.274453236032849, -6.796838607002935, 6.403300420507867, 3.436714464954421, 4.607011486292213, 2.0001064522598906, 0.2764117231248335, -1.265980306521347, -5.56628712857306, 3.969568179292226, -0.3376558282145014, -7.429465855231072, -0.10107073849538886, -5.030316220065254, -0.5097312898097042, -1.6714557419681386, -3.4515904469064274, 6.5128995833331205, -6.776069429545853, -3.2369442626333393, 2.665790387823871, 1.474958776418668, 4.183404563244713, -5.693967312627246, -4.631372228775863, 1.7057803888713585, 4.800325579501542, -4.849288397680528, 4.651281402268537, 3.2552773354290867, -4.026068917294976, -3.40391677687912, 2.314181668125529, 2.331882694383708, -3.3904699537364302, 0.03450593882862325, -0.015148198097757583, 2.817558366659423, 3.2432122332440225, -2.2429809788761035, -2.826004702047082, 4.9250435487982935, 6.053556410162056, 5.2908218103133695, 0.11487896146723066, -5.843904223297776, 4.2670964569970815, 2.6064330541039773, 0.8511247746511404, -3.227176600239386, -4.717699332724624, -3.6654294265812726, -0.8907782848392282, 0.3360164649194965, 2.0698842991330317, 3.9230296339525355, 0.6833260641121778, -5.655904587395571, -5.258533069055147, 0.4253151037272863, 3.4227777943636544, -0.8705331065160917, 3.1702776880059917, 0.12397534163409756, -2.8720084627585627, -7.2332630643916636, -7.884026206343733, -4.596856623581314, 2.467225871795516, 5.603642805835565, -1.6997089644950858, 4.704881580385506, 0.5141926015281052, 1.439519951579601, -1.298267314208836, 0.3377521433314658, 1.1767002258732142, 2.263254941974681, -1.5031362064462326, 4.2929312586461155, 5.552365714297607, 2.714354100844295, -3.4545258809862025, -1.7139782799957863, 4.541440799610516, 0.6985903490705835, -2.1453254585033212, 3.8663723293603613, -5.550882797735069, -0.30192415456546495, 0.7841438171214313, 0.9040342938671668, -3.282045466635127, 0.9616347278623573, -5.681681244647848, 4.129135142402273, -1.5758997526410408, -0.7086142132332318, -0.991023110400447, -7.3940915190168495, -1.8341553592102753, 0.7527752894388836, 5.22382109138541, -4.350199919852235, -1.1480660336176873, 4.0837354348554005, -2.7432089095413525, 0.9122673101124801, -1.9395404802695557, 4.388421486804161, 2.7848231187153396, 2.9963522588760214, -5.909601617567071, 4.936037305406598, 6.180993920435831, -0.7317425242398988, 0.8107434555545809, 1.5831644044660356, -4.7643300312548655, -1.6111300653300487, 0.6534586530567157, 2.0179567689721556, -1.8302405299819755, -0.3739493683920033, -4.324573711724845, 0.7151164187900645, 7.986358606115575, 1.807103419524369, 2.9280878606117295, 2.4165114058862005, 4.517566777735973, 4.934933752114968, -4.359865544841236, 4.687502485125592, 0.005025824305337151, 3.6316943958844288, 2.5549147710659827, -0.3834695678678975, 2.511162068802204, -0.420580033891662, -5.915180130069716, 7.698171634500682, 3.678833766944798, -2.0467445879323236, 2.0658287840268623, 1.495971728594897, 3.1938422999439107, 1.375347519587088, 3.0513637656157355, 5.179781228106786, 1.650642100329967, -2.323822269105449, -0.10215098845763479, 2.496659142919143, 1.3519986783254658, 1.5672538029466139, 6.842797572528975, -4.27346172486696, -2.454692837526921, -1.1956505008629839, -5.078725428943841, 0.5680511232371032, -4.347652592857904, 2.690891151451674, 0.3994992424150148, -4.408830958413767, -0.8186354766562997, 0.47886915807952496, 6.264689759874029, -3.2784010178945495, -2.8764983913956823, -0.6981410219618301, -0.2481439086277025, -4.86523529740995, 1.3554782448349474, 2.5997469022650987, 1.8363139596169191, -0.3681498303050847, 2.7221233917344643, -0.2862947706844555, 0.11340548334733763, 1.5460888583354442, -4.7401813849713665, -1.659914670890722, 3.6086860815030075, 2.8705701317084946, 0.4961505809354491, 4.258326251745868, -3.059850899778173, 1.8215834889403875, 1.053857569224646, -3.773753448303033, -1.792262057359646, -4.903060525207705, -0.9702728056946074, -3.99319018412528, -1.0084084412336025, -5.967901272521663, 0.2972712787035542, -0.046214955330379226, 7.010514927511703, -1.1913553422281813, 1.1082599203795416, -4.01858483038612, 6.9588144464483985, -4.077387991732655, -4.133649227094735, 2.0444540071536066, 5.103411466869036, -5.500610942512037, -6.401424583855079, 0.9177511362367381, 4.22624653485075, -0.9045743811904118, 8.07281766294815, 2.529122009744475, -2.302321908520575, -3.3363715193977157, -1.9933772264607406, 1.460170202581447, 1.0614427855715172, 1.4329847869507883, 9.022271677470439, 3.8056874118394877, 0.5654928918584206, -1.267490762238832, 1.8053913990248136, 1.5001118428661637, -0.5480798464142785, -0.28125590780734633, 5.979810326775359, -0.1215500854516893, -2.7845519651055692, 5.40580460280924, -7.765429608919034, 5.2545091972067945, -3.8908126334584874, 3.4042365633432614, -1.005505730593743, 7.810211954642656, 1.8975611138108062, -2.2596885377919502, -2.1868894929368037, 0.032837774318366666, -0.12105815109169045, -2.4584430437092366, -4.424613677131838, 2.215959151680356, 3.9635549013175027, 6.044234100195006, 4.876087527099293, 2.250336316181714, -2.149874296629184, 0.033063791384832786, 1.8525874853599549, 3.7036455587277852, 8.937905417692848, 0.39559006592529433, 0.2234141757547996, 9.60937312252815, -0.6184569827452495, 0.5400777154993335, -3.182823817258742, -2.549945103760997, 5.773185494711297, -2.349645625674118, -5.445487822779977, -0.23986810929046792, -7.3628018800479405, 2.4202263679811162, 3.0771862767476907, 6.110367971145739, 4.94399869485751, -0.9556746960630064, 3.8056597694242473, 2.913259242002996, 4.111464030948646, 6.78905185246761, 1.3844868688483079, 2.303912431866331, -4.256135811465317, 2.0197255974174366, -7.720965001712325, 2.1621173486904812, 1.2601852150290525, 1.2213992910178262, -5.138874180910269, -4.539441678898162, 2.360136496093026, 3.037241391071576, 4.273746919518438, -9.131157481283482, -2.4228178523193544, 7.441318478015247, -1.356665357049586, 1.439080692646875, 5.830901903549044, -3.4687901441473716, 3.1610667412171334, -2.01020721605782, -9.98604438833153, -1.045451287101306, 1.4762629191618388, 2.9052829047305107, -0.906115234318237, -0.7058908642678035, -0.8053893865750237, 2.274218221673816, 2.492405383561498, 3.228417170946373, 0.2785871268942101, -1.4204503848416772, -4.296004739157706, -3.224238311300752, -3.421945066661792, -0.7076566347568607, 0.8621183111748515, 4.223122130553978, 1.953691767705768, 3.1835146747730083, 3.1160572629454633, -1.4429276531341535, 0.16326075984931956, 0.9671055138775568, -3.081664694145893, -1.6427481160296218, 3.475543554152683, -4.019589744661032, 3.362056861262319, 0.576783228994784, -3.690680001918957, 3.451089083273833, 5.928026708567155, -0.44561502929654356, 3.226511208336411, 0.3830475051696147, 1.8525614602982812, -0.915184836204694, -0.19891180995791394, -5.256341640642487, -3.3610796943376324, -3.708246922814613, 2.338456125231905, -3.8972049534838353, -1.5393307033737822, -1.1390102517876814, -2.05816314906381, -4.907299585098893, -3.8641670503885597, 1.9849351580281454, 5.675267698580878, -0.2013219164049499, -1.8312694249777752, -1.3579108634941646, -4.277930233330873, 2.346918277920492, -1.5556788193592423, 6.687329670602021, -2.6751350892364654, -4.744772056343939, 7.886275794531842, -2.047587499272365, -3.2791327135963915, -5.157221387859917, 2.9961095871017576, 1.5230903947496213, -3.5567687087900555, -1.3627155343197577, -1.590661369062121, -4.803203156034482, 3.33303590637087, -1.3114139545152894, 4.386050301869272, 4.6269512865405495, 4.2914365133790735, -4.913292093792658, 3.647963793008628, 0.23494062890372833, -3.399418272254908, -0.3542183220964006, -4.741443750677361, -3.537606076781037, -2.069403866849034, 2.5282222893541446, -3.4119830416762715, -4.679747690609918, 1.4371872686286646, -2.756987682498663, 2.0092899388388368, 0.46980782102013924, 1.672447113034196, 3.970197342541615, 2.928307144508816, 2.7892641667948874, -5.868898104268152, 6.9827785006823015, -1.3600989410322777, -3.4663504942804315, -2.843087867080174, 0.1449119069629491, 1.4912157988381216, 3.029662751108817, -3.590036815563833, -1.0577661261206757, -2.7610104380361062, 0.5841309922812161, 2.1872311819268586, 6.123648440939336, -2.757143540598413, 0.08878847398657032, 1.4798039198734423, -1.2518909396727267, 0.7347098506098106, -5.74007055419283, -0.8377841117440726, -2.385228280848938, 2.358069969182594, 3.7721407310504165, 6.926259189879504, -0.8750730971519959, -2.2277028277113438, -7.979213955294661, -4.331285113944897, 2.9919141040670354, 4.2187943979769065, -4.414998551903722, -1.778554199602416, 0.974871345006018, 7.594658216550414, 3.7565676786292173, 4.876499378534994]
BIASES_LIST = [-1.3852096059396832, 3.7073068224000676, -3.6116373691014183, 4.794277682495607, 6.336811813074186, 2.77340889008345, 1.0997671824657276, -0.08725149804373364, -1.1036456325052026, 2.6551693097792657, 2.118438902584342, -1.3728150748433139, -0.002376753988461361, -2.618673439706178, -5.500630244835626, 5.268496195676573, 4.82243524361936, 1.4767497320328444, -6.565652701543652, 0.024468196124548272, -5.075975917538869, -2.8045357840559135, -4.0672971436715395, -6.096830052788481, 3.9232725489927933, 2.65077781890774, -4.027490296760194, 2.9178439646663796, -1.0824217645059204, 2.2990697982692754, -0.3422305734004665, -2.2942948772705702, 7.1241618798792805, 1.850392922851316, -1.679480354543223, 0.4433828593137494]
SHAPE = [27, 16, 16, 4]
=======
WEIGHT_LIST = [-8.490762365376908, -2.5580561521857175, 7.305910210289147, -0.6007024401820711, 4.015796006472624, 1.8863993585480587, 0.3813947469299352, -6.827200816030085, -9.497798100612616, -1.1758829965585718, -0.16290393001409043, -2.2067265393750986, 0.1849545190079936, 2.2897361790954123, 0.9397367942008203, 4.204305636254763, 5.1923128823821045, -4.811283433135529, -1.2748944794842287, -0.10255366585024195, 4.470639726654433, -1.171355407287882, -3.5893662963240427, 5.343178544005168, 1.8910231270989581, 4.853418304307824, 0.4542240830479684, 1.6928667280633132, 1.2780375316774328, 4.515309908746132, 4.390028667348134, 5.040776819635897, 1.2610568245877027, 5.390047775680293, -2.2271937984311854, -7.351986977768071, -4.4351081682794025, -4.522179139148855, -3.786321980827828, -1.541396038213762, 1.6474214225623496, 4.50602728198924, 4.0942282424516145, -2.3838008772498127, -0.4729094850876364, 9.362135188968084, -0.09800399815176841, 1.5558186760640107, 2.986952888654353, -0.6385823235925512, -0.7461082704867734, -5.798762920110511, 1.218529110021417, -5.140328313333416, 0.03695424246637924, -5.955668625002017, 8.022409918462962, 0.4222293175960719, 3.8458176659522523, -0.4290335043651495, 4.662501577568411, 1.8912485278603275, -5.144403758028236, -3.1699750447556863, 1.3633174042541838, 3.520512589290139, -1.1258663870515548, -1.9330842057653168, -1.1867459014897654, 5.977576116534588, -2.939759436731748, -2.3718008800643218, -2.362880700664095, 5.058840253968813, -1.6601056615950156, -2.2397515334184397, -1.6892252939721135, 0.10982017962835772, -5.599486879902702, 6.231246472179887, -3.0034778198732273, 5.327329943068611, 6.092589845370492, 3.8130860689739463, -7.565199493790105, -1.60114349907238, -5.999354867238281, -1.8163200873275138, -1.030293112755815, 7.839969874517112, 7.536482325164548, 3.6743001711276544, 0.8725912721878224, -2.517711166371559, 2.79002906192717, -1.7186753274269093, 2.3794868629067736, 0.8474477523555428, 5.872844449330197, 2.263710548280137, -1.230590872033985, -6.694667629983268, 5.894453086260088, 4.507400512632741, 4.420714538240626, 1.789513904228151, 2.563952512083295, 5.25524824134372, -4.5658992331510415, 3.8429597227416434, -6.439376727971838, -3.1218276287648314, 3.549542380949283, -2.6681459261020013, 5.545652614537255, -2.2894117968063177, -9.715358921720359, -1.8417351223228706, -4.461131199461818, -2.4132108059963473, 3.5292200462523984, 0.3799795596396702, 7.84106656078722, 0.012361639241196182, 2.6009898129646927, -0.0647412559992078, -3.2035245361450246, -2.572475492660243, 1.2278276208316814, 1.806219077373668, -5.033569219932661, -9.577003495034253, 1.4807428499612547, 6.13300260881485, -4.812593429850567, -1.934896121640429, 3.6023174786683017, -0.8321603029574944, -3.4125363737016703, -0.07916609459348126, 2.19513225269601, -2.64727540129094, -6.91600284736743, 7.0670912152401275, 7.614698131440475, -1.6423231905913405, -2.238881714692873, 8.168327906051378, -2.733059909578865, 2.3586829790995405, 1.5435619637734608, -3.6707986772557746, -7.0671870104728365, 1.1909710490337404, 1.4185652832355178, 0.37929865174632044, -3.7866428997839927, -7.048557784879314, -5.661552524932174, -1.7128757849931415, -4.818119730318013, -4.070773918064818, -3.6324436922493297, -6.2972368748825005, -5.479028390390014, 6.716613634202536, 2.1567086801566417, -0.0867856516063999, 0.24001320193005693, 1.1684528841244637, 2.9539202120857193, -0.4351380426425356, 2.2140195316000213, -2.81496047609594, -3.331980826851204, 1.9800030138477975, 1.07122688703374, -6.258331047908347, -4.647513030703893, 2.334750456797306, -8.12134851795211, 8.93596489044198, 3.3822223861309837, -5.52786585958783, -4.434003070270775, -0.8536087653241506, 5.039721728851513, -5.214992724975466, -4.965643116929997, 6.964741615263751, -4.915561573675285, -4.8559926850792765, 4.907408038810035, 2.5436694235016466, -5.435342226010391, -5.156640202179632, 6.9267777803707675, 4.236123420474785, -0.07266264423543264, 7.4335366066937025, -5.5905386056538715, -4.451148241373717, 6.49474148734815, 0.7749690881475368, -0.4224571669364256, 2.7064469378373093, 3.4937204563364817, -0.6086447748459078, -6.895931387920796, 7.398170957133152, -7.086089389733198, -2.0226701006189494, 1.530430777618304, 6.96965592350692, 6.2088627296901, 5.586165994257551, -0.6091047401800086, -1.803450341940567, -2.5615794475491103, 0.5284565278877758, -2.27869557369085, -2.7013642362175774, 0.37979343851559694, -1.4136968955897287, -4.203935721506098, 5.944299996356282, -0.8951894279944617, -1.380752230066172, -4.0593836889521935, 2.5966856869773935, 2.971460775327836, 0.6989490947465606, 5.656562520014236, 3.2738969706485537, 4.202336458554038, 0.3541456363737679, 5.597965893037142, -5.971132581137026, -2.7767345445014797, -5.111259197062595, -6.195676309779083, 7.232308880868993, -7.092150214320084, 1.7263900930837872, 0.5207578346234836, -3.4235718191010367, 0.10275076154470669, 3.9961685464095384, -4.328045316410059, -7.862921844440796, 2.0150520620657697, 1.9021875071241916, -4.694811062834004, 6.564598811761541, -1.3536351399205326, 2.2529675243865928, -0.7049607331937136, -4.347719187361079, 6.261472400885693, -4.311809562122456, 5.887742856656884, -4.2581038234289625, 2.7429346183886745, -1.326432307127683, -5.093142068524382, 4.66618158218723, -2.637695668127456, 0.5068624188687785, -8.28645010909107, 6.820439923509451, 3.117168626135354, -9.540694774044796, 1.9014559319708901, -6.717992755692092, -0.48411471961291286, 0.09991340354438255, 5.267155170249441, -4.543156092987713, -0.7777904125985582, 2.388644829312065, -1.1616144800651496, 4.366701861438648, -5.797572418413234, 2.53683003993918, 3.516576267080449, 1.9454283197647824, 2.2781792596721, -5.930917320560011, 10.373687137588542, 8.906483802898826, 0.7985791711033274, -3.621140999209893, 6.005231000220346, -0.554708319122704, -0.9380356964319136, -6.007907111065246, -1.2438986069485676, 0.8393484529412305, 4.812868414114128, 2.4033857869485504, -1.5627430975600185, 0.07532668909110846, 4.737990845439578, 0.4549862894232632, -1.7176120832228885, -7.5648041087886595, 1.883341528637923, -3.7721314676199746, 1.1907056787885355, 4.197137336740995, -2.3851042925830965, -2.520787996763892, -7.945247865447674, -3.613033686795194, 7.647596833599996, 5.660338295883827, -3.3339247926784292, 4.145840796556364, 1.3549253575826103, 3.5283741349330167, -3.1976238857532016, 2.4303895840982066, -2.6931015965372125, 5.726273116959714, 1.5166403488712237, -0.25263142466570027, 0.45316485185968797, 3.87103623772794, -7.880296339174156, -0.400177146778667, -3.7456515238919263, -6.95501676197834, -0.4118517301599354, -3.8753010136095645, 2.7636469636689873, 5.183446290867442, -1.2387235544137327, -7.01805729102741, 4.92662642696274, 3.285431121807827, -2.3604608978026236, -5.675697163347841, -4.539854727050136, -3.724324731246461, -1.816464682055526, 7.187744357768794, -3.4232453220309185, -7.15301305600644, 2.104228425799769, 8.78444530516951, 8.988311989836037, -8.806490962216088, -6.857057268491993, 2.85998984459953, 8.347013719403071, -2.808439507093881, 2.2196371191271047, 7.643226205081707, 6.154443509239799, -2.330140721695813, 7.434145529484641, -4.121538076351188, -1.1913017937067427, 1.5831729738003666, -0.8831002363314071, 2.908229198383736, -5.254533576277818, -5.805016427840601, -1.783671356207901, 2.28446810074866, 7.915669833098691, 4.119745351817925, -0.11307074490472732, 3.8658744930584086, -0.11562876187788373, -2.5756258216782855, -5.045731691928232, -0.846853959043288, -1.7713233248291176, 5.542352712894058, 2.059108170694667, 2.960219541051037, 4.023854270997206, 3.3824849829900487, -3.526407318370968, 2.207361198242851, 6.401839364734371, 3.4388463240652998, 0.36063595456188274, 2.4386365676495405, 0.01894364287817818, -3.4730165334007332, -1.2294780942327441, -3.7432599299652582, 1.2159669354640013, 1.3955636915407001, 0.17191236161918183, 1.6203694745576254, 3.116988511401519, -2.6431910299025243, -5.908238590113329, 2.7392632260249083, -5.838911781128164, 6.406869862840172, 0.12882196149434988, 1.311767359063396, -3.876380795646955, 0.64501514617028, 2.6704931038469972, 2.894167383140901, 3.0391405634567747, 2.8841107993307795, 3.5867259542206757, 0.12494373585880342, -2.184178708495114, -2.764243841266738, -2.6666810479759127, -0.1666687724309856, 1.2786790623797692, -0.7588605434502427, 0.4679024736739203, 3.0978170297332075, 3.810368044345943, 2.0842461288505945, 1.3909805031414728, -4.426244447699875, 9.094044517107495, -3.2836473912055033, 5.017715795959248, 3.865828869512264, -0.3835412742946992, 4.932488564634435, 0.39547871369222104, 2.9727040454450444, 0.6520970555388685, 3.4548561594526745, -1.7601464931444295, -1.3344404198962836, -6.473919263141583, -7.837990708923525, 0.8610070728100423, -3.7297334285817754, 1.347802077514965, 1.5572105218541075, 0.5775667749720113, 6.669225664867694, 7.5798656690018085, 2.965370756868187, -5.743162819227138, 1.6182187919664068, 4.8506425533699, -3.4421250402692514, 2.825120839381211, 1.6197561717028726, 5.777390234289795, -0.012101716739447321, -4.06468305676238, 6.836623591103229, -0.017988600635426844, 3.981450237027079, -2.503943281452792, -3.5621535419520907, 1.0752402840364526, 1.1132671255787066, 3.09397741882912, -4.246618164159363, 5.425516036338102, 5.476082874026994, -3.5175519721841253, -8.057302873974546, 5.104333783752403, -1.5679106771278513, 7.214131259915406, -0.24670512293667793, 1.5180353304888246, -9.151195499747939, -4.562322675344668, -1.1357802575975215, -1.6438624150795556, -0.3527570489814047, -7.09229984415559, -0.8857795522898695, 7.897662922024538, 7.936211267130671, 0.6325410009493397, -1.2437471365697115, -1.6464363613230217, 5.585575539047871, -4.27105320351362, -2.270515065090463, 3.9958988790416723, 1.0642562943511824, -3.2677602657975826, 5.372107465618438, 1.8245863986523259, -0.98866746209616, -1.2423641766181674, 1.8740258992613792, 3.4065119109341486, 3.554474637284737, -3.364032538928347, -0.2693008000513935, -2.3345544172548616, 7.242225060418348, 2.631424432285779, -3.4172942360023133, 4.995347199285662, -1.7954519200011572, -0.4059695091807155, -1.4764501819184188, 1.8663474672359341, 0.38581365626109515, 3.891492444597876, -7.103922432648351, -1.2443736199077868, 0.21565506521852912, -4.289514348066898, -1.8433683021085119, 0.5105296748197155, 2.524424602728593, 4.127415511084862, 5.826483244790835, 2.3924053465766044, -4.769309335960155, -2.7260502906829176, -7.570182598567556, -0.05734367818580363, -4.071846647091533, -1.4325988252558974, -2.893193523583979, 3.966684653015252, -3.1281947920047686, -6.980750918091313, -2.8536323193342192, -3.8530648146959026, -0.06203382790375986, 1.6298683210625586, -1.9819552641419154, 2.6508931506617617, 0.45179328822266557, 6.611225766468545, -0.9407739798609895, 4.562277487455002, -3.6812617205991787, 0.28529846352985305, 1.6998499342699886, -7.815533001597431, -8.21121157922631, -8.506095267299086, 6.18605743639161, 4.0706136574636504, 2.1941761549983054, -0.31482701607207886, 1.4000019856340695, -0.5373806239037041, 1.2079851185796082, -2.7724660890310444, 3.5999886965256755, 3.3429341731102973, 2.4847547761793605, -5.104519069754938, 0.42032534313015263, -7.213247436344418, -0.5259346244787699, -0.2823553381462752, -3.1300218385850287, -7.84689116898481, -0.8004140065471264, -3.1676074688052167, 2.4368369967953774, -5.521537254468775, -0.5787103409491327, 0.7649024924763612, 1.9245948825558141, -6.912044925003095, 3.0467161945546866, 3.7634963234640146, 6.230081297161087, -6.3286298864935775, 2.4976463382018386, -1.7308135945608545, -5.013612071419626, 0.8917251094674108, 3.387653708534061, -2.0252814606624936, -0.2825639994924199, 3.6260821474387988, -0.3251885157275663, -1.3613418480013966, 3.4498647767942288, -4.876186019307102, 1.308989074158222, -0.9684547338769969, 1.2834770304760221, -5.264580826921376, -2.1003746667102354, 1.7624077668762026, -0.8994410934624659, 1.4342423308346528, 9.178964746484361, -3.6386967523598432, -10.646207111303283, 0.7263957348303933, -1.5769397848138895, -1.3090225270402798, 5.480889473573949, -4.45556551856698, -2.7420195722530836, -1.7471515001170315, 1.7098543000579018, -4.410451198364409, -2.775310812072323]
BIASES_LIST = [4.085811095235502, 2.3638448462048913, 6.863248916172599, 2.099143174466908, 1.5991173730870383, -4.032358682161945, -6.836306643619033, 2.5452003124909868, 5.478575125863926, -1.4929802364485787, 5.870785040672714, -6.589756651884383, -1.2856593228323567, -2.302664294067371, -0.8253697647462326, -0.8095721447598687, -3.377185094978838, -1.257123009339648, 0.1918377612663224, -3.7538962201832677, 6.273064673508729, 3.3905773524821923, -3.5227484898326344, 0.5733648991417895, 5.083936557865293, -7.58399332521945, -1.5663618294375956, -5.898203787282492]
SHAPE = [27, 16, 10, 2]
>>>>>>> 7d31a6a87a720dfe4ed79aa94e6595884cb1bc5d

IN_TRAINING = True

## NEURAL NET FUNCTIONS ##
if IN_TRAINING:
    import numpy as np
    def sigmoid_list(x):
        return 1/(1+np.exp(-x))
    def dot(x, y):
        return np.dot(x,y)
    def vector_sum(x, y):
        return x+y
    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = dot(weight, v)
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v
else:
    def sigmoid(x):
        return 1/(1+math.exp(-x))
    def sigmoid_list(x):
        return [1/(1+math.exp(-v)) for v in x]

    def dot(x, y):
        return sum(a*b for a,b in zip(x,y))

    def vector_sum(x, y):
        return [a+b for a,b in zip(x,y)]

    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = [dot(v, w) for w in weight]
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v

def list_to_weights(lis, shape=[27, 16, 10, 2]):
    weights = []
    index = 0
    for i in range(len(shape) - 1):
        row = []
        dx = shape[i]
        for j in range(shape[i+1]):
            row.append(lis[index:index + dx])
            index += dx
        weights.append(row)
    return weights

def list_to_biases(lis, shape=[27, 16, 10, 2]):
    biases = []
    index = 0
    for i in shape[1:]:
        biases.append(lis[index: index + i])
        index += i
    return biases

weights = list_to_weights(WEIGHT_LIST, SHAPE)
biases = list_to_biases(BIASES_LIST, SHAPE)
if IN_TRAINING:
    weights = np.array(weights)
    biases = np.array(biases)

nn = NeuralNet(weights, biases)

def check_space_wrapper(r, c, board_size, team=Team.WHITE, opp_team=Team.BLACK):
    # check space, except doesn't hit you with game errors
    if r < 0 or c < 0 or c >= board_size or r >= board_size:
        return 0
    try:
        team_there = check_space(r, c)
        if team_there is team:
            return 1
        elif team_there is opp_team:
            return -1
        return 0
    except:
        return 0

def flatten(board):
    lis = []
    for row in board:
        lis += row
    return lis

def copy(board):
    return [row.copy() for row in board]

def pawn_turn():
    board_size = get_board_size()
    team = get_team()
    opp_team = Team.WHITE if team == Team.BLACK else team.BLACK
    row, col = get_location()
    
    if team == Team.WHITE and row == board_size - 1:
        return
    if team == Team.BLACK and row == 0:
        return
    
    board = [[check_space_wrapper(row+y, col+x, board_size, team, opp_team) for x in range(-2, 3)] for y in range(-2, 3)]

    if team == Team.WHITE:
        forward = 1
    else:
        forward = -1
        board = board[::-1]

    inputs = flatten(board) + [row/board_size, col/board_size]
    results = nn.compute(inputs)
    best_move = 0
    val = 0
    for i, v in enumerate(results):
        if v >= val:
            val = v
            best_move = i

    if best_move == 1:
        if board[3][2] == 0:
            move_forward()
        return
    if board[3][1] == -1:
        capture(row + forward, col - 1)
        return
    if board[3][3] == -1:
        capture(row + forward, col + 1)
        return
    return

def overlord_turn():
    board_size = get_board_size()
    team = get_team()
    board = get_board()
    board = [[0 if not x else 1 if x == team else -1 for x in row] for row in board]
    cols = [0 for i in range(board_size)]
    for row in board:
        for i,x in enumerate(row):
            cols[i] = cols[i] + x
            if i > 0:
                cols[i-1] = cols[i-1] + x/2
            if i < board_size - 1:
                cols[i+1] = cols[i+1] + x/2
    m = 10000
    index = [0]
    spawn_row = 0 if team == Team.WHITE else board_size - 1
    found = False
    for i in range(board_size):
        if not check_space(spawn_row, i):
            if cols[i] < m:
                found = True
                m = cols[i]
                index = [i]
            elif cols[i] == m:
                index.append(i)
    if found:
        spawn(spawn_row, random.choice(index))

def turn():
    """
    MUST be defined for robot to run
    This function will be called at the beginning of every turn and should contain the bulk of your robot commands
    """
    
    robottype = get_type()
    if robottype == RobotType.PAWN:
        pawn_turn()
    else:
        overlord_turn()
    bytecode = get_bytecode()

