import random
import math

<<<<<<< HEAD
WEIGHT_LIST = [-6.002694540336114, 0.8920894041254392, -5.673651703549753, 3.5424648790535933, 1.5410574715433878, 0.4941690747393661, 0.4904758761040391, -4.894785518019926, -5.871792053417984, -2.464230681642759, -5.680983624097613, -8.909043902377258, 0.9353048523230321, -0.21331682749899628, -2.131943617455807, -0.35935103193486206, 4.1537543522151115, 4.015410101801486, 6.698924053292281, -5.130573126796061, -9.718453442190384, 1.565570308136925, -8.061967394059677, 8.290290019812645, 5.702775267973134, 4.711892141827514, -7.616066046092403, 6.4797835589520965, 1.2503570590730817, -6.101423609470579, -7.980942740228563, 3.958180562435654, 3.7179594754483407, -2.429783672907475, 6.1873925141533945, -1.9096736554499731, 1.658574959791487, -0.8645145864973003, 5.012091970518032, 8.818411739546299, -6.087154793838236, -8.927202547640302, 5.151215426382535, 4.033946107999354, -8.690057175772573, 1.605564042672686, 6.027628880655989, 0.47392552748663874, 5.070200491400183, -4.500866739199967, 3.6850193563905, 9.626842938898857, -5.733762121690482, 4.358596931692418, -0.3903305626325082, 5.661171742865346, 9.852537906494106, -0.2321708511186582, 8.53352221270892, -4.439302159357743, 2.4436520152089614, -3.5959109867091232, -8.60766814934951, 8.854352116614447, 1.1598487056267075, -0.16442353697050827, 8.515478195005837, 4.911748378527292, -4.543806922663636, 3.864283595377877, 0.7397457079754126, -7.326165259684703, 5.936336251235566, -7.131218066840887, -7.010791273786319, 0.15514241771985127, -6.837430147837051, -9.381420310174729, 0.5270328340722781, 1.3637657730364978, 4.412655325938298, 1.3702379477007014, -8.23268393491407, -8.575918035506414, 2.7298001745164395, -5.554780114032402, -7.985209274690508, 6.130688846524098, -5.07893894093508, -3.4300071908740275, -6.02604789514203, -9.504878827811186, 0.24879688195923677, -3.611972208022822, -7.77258505717545, -4.368707013922224, -6.84618394641247, -7.051729362825601, -9.707558766570383, 1.7702630448505623, 9.418399697356609, -2.3142778109289264, -4.900627961805579, -2.9332110024459856, -9.681181679437184, -1.4299407146265644, -3.629767492376976, 1.0170012362775953, -5.119993232996649, 6.3883036392660095, -7.010086990922185, 8.722353844929884, -6.451097318871928, -6.612198961479201, -9.51522240009277, 6.760234140273347, -4.069506190946591, -3.2389177134892178, 4.857277232787293, 1.4455684240757236, -7.063715293130306, 0.09353367460531992, -5.202166431726001, 7.3254592454004595, 1.8800102683617546, -7.981803979378929, -6.8867348913022175, -4.807956264701443, 6.744528684201757, 1.093350000332677, 0.8802846598954535, -3.5632462729541174, 3.4071276596624482, -7.201403682507319, 6.395664004887827, -4.9441364174221665, -9.180232200549874, -8.343334543118974, 5.172912766497106, -9.583477648943193, -0.4546331061322455, -9.263070558698338, -1.7821153399133767, -9.643387735924343, -8.028796234201913, 7.664308321282132, -9.172135821265188, 3.861324465818388, 2.0936249938526608, 9.450071372816556, -1.7120861839608459, 8.87499363089935, 2.960009620465687, -9.630571274397767, 1.5981567698290267, -0.08308551418438448, 7.96468325605445, -0.10980111918921054, -1.1560387680681394, 1.5995185103872984, 4.797467640150138, 6.38805071708936, -3.296249496566337, -8.45917654839342, -1.2033847869583987, 3.854421683166967, 2.0428876660971955, -5.493013679083525, -5.430107937205468, -7.97265708849475, 5.408066680344222, -9.676505621561457, -8.842168250747111, 9.53162016405092, 9.914205407384301, -5.135227869188174, 3.688534199790716, -5.551910476977291, 5.4134618875309926, -4.687877166656788, -2.9464802961557908, -9.812494975337554, -7.43617302950341, -4.674301726522108, -6.441242783200838, 1.8363228483715481, -1.3639516909337974, 7.0268928165393945, -7.292037677515648, 7.61855485998797, -4.031024936357637, 1.3921957784160615, -6.143785460435389, -8.25926787138713, -6.80458455995089, 6.678365237558449, -0.24665600057008952, -1.9136415107374294, 9.676708410796344, 1.6896844186248021, 3.6055655971880807, 7.078201183484168, 5.144918935094939, -8.239389076212118, 0.6501992951702213, -8.447101276306725, 1.7891114239772143, 0.6340336887772491, 0.9211242739302996, 5.131023944958244, -6.924587128660422, 2.9785322112916184, 8.830461885392808, -0.4228867631019746, -1.1546305649073432, 7.55413500391526, -0.010071692050900083, 8.655168083619959, -6.677474411725561, 0.6617732323680592, -9.437061035181348, -4.221303415194802, 1.7246522873810868, -5.280912667699265, -8.415916432235695, 1.7180336427545395, 5.080818352506071, -5.915665848209257, 5.451959656657667, -3.504642341629804, 4.974489654860122, 9.070849589729757, -1.5828784673995155, 3.1291735962373757, -0.48879599252997785, -3.488503018844935, -7.537230010830673, 7.164084942036798, 8.781131608636205, 3.1188101347023345, 6.760935659477319, 6.026862318212917, -0.9596264726985311, 3.636226580801921, 1.6599736802681235, -2.382681273414806, -1.3653420197020552, -7.1206190102920885, 4.452704915182444, -5.794527923723656, -2.2583635114559986, 5.573436524089537, -4.593035275555937, -2.539052349186255, 8.441781070663176, -8.66176796506937, -7.4734461266763486, -6.921537836480285, 7.479970760008737, 2.3003729752537296, -4.6661024537724005, 7.613897432712424, 0.2311640916263098, 9.331033257317024, -6.93404296667609, -8.194906009930607, -5.112285520730058, -7.906136847480729, 3.6233199580599162, -5.884735367142408, 1.8942842863683396, 5.022423217932278, -5.492023485903799, -1.5483734031766065, 0.31714120550677904, -8.814404363758827, -4.318322800587248, -9.77462044240414, -2.2108032837800318, -3.848570267235802, 7.695075063594782, 8.323286140625846, -1.1880540154738188, 9.714458738562378, -9.681948016975152, 0.7118286519776689, 9.565653454140833, -7.538556947568424, -5.766347816519161, 3.6124492170617106, 9.296651796005712, -5.7626195523124, -9.846962963527481, 3.060681631405288, -0.11218263698307318, -4.558948938511554, -3.9739574393144146, 4.129355103995474, -3.50498919116297, 7.614772593502185, 2.2086396801057173, 4.955364016492478, -6.196773892122575, 9.983481869071955, -4.133593851120163, 0.16497473019007458, -3.0725426842466312, 7.297900270067014, -0.5962744946236942, 5.14074474516873, 2.99143848075056, -0.776106684596165, -5.2347370632771995, -1.0378398544322245, 5.688257737729893, 1.637581023967238, -1.1192666811338103, -9.749520489486773, -1.0241326975346539, -2.7894240001390607, 1.9786552646171032, 6.154405316669447, 8.705401553100906, 1.6304839988125543, 8.000806461300293, 5.370908289100473, -4.77353662518089, 1.550514246980688, -9.120956317914493, 1.2500434096499724, -7.998441265066029, -3.6015456957029386, -3.8795506774944926, -4.407925593333484, -5.866675347524948, 9.705098856909878, 7.153163956118952, 3.2790566903627365, -2.6894150509562076, 9.791677557481695, -0.04954244710875422, -1.30429072916629, -2.9870553375982016, -1.3553349416945633, -8.417393991969302, -2.5126609137024003, -5.022640944481629, -9.947506180920207, 9.812523352225288, -6.627614148056297, -1.6533347890184977, -6.216872327117673, 6.176885228510024, -2.2242740114549413, 1.1604109703433085, 2.956002769003911, 9.692474359169225, 1.2668445246908604, 3.520757974619876, -3.840405663215341, 6.327684416996561, -8.096820389431027, 6.787182456541142, 7.187431080935827, 0.5455025186626887, -6.563932395592644, -7.297209426610571, 3.8665200740492622, -1.7509512846119293, 4.042928243858615, 2.9111789201079734, 7.723750561015024, -4.578675413810673, 5.7572805339029, 4.629686479897616, 2.6586907171776417, 1.384853900218907, -5.743485979605807, -7.969547868916136, -9.550979507612464, -1.8679515356829057, -4.8457382491131185, -5.330049829371033, 3.386679994295152, 2.2990988206033656, 1.709226847535012, -3.5472034709904072, 0.14797985135344582, 1.2870404818954135, 9.13081307744719, -4.595962050633656, -2.929217114734646, 0.4230047721559451, 0.004672173016036396, -5.402256403397844, -4.878585431385005, -3.4246404645830486, -7.989903161637308, -6.307619163320783, -3.6637450306652797, -6.967499592158317, -4.188559641495688, -8.164329738350457, 1.5357931033884835, -7.271486210083338, -5.021824591190285, 4.841128385593711, 9.426126412337663, 2.190347939167932, 1.4224154634746924, 2.738790975875391, -4.513393023537513, -2.9849995586554083, 2.738940110444119, 7.242662611069118, 0.720819660210184, 8.717025159372433, -1.7650300672041137, -0.7650393340768815, -8.705685142145247, -1.830500461075836, 3.944566137349989, 7.34848971799725, 2.9550564802120682, -6.37499198995144, 7.508472860968563, 6.075301032521889, -8.216655734008231, -5.797792843461449, 0.14769696636829366, -7.983585471373429, -9.544756444496032, 8.76297991227592, 7.4836800154006085, 1.5239119553566738, 4.377744356618344, 3.3400826866687527, -2.5047788620084095, -6.308414071321349, 6.56428544860692, -7.183567009450447, 7.92555116407846, -5.768782731645786, 0.4579352581863496, -3.6152172422669393, -1.7624909258785486, -3.109344967681351, 2.921315226347474, 7.730000998415608, 0.2744628974401273, 1.3805080661720321, -1.6094466815882775, 2.7224765210135686, 0.6763868764956111, -3.8492625639177476, 6.903912144725954, 4.389851183321449, -0.572036368720763, -6.602660014676262, 3.891071326252792, 5.586643971755908, -0.089846894044177, 4.040912896795682, -0.6977716256180617, -9.932449123443538, 0.8231368582364667, 7.564244854324759, -2.5162479537736875, 7.599442915194636, 3.5842628954188562, -8.64638277991995, -9.610059654020906, -0.36540769685131735, -8.209836766445244, 1.1425823874360006, -4.513184786991995, -6.999276808033878, -8.694751512365045, 3.082734626046504, -2.2020579766838004, -4.849507791323717, 0.5611601055902042, -3.348669380640443, -5.226220535485854, -9.84704425921663, 1.5085605245885425, 0.2914143355966594, -4.343648063287267, 2.088461621960409, -0.12605783335146548, 1.1770894351519061, -6.0603941180978165, -9.715404590477837, -0.7516507240548531, -5.089542901348252, 1.0040277374652273, 3.3104255534344063, 5.409193161569096, -8.122109211504021, 8.117217961345279, -7.551232583526939, 7.4430950247159835, -4.9344547454872645, -1.4239739406237035, 7.928793497381545, 8.871351806043663, 5.121770581574216, 3.312785941743819, -7.0386211263069365, -7.670194027421529, -0.9321022594751422, -6.5994030266701875, 2.3964010552941133, 3.004309330096266, -9.896756919876069, -9.839650931950183, 4.836647202315387, 1.5665427732581882, -5.424949048464159, -7.343283773108822, 7.7143750967270535, -3.139512198436827, -6.391110530590192, 1.957645989272514, 9.25098797272376, -1.057321004161988, 7.984484278268106, 7.2079173511008285, -4.5939151781804615, 8.678064688560308, 0.6715823166472177, 0.06089965809097464, -7.08768939375889, 4.211586950649886, 9.008283159719873, -2.138275191582741, -4.051296481731798, -8.074233242761206, 7.910075903880159, -8.699752073820834, -4.328696745412146, 5.713875100292272, 7.230153980313258, -7.831955676251113, 3.2774540333527433, -9.65773607301639, -1.9835347079167693, 8.258102386129057, 6.579869512018494, -4.856334710810555, 1.9026495614584444, -1.7659090893870317, 0.7791312542550379, -3.0871409544342505, -6.061941498919994, 5.691652878763268, 6.524522804416929, 8.013669935796386, 7.710324112402315, -5.707864378867436, 9.323202471665862, 4.094207354899416, 8.067680011156689, 9.148709293474674, -2.2872658694005255, 8.670344034936008, 4.585197676151969, -9.612717654195688, -7.020961905562508, 3.0653911783926695, -1.7482422696664113, -7.510512850423026, 4.442637134002021, 9.165585808814576, -1.8185645722150454, 7.089284662058379, -0.7196423837801724, -9.16612206758648, -2.3614254974344995, 7.154616805050939, -7.974877725653043, 0.11392478554084917, -5.7010258817399295, -3.422238031454752, -5.364886560745397, 8.147895401683002, 5.3198162830443, -8.854038927074475, 9.269786398694247, -9.498772507939243, -1.5521383919865492, 2.90461544681202, 6.768014310124478, 5.637128977926762, -2.0321495455902667, 2.5474085418115884, 2.0133063402210034, -3.987495670025451, -2.368025270650797, 6.104104353439485, 4.247584276958287, 8.601045793369057, -5.0761671200754455, -5.858974297397022, 6.327248610147954, 7.4514690619370505, -0.7862249053865575, 7.134713321213695, -9.26562071939262, 1.2178034254626464, 9.909096973151613, -7.740687452526764, 4.073604344683208, -3.1219008612281147, 9.018677638968033, -3.3996236696006354, 3.833518300763153, 0.950595272222607, -7.905239940376312, -9.818930370379224, -0.851954216281003, -2.994045425942879, 2.9627554221370183, -5.162296663125674, 4.053908596430782, 7.467165219474843, 7.233724334482204, -4.672313994637611, -1.0769753348528717, 0.7823613115210506, 9.830336419217684, -5.624990926149957, -2.2758678078092416, -1.737395358188154, -7.546275135057248, -3.654901632183771, 2.2914568355217284, -7.218386745443759, 1.6038415627473093, 2.806360855156875, 5.322119839120392, -0.5680367968502775, -2.393092429596768, -0.04054273622424098, 0.1344811735841489, -2.0413552667045964, -2.487152509568668, -0.21524838330206642, -9.291358544328824, -6.7471874844433195, 6.039283917654245, -9.060921757554413, -6.518137674392412, 6.423647249122713, 6.3692752221524565, 6.606636229997552, -2.742443985217962, -6.579815774479103, 8.56216797675847, 9.181433496974918, 5.499438957469058, -5.518538913920263, 7.543846298038119, 6.942415416901909, 7.311073828729441, 2.5149807823845887, 8.777696439163588, 0.3163349009072558, 6.491135995021949, 5.670928326466809, 3.9990766043462322, -2.2015556911959555, -4.3079321250858555, 6.704383966140554, 4.994662995356496, 8.589112292105643, 8.875442327143432, 4.96126111984057, 0.7649741644832169, 1.3582594814976297, 1.2802062700026156, 3.0930241690178164, 0.03158440610037161, -3.9589344182409185, 1.0367598736616142, -2.9688322479998863, 7.557661824397506, 6.199613170880639, 8.827329568156411, 7.456261227972707, -2.3530116650523976, 3.702650328576409, -4.337313880832214, -9.64277955418349, 5.569483662224542, -0.5277594564854997, 6.159269723128876, -6.467173920928038, -3.4892930736108063, 7.685091418161942, 8.099672196208285, 7.840249067475796, -2.0741719264440084, 4.630635768459149, 2.7396738774491514, -0.9417107409074248, -9.8747148686968, 2.355000260092501, 9.396695342292201, -5.2081686450886355, 6.605162974733879, -5.2839795109097025, 9.065169951302884, -5.150377910386221, 5.204573389660387, -8.792639176541746, 6.037142285886631, 3.1317770856122564, -2.960228819623076, -1.637930066819866, 7.376397363654274, 8.671488926687068, -3.725909269337267, -7.149663529293657, 7.24362307425627, 2.358158996732591, -1.5259314818997574, 4.450716192843757, -6.329806667178273, 1.648190646308949, -1.2313575963936412, -8.917128644034381, 7.418891985780903, 6.71625038533335, 1.6704816233084134, 2.8082689776546914, 0.3494174211787815, 3.2446912482742967, -4.0007289571134885, 6.136656337585229, -8.114140863646167, 9.429362247647283, 0.2872281509364676, 9.461166974027254, -1.1018298632582084, 8.305669988945638, 6.1200377149847505, 6.097476535508232, 1.463106704112871, -1.6191880470008115, 1.036861462703115, -1.977582260346864]
BIASES_LIST = [-1.242993807965231, 9.159279642677856, -2.74017416792052, 6.494994939282293, 6.983064145895245, -0.45065947507507786, -5.032580885081064, -1.2373113555714816, -3.319604357477914, 4.604789995009742, -6.401164369931651, 2.9431309498200324, 3.49030888567529, 8.13390260151559, -9.46865770677263, -8.750484763878427, 4.528960631521439, -2.7129169243999645, -9.36009676225267, -9.723762831840212, 3.302710049616005, 0.23629661116104117, 6.549409899288346, 1.1686513001549947, 7.724476465034197, 8.117868524929108, 4.163112893068126, -7.664384155241224, 3.4570733034322814, -6.927156606327419, -4.4892762024224435, 2.7501711549100314, 5.390528150599334, -4.030486864776515, 2.801653626172504, 3.8132467516835646]
SHAPE = [27, 16, 16, 4]
=======
WEIGHT_LIST = [8.40286382059977, 5.770065849589987, 0.7760926777836534, 7.389765200847695, -2.4447725372957096, 6.0158592308819365, 2.6859399104379644, 2.9937735014336138, 1.055498976982479, 9.602150383446666, -9.546325118838787, -3.858022961386429, -8.312163067525777, 0.1961438602052894, -4.338839061566779, -5.222110828286128, 2.485884376527638, 1.1205287027861672, -7.147278530578047, -8.706737969178455, 1.2588033919164605, -1.8600840296391894, 4.123934147947708, -9.91983896941095, -8.481181109588471, 6.472866030201896, 2.5263825284764074, 0.5889037911664232, 8.566940242975022, 2.7299184531196126, 3.169032237752919, -2.693134316017276, 3.5936902566930335, -3.8939726523262213, 2.3632735826445934, 3.4313481481905033, -5.921901923272848, -2.5417095421224456, 0.3232390143011976, -1.9838833095530966, 5.587971162267957, -6.906960933788846, -8.10959982893483, -5.167853924716699, -3.9506476288263777, -1.8587077248560941, -1.3140836743740874, -7.00706428121344, -5.530621722883657, -8.162758243020573, 5.2101570253321405, 5.130588753766121, -9.066776306503193, 0.8352211450791085, -1.8675419952631689, 9.490998214918637, -7.943369020882411, 8.315036752222792, 1.0782232183458458, 0.7581557534882162, 1.9300872581394142, 8.757010133232004, 6.203285827155717, -9.131738843019932, -6.214680254223195, -3.8389080643798383, -9.622442861815287, 8.79360516258443, -9.822158303889152, -1.501665294489598, -3.585536989675764, -7.135631965365363, 5.046830691208843, -6.997956038933985, 2.9599142823095566, 0.817729777370495, 8.600880322385144, -4.537606040819108, 2.8804477941660593, -7.668035727942712, -7.554658233739351, 2.38060768544951, 8.673641901780684, 5.169073374309113, 9.74899129034511, -0.0002111269600018062, -7.3536872286431905, 7.772358661430793, -5.7919491370835585, 2.9915498205399658, 0.07112949440193717, 7.238962789787621, -9.015967993106482, 2.3220488586924546, -8.316293155153613, 2.985556537956846, -3.7808502807101636, -3.807427513592887, 2.922831417733123, -5.737655603242953, 9.347454396550397, -2.159282370885112, 5.165897301213818, -7.607968879664044, 2.856138679803218, 3.8922539492116357, -3.874526005103287, 2.798090466065581, 6.646886489269644, 2.723890172365305, -3.505278307714395, -8.962639464995801, -9.603256824836485, 5.914164738854364, 4.8291083122423295, 7.683661544177138, 3.2689982685633083, 1.2235599491431142, 7.715489413449195, 1.4739735971337975, 6.78858548559964, 6.778862469469946, -4.023338935017349, -2.8526753678490424, 3.968248912669976, 9.593922813893812, 0.8571912335537402, 4.846959302391147, -7.4079773514653935, -6.405299352377234, -7.3357920291170124, -9.141322869477957, 8.706613226438595, 5.825419915858223, -5.155016039052647, -7.159471437019707, -5.485937608780215, 2.25508091888425, 2.2616052848916866, 1.7043840655378446, -1.1485714480590286, -4.007221876101601, -1.9163220777225085, 6.291615043988671, -2.951161044633757, -2.973761603113676, -5.361566259023793, -0.5750011675276046, -1.6036845337886945, 7.131025957739009, -2.886740077117529, -7.526255785051086, -1.6040691307364554, 4.7409613394948185, -6.6844687402129725, -8.222953895961535, -2.83026818000073, 7.312252368345771, 6.295428019095908, 4.293770867614343, -9.255082450171875, 5.130091783846067, -4.807209569463689, 1.2860172749711296, -3.505644578058746, -9.507165815599965, -8.890356698542124, -6.660507146428798, -1.4804769087502798, -5.055065286809022, -2.625526317259739, 6.664552002924637, 2.964855467359511, -9.53469619429791, 1.8043186314216264, 6.191920109709322, 7.871458625970174, -5.8524739799911085, 3.3983559829463257, -5.770842405265455, 7.312873851635583, -5.543609758197736, -2.462333211219356, -9.414131172638577, -1.4551843563078783, -6.685072162563621, -3.7948123271392875, 2.007742326420459, 8.784021762010983, 7.4703738655468115, -8.728398919808363, -7.4326863986636615, 7.61939358339216, 2.3107840721176682, 3.5325252349921676, 4.2604177121420825, 0.1342964482384552, 2.0833649434261083, 8.89251622953541, -4.924450288982014, -4.6840162017744325, -9.024471936430967, -2.8122332181085863, 3.6794802167687113, 6.260526650126906, -2.8991681546411474, -1.3580553058615763, 6.341813953592567, 0.9289542905109105, 2.103381562375983, 7.390464863679874, 3.694282340641891, 2.92148633230199, -1.3587277782447416, 4.945454338983142, 5.44806013321667, -7.821055236997168, -5.852411473617618, 6.7228330779004395, -5.728244073865321, 4.117992319793554, 0.9496429198318523, 9.94521080349535, 5.837114946879002, 3.538641056119914, -8.473205111649646, 7.723172152278156, -3.152620621909888, -2.5899929590783355, 1.357716992351266, 5.742266755335464, 1.7145504748148994, -1.7537961127314823, 2.204701015740387, -3.6817301826786553, -4.561011010132237, 2.108372785059551, -1.9364570241354588, -7.796217986376879, 3.286865298278874, -0.2926585761892735, 9.365542525681743, -5.280959847996874, -3.2604770656292477, -4.946105860424268, 0.822204184314332, -0.755667463331612, 2.8964714411390027, 7.705677392238886, -8.289767742260787, -8.117287501226384, 4.851627584000147, -5.661236185760377, 9.686553552573539, 1.4727054087579727, 2.7049474333836354, -2.1641203463857783, 0.1301069375032604, 4.890723247543114, 0.16029989083007834, 9.000846050193264, 9.062760314048425, -1.065557208250425, -2.827022275155411, 8.833854533371039, -9.81728045164285, 7.731406704929569, 7.884588648084506, 5.57516773799739, 4.466519604335009, -5.374806210784866, -9.33673262742846, 9.057479105042468, 7.285534677568858, -9.306806355426424, 9.550214487760606, 0.8571224456206359, -8.004277328149335, -9.942957335828131, 1.7615478188577853, -8.778570771278114, 6.274678060746805, 5.895431020656865, -5.3843249157018525, 2.7286565934168845, 1.6447830954972975, 3.0521510090578925, 6.359284270326366, 0.49534731115100783, -5.978349398794059, 7.981809699601033, 8.13199428255993, 6.48529527710393, 4.712140034981969, -0.09565383535885807, 0.4395322722238788, 7.003818949522401, -3.7299246625809097, -8.587006020254169, 3.6149063656139475, -8.145904419140841, 4.108320009366846, 3.058828632414663, 4.954734754537299, -3.3264917629751123, -4.0256595238263815, -5.9482434433120694, 3.8772523321577967, 7.4736279992900165, 7.4539663155085485, -8.868166263782024, -9.606265977918106, 3.2257963931106826, -8.70471524100035, -2.361925545703034, 5.792175561179395, 1.4050738591549816, 6.949504624272741, -6.908079221318899, 8.232817114342563, -9.673789926591121, -0.6551264298105703, 7.529110081603573, 6.963471255430665, 0.5677183234763721, -3.99417825632214, 5.269010503194538, -5.095770918257758, -6.668267262443763, 4.989964517218716, 9.441686749353678, -7.758108691898937, -4.768529024956769, -0.48524868763973217, -5.811305190036055, -6.100542858908538, -3.7874102532525793, -3.7282075971912576, 0.7774344988125996, 0.5377784433037505, -0.058411228931765535, -8.134611589969241, 6.345301899351256, 2.89656449326392, -3.640315932169889, 7.427703781693534, 4.504146283646179, -2.0253851610197344, -5.304872822948572, 2.655913728976296, 3.3977268397750855, 9.342513458550211, 6.071685025944507, 8.345722705380094, 8.828353578157618, -6.8530712970491425, 0.8853386547628617, -0.852750741637136, -4.70021800700165, 2.204384476803087, 4.66606542636665, 3.3858952104960416, -8.430804262755986, -0.7549038260974719, -5.850735272243339, 5.358777735124146, 3.1735838797274845, 6.796420024109228, -5.8180154707704705, 4.530009785312297, 5.190999613360429, 2.242508666683161, -4.720158655647742, -7.284601593359379, 3.2158450546343804, -4.072088080082363, -8.961825478696754, -3.045970901829138, -6.28231763906387, -7.488348338317541, 5.46632207100247, 4.543975096576716, 8.132960919375417, 1.6213421888291446, 2.1080645316970994, 9.313871799837436, -9.257758447955275, 0.1329889872634631, -7.268279593085463, 5.376058514415279, -0.6357494142825981, 7.743120165752224, 1.8368760602601384, -4.349710173139001, 4.8486536305755035, -4.313941711449896, 1.8169004654298284, -8.882962644931844, 9.642109073063658, -8.275920110824487, 3.7504045816092297, -7.090706054980378, -3.076799068189569, -4.269425592642078, 4.254631158907285, 0.7836438291912984, 3.3940164210699812, -4.552899843876195, 7.932919908637274, 9.53978727165731, -8.621066600787, -0.0694562928380904, 6.545741088836511, -8.450147472887107, -9.579582420574837, 2.991395131364179, 9.69389411318662, -9.91706375783314, 8.82372341836136, -8.18433577976027, -2.7960850718131063, -4.057050625169907, -7.573430454772989, -0.8966254193171519, 8.370387490654366, -9.872059828166222, 4.359077432681236, 1.2785940452220217, -6.532271564283376, 4.715954869488058, -8.02551978594443, -5.665641688609453, 0.7071945155440122, -6.836694699555523, 5.128842485349711, 3.072104982741731, -2.3815953756256363, 9.072215688433552, -7.12230345784723, -7.510278425585726, -4.256007642582665, 0.2216972208298067, -3.3805259865385135, 1.448290858163574, 6.573558618939106, -0.9631504423455972, 9.44111171327567, 5.108175539003376, -3.045166357962197, 0.07548688466231468, 1.6036921238821087, -5.053608410629216, 8.610988318730797, -4.901773972204393, -6.012084227738659, -2.94894818914935, -9.38905114775685, 7.29739204819872, -0.6220323669982086, -6.838805903062211, 9.15309163624342, 6.467725172649949, -5.1684915760548655, 4.091916989714207, 8.570723627130125, -5.792405371614229, 9.525095692177647, -4.145631473500737, 1.5984031248210346, -3.6890608036964494, 8.705826783664726, -4.598429525260319, 2.5904590189847454, -9.016491681511452, -2.5587956473790534, -0.7115528846028614, 7.438523561088417, 1.564346322349941, 5.296056024934288, 4.7673011052339405, 8.540838748239079, -2.643721689763659, -0.9599201136137623, 5.295933963842893, -1.2008706527083035, 8.28546839194501, 6.006335646165969, 0.2390522767641059, -7.231553173809193, -5.978709851331743, 4.352134377037867, -8.269772131378247, -0.346675426516903, -7.856099657476097, -7.089752323183365, 2.8674146109269145, 2.9154711153356168, -2.5747275813579185, -6.429871160764275, -4.695237096836793, -2.270009743600136, -1.6213476886834144, -5.8849552778727094, 1.2815195893578828, 6.725205420205249, 1.9465000384384972, 5.625743269250204, -6.586071885942612, 7.595529793650012, -7.44143798347817, 1.0789976578919749, -6.410145211335507, -0.06074039858822111, 0.6101463623369732, -9.02259559630374, -9.65581628100097, -6.522313424314412, -6.035492571956533, -5.598337749834414, -1.2395518431256178, 5.242210536077522, 8.988421426418288, -0.3329291183053229, -9.326825730640184, -8.921636474426414, -1.9124416976761118, -6.216735447055612, 9.785212434142, -8.735430786244402, 3.205322576479128, -1.1767507767047256, 5.9694703102290365, 2.5539356599983556, 2.76370174349022, 4.164347325183035, 4.711172426414482, 5.926792075869219, -1.3685316312252134, 5.653153589437039, -4.611294859169335, 6.654974089566366, 3.5182282213575906, 0.16348795479870404, -1.1768274083147254, 7.066899563307885, -3.1282797246454397, 7.528863612719345, 0.9742790668865844, 4.4248203071982815, 7.852612350436207, -7.584586453308915, -0.8433958253875922, -0.6186772433270153, 8.195070803987203, 5.438349395790961, -4.430763382732563, 2.9185858900288597, -6.553013007459503, 7.1242065401341, -8.573398385835189, -3.4985183292062905, 8.72995763171356, 7.092397741624254, 7.02919435034994, 2.8891994978676827, 8.67016134783238, -7.5354092155860215, 5.316687632797628, 4.282001555946863, 5.148414637095833, 9.659545944641913, -3.9114416269002756, 6.074436179632663, -2.4123422525883225, -1.3178539168570413, 0.11332346445325392, -2.3952617179016418, 9.451023824338975, 3.416038715783486, 2.569429095723594, -7.165100770019857, 3.996756675501219, -9.367868230276933, 8.023336801144644, 4.7834264872802095, -0.938711343840037, 0.6796545094854984, 4.715501125322348, -7.200858402854968, 8.19795163359014, -6.479482947911334, 0.5273174900121198, -5.905964752677432, -4.229733457470655, -6.29214544411356, 9.37967738511703, 4.363563712784156, -8.76908316933704, -2.8133359002870018, 5.430282687868775, -2.8458553957986705, 7.98422976072526, -4.865509785010913, -8.782390831913332, 0.9463019729399704, 3.9491713892819664, -5.284590586842537, -8.54389774393013, -3.0260141543746872, 1.1004394803061537, 5.057217452194198, -4.906220228056344]
BIASES_LIST = [-4.329138001585385, -6.931019442965747, 0.7722440008083709, 9.434474222190449, -0.4494176365632647, 7.937284239519073, 5.606812650892611, 7.705483419557996, -8.573582794815927, 5.245546928027089, 2.0661528741706405, 1.3842487880232923, -5.623916269538554, 3.0451445778053916, 7.927924068266876, -4.128923796004669, 3.156737964185389, -1.4340231781247503, 3.586779826089499, -6.484128664886444, 9.8207156907715, -8.582902196839168, -2.435451055130411, -5.9470873522390955, 5.1702226758500895, -5.895255054470521, -7.771694379354499, 9.06279525363977]
SHAPE = [27, 16, 10, 2]
>>>>>>> 7d31a6a87a720dfe4ed79aa94e6595884cb1bc5d

IN_TRAINING = True

## NEURAL NET FUNCTIONS ##
if IN_TRAINING:
    import numpy as np
    def sigmoid_list(x):
        return 1/(1+np.exp(-x))
    def dot(x, y):
        return np.dot(x,y)
    def vector_sum(x, y):
        return x+y
    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = dot(weight, v)
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v
else:
    def sigmoid(x):
        return 1/(1+math.exp(-x))
    def sigmoid_list(x):
        return [1/(1+math.exp(-v)) for v in x]

    def dot(x, y):
        return sum(a*b for a,b in zip(x,y))

    def vector_sum(x, y):
        return [a+b for a,b in zip(x,y)]

    class NeuralNet():
        def __init__(self, weights, biases):
            self.weights = weights
            self.biases = biases
        def compute(self, inputs):
            v = inputs[:]
            for weight, b in zip(weights, biases):
                v = [dot(v, w) for w in weight]
                v = vector_sum(v, b)
                v = sigmoid_list(v)
            return v

def list_to_weights(lis, shape=[27, 16, 10, 2]):
    weights = []
    index = 0
    for i in range(len(shape) - 1):
        row = []
        dx = shape[i]
        for j in range(shape[i+1]):
            row.append(lis[index:index + dx])
            index += dx
        weights.append(row)
    return weights

def list_to_biases(lis, shape=[27, 16, 10, 2]):
    biases = []
    index = 0
    for i in shape[1:]:
        biases.append(lis[index: index + i])
        index += i
    return biases

weights = list_to_weights(WEIGHT_LIST, SHAPE)
biases = list_to_biases(BIASES_LIST, SHAPE)
if IN_TRAINING:
    weights = np.array(weights)
    biases = np.array(biases)

nn = NeuralNet(weights, biases)

def check_space_wrapper(r, c, board_size, team=Team.WHITE, opp_team=Team.BLACK):
    # check space, except doesn't hit you with game errors
    if r < 0 or c < 0 or c >= board_size or r >= board_size:
        return 0
    try:
        team_there = check_space(r, c)
        if team_there is team:
            return 1
        elif team_there is opp_team:
            return -1
        return 0
    except:
        return 0

def flatten(board):
    lis = []
    for row in board:
        lis += row
    return lis

def copy(board):
    return [row.copy() for row in board]

def pawn_turn():
    board_size = get_board_size()
    team = get_team()
    opp_team = Team.WHITE if team == Team.BLACK else team.BLACK
    row, col = get_location()
    
    if team == Team.WHITE and row == board_size - 1:
        return
    if team == Team.BLACK and row == 0:
        return
    
    board = [[check_space_wrapper(row+y, col+x, board_size, team, opp_team) for x in range(-2, 3)] for y in range(-2, 3)]

    if team == Team.WHITE:
        forward = 1
    else:
        forward = -1
        board = board[::-1]

    inputs = flatten(board) + [row/board_size, col/board_size]
    results = nn.compute(inputs)
    best_move = 0
    val = 0
    for i, v in enumerate(results):
        if v >= val:
            val = v
            best_move = i

    if best_move == 1:
        if board[3][2] == 0:
            move_forward()
        return
    if board[3][1] == -1:
        capture(row + forward, col - 1)
        return
    if board[3][3] == -1:
        capture(row + forward, col + 1)
        return
    return

def overlord_turn():
    board_size = get_board_size()
    team = get_team()
    board = get_board()
    board = [[0 if not x else 1 if x == team else -1 for x in row] for row in board]
    cols = [0 for i in range(board_size)]
    for row in board:
        for i,x in enumerate(row):
            cols[i] = cols[i] + x
            if i > 0:
                cols[i-1] = cols[i-1] + x/2
            if i < board_size - 1:
                cols[i+1] = cols[i+1] + x/2
    m = 10000
    index = [0]
    spawn_row = 0 if team == Team.WHITE else board_size - 1
    found = False
    for i in range(board_size):
        if not check_space(spawn_row, i):
            if cols[i] < m:
                found = True
                m = cols[i]
                index = [i]
            elif cols[i] == m:
                index.append(i)
    if found:
        spawn(spawn_row, random.choice(index))

def turn():
    """
    MUST be defined for robot to run
    This function will be called at the beginning of every turn and should contain the bulk of your robot commands
    """
    
    robottype = get_type()
    if robottype == RobotType.PAWN:
        pawn_turn()
    else:
        overlord_turn()
    bytecode = get_bytecode()

